<!DOCTYPE html>
<html lang="es">





<head>
  <meta property="og:url" content="https://imlauera.github.io/14ricardo_reversing/">
  <meta property="og:site_name" content="Imlauer">
  <meta property="og:title" content="14ricardo reversing">
  <meta property="og:description" content="00014knrmZF0Osbg.es.srt
Este video es la parte de introducción y setup del ejercicio 5 en Ghidra, donde se identifica el main y se explora la estructura general del programa antes de comenzar el análisis.
Setup del proyecto en Ghidra:
Se importó el ejecutable con la opción de cargar todas las librerías habilitada (Load external libraries), lo cual genera una pestaña por cada DLL. Se analizó todo de una vez con “analyze all open”. Se ejecutó el programa brevemente para ver su comportamiento: es un programa de consola que imprime varias strings relacionadas con estructuras, clases y objetos.">
  <meta property="og:locale" content="es_es">
  <meta property="og:type" content="article">
    <meta property="article:published_time" content="2026-02-03T03:59:41-03:00">
    <meta property="article:modified_time" content="2026-02-03T03:59:41-03:00">
    <meta property="article:tag" content="Reversing">

  
  <meta itemprop="name" content="14ricardo reversing">
  <meta itemprop="description" content="00014knrmZF0Osbg.es.srt
Este video es la parte de introducción y setup del ejercicio 5 en Ghidra, donde se identifica el main y se explora la estructura general del programa antes de comenzar el análisis.
Setup del proyecto en Ghidra:
Se importó el ejecutable con la opción de cargar todas las librerías habilitada (Load external libraries), lo cual genera una pestaña por cada DLL. Se analizó todo de una vez con “analyze all open”. Se ejecutó el programa brevemente para ver su comportamiento: es un programa de consola que imprime varias strings relacionadas con estructuras, clases y objetos.">
  <meta itemprop="datePublished" content="2026-02-03T03:59:41-03:00">
  <meta itemprop="dateModified" content="2026-02-03T03:59:41-03:00">
  <meta itemprop="wordCount" content="417">
  <meta itemprop="keywords" content="Reversing">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="14ricardo reversing">
  <meta name="twitter:description" content="00014knrmZF0Osbg.es.srt
Este video es la parte de introducción y setup del ejercicio 5 en Ghidra, donde se identifica el main y se explora la estructura general del programa antes de comenzar el análisis.
Setup del proyecto en Ghidra:
Se importó el ejecutable con la opción de cargar todas las librerías habilitada (Load external libraries), lo cual genera una pestaña por cada DLL. Se analizó todo de una vez con “analyze all open”. Se ejecutó el programa brevemente para ver su comportamiento: es un programa de consola que imprime varias strings relacionadas con estructuras, clases y objetos.">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    14ricardo reversing
    
  </title>
  <link rel="stylesheet" href='https://imlauera.github.io/css/site.min.css'>
  <link rel="canonical" href="https://imlauera.github.io/14ricardo_reversing/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://imlauera.github.io/index.xml" title="Imlauer">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <meta name="author" content="Imlauer.">
  <meta name="description" content="00014knrmZF0Osbg.es.srt
Este video es la parte de introducción y setup del ejercicio 5 en Ghidra, donde se identifica el main y se explora la estructura general del programa antes de comenzar el análisis.

Setup del proyecto en Ghidra:
Se importó el ejecutable con la opción de cargar todas las librerías habilitada (Load external libraries), lo cual genera una pestaña por cada DLL. Se analizó todo de una vez con &ldquo;analyze all open&rdquo;. Se ejecutó el programa brevemente para ver su comportamiento: es un programa de consola que imprime varias strings relacionadas con estructuras, clases y objetos.">
</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://imlauera.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="/img/memememe.jpg">
      </figure>
    </a>
    <a class="navbar-item" href="https://imlauera.github.io/">
      Imlauer
    </a>
    <a class="navbar-item" href="/acerca/">
      Acerca de Mi
    </a>
  </div>
  
  
</nav>

  <section>
    <section class='hero is-small is-link is-fullwidth'>
      <div class="hero-body">
<div class="container">
  <h1 class="title">
    14ricardo reversing
  </h1>
  <h2 class="subtitle">
    <time datetime='2026-02-03T03:59:41-03:00'>
      February 03, 2026
    </time>
    
    <br>
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/reversing/">Reversing</a>
    
    
    
  </h2>
</div>

      </div>
    </section>
    <section class="section">
      <div class="container">
<div class="content is-medium">
  <p>00014knrmZF0Osbg.es.srt</p>
<p>Este video es la <strong>parte de introducción y setup del ejercicio 5</strong> en Ghidra, donde se identifica el <code>main</code> y se explora la estructura general del programa antes de comenzar el análisis.</p>
<hr>
<p><strong>Setup del proyecto en Ghidra:</strong></p>
<p>Se importó el ejecutable con la opción de cargar todas las librerías habilitada (<code>Load external libraries</code>), lo cual genera una pestaña por cada DLL. Se analizó todo de una vez con &ldquo;analyze all open&rdquo;. Se ejecutó el programa brevemente para ver su comportamiento: es un programa de consola que imprime varias strings relacionadas con estructuras, clases y objetos.</p>
<hr>
<p><strong>Encontrando el <code>main</code>:</strong></p>
<p>Se usó el método estándar de buscar las funciones <code>__get_argv</code> y <code>__get_argc</code> (o sus equivalentes), que siempre se llaman justo antes de saltar al <code>main</code>. Desde las referencias de esas funciones se identificó la función que prepara los argumentos y hace la llamada al <code>main</code>. Se renotó como <code>main</code>.</p>
<p><strong>Argumentos del <code>main</code>:</strong></p>
<p>Se identificaron los tres argumentos estándar de un programa compilado en Visual Studio consultando la documentación de ReactOS:</p>
<ul>
<li><code>argc</code> → <code>int</code></li>
<li><code>argv</code> → <code>char**</code> (array de strings de la línea de comandos)</li>
<li><code>envp</code> → <code>char**</code> (array de strings de las variables de entorno, retorno de <code>GetInitialNarrowEnvironment</code>)</li>
</ul>
<p>Se eliminó el cuarto argumento que estaba de más y no se usaba.</p>
<hr>
<p><strong>Funciones de inicialización pre-<code>main</code>:</strong></p>
<p>Se identificó la llamada a <code>__initterm</code> / <code>__initterm_e</code>, que son funciones internas de MSVCRT que recorren una tabla de punteros entre una dirección de inicio y una de fin, ejecutando cada función que encuentran. Estas funciones inicializan variables globales antes de que <code>main</code> se ejecute.</p>
<p>Dentro de esa tabla se identificaron dos funciones de inicialización. La segunda de ellas contenía una variable global y llamaba a un constructor con una vtable de <code>derived_example_1</code>, lo que indica que hay un objeto global de esa clase que se crea antes del <code>main</code>. Se renotó como <code>init</code>.</p>
<hr>
<p><strong>Clases detectadas por RTTI:</strong></p>
<p>Ghidra detectó automáticamente las clases del programa mediante RTTI. Las clases propias del ejecutable son:</p>
<ul>
<li><code>base</code> → clase base, no deriva de nadie</li>
<li><code>derived_example_1</code> → deriva de <code>base</code></li>
<li><code>derived_example_2</code> → deriva de <code>base</code></li>
<li><code>nest</code> → clase independiente, no deriva de nadie</li>
</ul>
<p>Cada una tiene su vtable y sus estructuras de jerarquía visibles en el symbol tree. Las otras clases que aparecen son del sistema y no son relevantes.</p>
<hr>
<p><strong>Call graph:</strong></p>
<p>Se usó el call graph de Ghidra para visualizar las relaciones entre <code>main</code> y sus funciones, equivalente al <code>inversive view</code> de IDA. Se observaron llamadas a <code>rand</code>, <code>srand</code>, <code>getchar</code> y las funciones principales del programa.</p>

</div>


      </div>
    </section>
  </section><script 
src="/quiz/quizdown.js">
</script>
<script 
src="/quiz/quizdownKatex.js">
</script>
<script 
src="/quiz/quizdownHighlight.js">
</script>
<script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
<footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      <a class="" href="https://imlauera.github.io/index.xml" target="_blank">
        <span>
          RSS
        </span>
      </a>
      
      | <a href="https://imlauera.github.io" target="_blank">Andres Imlauer.</a> 

      
      
    </p>
    
  </div>




<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
</footer>


</body>
</html>
