<!DOCTYPE html>
<html lang="es">





<head>
  <meta property="og:url" content="https://imlauera.github.io/slider_lukesmith/">
  <meta property="og:site_name" content="Imlauer">
  <meta property="og:title" content="Generate videos cli">
  <meta property="og:description" content="El script está hecho para que el audio dure lo msimo que el video
Si el audio dura más tiempo entonces tenes que usar el script tal cual está, si el audio dura menos tenes que hardcodear el valor de totseconds a 5 o a los segundos que pongas por imágen. TODO (para hacer): Arreglar el script si el audio dura menos que las imágenes porque genera valor negativo. Subir video automáticamente a YouTube y a Archive. Crear un artículo automáticamente basado en imágenes. Crear un audio con espeak que tenga la misma duración que el video (contá cuántas imágenes tenes y multiplicá por cada segundo cada imágen). Enlazá las URLs de archive automáticamente Hacer script para juntar videos (no imagenes) con ffmpeg. Subtitular audios subilos a youtube y descargalos con yt-dlp. Pasar los subtitulos a un llm o a chatgpt para que haga un resumen. Generar un archivo de audio con los subtitulos de chatgpt. Sacá las fotos horizontales, grabá el audio (despues de grabar el audio subi el volumen con ffmpeg 4 veces mas el comando esta en la publicacion interesantes-comandos), disponé de espacio disponible.">
  <meta property="og:locale" content="es_es">
  <meta property="og:type" content="article">
    <meta property="article:published_time" content="2025-12-02T02:03:33-03:00">
    <meta property="article:modified_time" content="2025-12-02T02:03:33-03:00">

  
  <meta itemprop="name" content="Generate videos cli">
  <meta itemprop="description" content="El script está hecho para que el audio dure lo msimo que el video
Si el audio dura más tiempo entonces tenes que usar el script tal cual está, si el audio dura menos tenes que hardcodear el valor de totseconds a 5 o a los segundos que pongas por imágen. TODO (para hacer): Arreglar el script si el audio dura menos que las imágenes porque genera valor negativo. Subir video automáticamente a YouTube y a Archive. Crear un artículo automáticamente basado en imágenes. Crear un audio con espeak que tenga la misma duración que el video (contá cuántas imágenes tenes y multiplicá por cada segundo cada imágen). Enlazá las URLs de archive automáticamente Hacer script para juntar videos (no imagenes) con ffmpeg. Subtitular audios subilos a youtube y descargalos con yt-dlp. Pasar los subtitulos a un llm o a chatgpt para que haga un resumen. Generar un archivo de audio con los subtitulos de chatgpt. Sacá las fotos horizontales, grabá el audio (despues de grabar el audio subi el volumen con ffmpeg 4 veces mas el comando esta en la publicacion interesantes-comandos), disponé de espacio disponible.">
  <meta itemprop="datePublished" content="2025-12-02T02:03:33-03:00">
  <meta itemprop="dateModified" content="2025-12-02T02:03:33-03:00">
  <meta itemprop="wordCount" content="4716">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Generate videos cli">
  <meta name="twitter:description" content="El script está hecho para que el audio dure lo msimo que el video
Si el audio dura más tiempo entonces tenes que usar el script tal cual está, si el audio dura menos tenes que hardcodear el valor de totseconds a 5 o a los segundos que pongas por imágen. TODO (para hacer): Arreglar el script si el audio dura menos que las imágenes porque genera valor negativo. Subir video automáticamente a YouTube y a Archive. Crear un artículo automáticamente basado en imágenes. Crear un audio con espeak que tenga la misma duración que el video (contá cuántas imágenes tenes y multiplicá por cada segundo cada imágen). Enlazá las URLs de archive automáticamente Hacer script para juntar videos (no imagenes) con ffmpeg. Subtitular audios subilos a youtube y descargalos con yt-dlp. Pasar los subtitulos a un llm o a chatgpt para que haga un resumen. Generar un archivo de audio con los subtitulos de chatgpt. Sacá las fotos horizontales, grabá el audio (despues de grabar el audio subi el volumen con ffmpeg 4 veces mas el comando esta en la publicacion interesantes-comandos), disponé de espacio disponible.">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Generate videos cli
    
  </title>
  <link rel="stylesheet" href='https://imlauera.github.io/css/site.min.css'>
  <link rel="canonical" href="https://imlauera.github.io/slider_lukesmith/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://imlauera.github.io/index.xml" title="Imlauer">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <meta name="author" content="Imlauer.">
  <meta name="description" content="El script está hecho para que el audio dure lo msimo que el video
Si el audio dura más tiempo entonces tenes que usar el script tal cual está, si el audio dura menos tenes que hardcodear el valor de totseconds a 5 o a los segundos que pongas por imágen.
TODO (para hacer):

Arreglar el script si el audio dura menos que las imágenes porque genera valor negativo.
Subir video automáticamente a YouTube y a Archive.
Crear un artículo automáticamente basado en imágenes.
Crear un audio con espeak que tenga la misma duración que el video (contá cuántas imágenes tenes y multiplicá por cada segundo cada imágen).
Enlazá las URLs de archive automáticamente
Hacer script para juntar videos (no imagenes) con ffmpeg.
Subtitular audios subilos a youtube y descargalos con yt-dlp.
Pasar los subtitulos a un llm o a chatgpt para que haga un resumen.
Generar un archivo de audio con los subtitulos de chatgpt.

Sacá las fotos horizontales, grabá el audio (despues de grabar el audio subi el volumen con ffmpeg 4 veces mas el comando esta en la publicacion interesantes-comandos), disponé de espacio disponible.">
</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://imlauera.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="/img/memememe.jpg">
      </figure>
    </a>
    <a class="navbar-item" href="https://imlauera.github.io/">
      Imlauer
    </a>
    <a class="navbar-item" href="/acerca/">
      Acerca de Mi
    </a>
  </div>
  
  
</nav>

  <section>
    <section class='hero is-small is-link is-fullwidth'>
      <div class="hero-body">
<div class="container">
  <h1 class="title">
    Generate videos cli
  </h1>
  <h2 class="subtitle">
    <time datetime='2025-12-02T02:03:33-03:00'>
      December 02, 2025
    </time>
    
  </h2>
</div>

      </div>
    </section>
    <section class="section">
      <div class="container">
<div class="content is-medium">
  <p>El script está hecho para que el audio dure lo msimo que el video</p>
<h4 id="si-el-audio-dura-más-tiempo-entonces-tenes-que-usar-el-script-tal-cual-está-si-el-audio-dura-menos-tenes-que-hardcodear-el-valor-de-totseconds-a-5-o-a-los-segundos-que-pongas-por-imágen">Si el audio dura más tiempo entonces tenes que usar el script tal cual está, si el audio dura menos tenes que hardcodear el valor de <code>totseconds</code> a 5 o a los segundos que pongas por imágen.</h4>
<h5 id="todo-para-hacer">TODO (para hacer):</h5>
<ol>
<li>Arreglar el script si el audio dura menos que las imágenes porque genera valor negativo.</li>
<li>Subir video automáticamente a YouTube y a Archive.</li>
<li>Crear un artículo automáticamente basado en imágenes.</li>
<li>Crear un audio con espeak que tenga la misma duración que el video (contá cuántas imágenes tenes y multiplicá por cada segundo cada imágen).</li>
<li>Enlazá las URLs de archive automáticamente</li>
<li>Hacer script para juntar videos (no imagenes) con ffmpeg.</li>
<li>Subtitular audios subilos a youtube y descargalos con yt-dlp.</li>
<li>Pasar los subtitulos a un llm o a chatgpt para que haga un resumen.</li>
<li>Generar un archivo de audio con los subtitulos de chatgpt.</li>
</ol>
<p>Sacá las fotos horizontales, grabá el audio (despues de grabar el audio subi el volumen con ffmpeg 4 veces mas el comando esta en la publicacion interesantes-comandos), disponé de espacio disponible.</p>
<p>Subí el audio a youtube esto lo hago usando un script para agregar una imagen al audio porque no se puede subir audios a youtube y descargá los subtítulos usando esto: <a href="https://imlauera.github.io/srt_to_txt/">https://imlauera.github.io/srt_to_txt/</a></p>
<p>El archivo para subir audios a youtube está en este blog (crear blog post) se llama.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yt-dlp --ignore-config --write-subs --write-auto-sub --sub-lang es --sub-format <span style="color:#e6db74">&#34;srt&#34;</span> --skip-download https://www.youtube.com/watch?v<span style="color:#f92672">=</span>VIDEO_ID
</span></span><span style="display:flex;"><span>sed -E <span style="color:#e6db74">&#39;/^[0-9]+$|^$/d; /^[0-9]{2}:/d&#39;</span> video.en.srt &gt; subtitles.txt
</span></span></code></pre></div><p>Ahora copiá y pegá los subtitulos por partes a ChatGPT y pedile que haga un resumen luego guardalos en un archivo llamado <code>chatgpt.txt</code>.</p>
<p>Ahora generamos el audio, podes usar piper-tts.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat chatgpt.txt | espeak-ng -v es -w rock.wav
</span></span><span style="display:flex;"><span>ls *.jpg | sort | ./slider_gen_timestamps.sh &gt; video
</span></span><span style="display:flex;"><span>./slider -i video -a rock.wav
</span></span></code></pre></div><p><strong>Lo haremos usando el script de LukeSmith: <code>slider</code>.</strong></p>
<h3 id="agarré-la-transcripción-del-audio-lo-tire-a-chatgpt-y-lo-pasé-a-cat-chatgpttxt--espeak-ng--v-es--w-rockwav-que-me-generó-un-archivo-de-audio-y-luego-se-lo-pasé-a-slider">Agarré la transcripción del audio lo tire a chatgpt y lo pasé a <code>cat chatgpt.txt | espeak-ng -v es -w rock.wav</code> que me generó un archivo de audio y luego se lo pasé a <code>slider</code>.</h3>
<p>Primero grabá el audio y después ajustá los timestamp para la longitud de ese audio.</p>
<h4 id="tenes-que-pasar-el-archivo-de-audio-con--a-de-lo-contrario-tirará-un-error-más-abajo-explico-como-solucionarlo">Tenes que pasar el archivo de audio con <code>-a</code> de lo contrario tirará un error, más abajo explico como solucionarlo.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ./slider
</span></span><span style="display:flex;"><span>Give an input file with -i.
</span></span><span style="display:flex;"><span>The file should look as this example:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>00:00:00        first_image.jpg
</span></span><span style="display:flex;"><span>00:00:03        otherdirectory/next_image.jpg
</span></span><span style="display:flex;"><span>00:00:09        this_image_starts_at_9_seconds.jpg
</span></span><span style="display:flex;"><span>etc...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Timecodes and filenames must be separated by Tabs.
</span></span></code></pre></div><h4 id="tuve-que-cambiar-porque-no-me-tomaba-m4a-como-un-archivo-de-audio">Tuve que cambiar porque no me tomaba m4a como un archivo de audio.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	audio/*<span style="color:#f92672">)</span> ;;
</span></span></code></pre></div><p>a</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	video/*<span style="color:#f92672">)</span> ;;
</span></span></code></pre></div><p>El script tiene un problema y no me permite generar videos <strong>sin audio</strong> porque el <code>video.prep</code> generaba un valor negativo entonces hice lo siguiente</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd .cache/slider/mi_video
</span></span></code></pre></div><p>Y acá están las imágenes generadas por magick con la resolución corregida.</p>
<p>Entonces edito el archivo video.prep arreglo el tiempo negativo del último archivo y ejecuté:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;video.prep&#34;</span> -fps_mode vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;video.mp4&#34;</span>
</span></span></code></pre></div><p>Y dejo el ultimo nombre archivo sin nada abajo</p>
<h5 id="lo-podes-conseguir-clonando-su-repo-mas-abajo-pegue-el-codigo-del-script">Lo podes conseguir clonando su repo (mas abajo pegue el codigo del script)</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/lukesmithxyz/voidrice
</span></span><span style="display:flex;"><span>cd .local/bin/
</span></span><span style="display:flex;"><span>./slider
</span></span></code></pre></div><p>Cambie esto en el codigo: <code>-vsync vfr</code> lo reemplace por <code>-fps_mode vfr</code>.</p>
<hr>
<h4 id="esto-te-sirve-para-generar-los-timestamps-una-imagen-cada-5-segundos-lo-guarde-como-slider_gen_timestampssh">Esto te sirve para generar los timestamps (una imagen cada 5 segundos) lo guarde como <code>slider_gen_timestamps.sh</code>.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Usage: ./gen_timestamps.sh *.jpg</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># or:    ls *.jpg | sort | ./gen_timestamps.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sec<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read -r file; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Format seconds → HH:MM:SS</span>
</span></span><span style="display:flex;"><span>    timestamp<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>printf <span style="color:#e6db74">&#34;%02d:%02d:%02d&#34;</span> <span style="color:#66d9ef">$((</span>sec/3600<span style="color:#66d9ef">))</span> <span style="color:#66d9ef">$((</span><span style="color:#f92672">(</span>sec/60<span style="color:#f92672">)%</span><span style="color:#ae81ff">60</span><span style="color:#66d9ef">))</span> <span style="color:#66d9ef">$((</span>sec%60<span style="color:#66d9ef">)))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf <span style="color:#e6db74">&#34;%s\t%s\n&#34;</span> <span style="color:#e6db74">&#34;</span>$timestamp<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Add 20 seconds for next file</span>
</span></span><span style="display:flex;"><span>    sec<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>sec <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><h4 id="ahora-en-la-carpeta-en-donde-tengas-todas-las-imagenes-ejecuta">Ahora en la carpeta en donde tengas todas las imagenes ejecuta:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls *.jpg | sort | bash gen.sh &gt; video
</span></span></code></pre></div><h4 id="ahora-creamos-el-video">Ahora creamos el video:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./slider -i video -a audio.mp3
</span></span></code></pre></div><p>Si el audio es m4a tendras que hacer una ligera modificacion en el codigo que expliqué en este mismo articulo más arriba.</p>
<h3 id="mi-version-de-slider">Mi version de Slider</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Give a file with images and timecodes and creates a video slideshow of them.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Timecodes must be in format 00:00:00.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Imagemagick and ffmpeg required.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Application cache if not stated elsewhere.</span>
</span></span><span style="display:flex;"><span>cache<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XDG_CACHE_HOME<span style="color:#66d9ef">:-</span>$HOME/.cache<span style="color:#e6db74">}</span><span style="color:#e6db74">/slider&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> getopts <span style="color:#e6db74">&#34;hvrpi:c:a:o:d:f:t:e:x:s:&#34;</span> o; <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>o<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	c<span style="color:#f92672">)</span> bgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	t<span style="color:#f92672">)</span> fgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	f<span style="color:#f92672">)</span> font<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	i<span style="color:#f92672">)</span> file<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	a<span style="color:#f92672">)</span> audio<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	o<span style="color:#f92672">)</span> outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	d<span style="color:#f92672">)</span> prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	r<span style="color:#f92672">)</span> redo<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	s<span style="color:#f92672">)</span> ppt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	e<span style="color:#f92672">)</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	x<span style="color:#f92672">)</span> res<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$res<span style="color:#e6db74">&#34;</span> | grep -qv <span style="color:#e6db74">&#34;^[0-9]\+x[0-9]\+</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			echo <span style="color:#e6db74">&#34;Resolution must be dimensions separated by a &#39;x&#39;: 1280x720, etc.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	p<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;Purge old build files in </span>$cache<span style="color:#e6db74">? [y/N]&#34;</span>
</span></span><span style="display:flex;"><span>		read -r confirm
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$confirm<span style="color:#e6db74">&#34;</span> | grep -iq <span style="color:#e6db74">&#34;^y</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> rm -rf <span style="color:#e6db74">&#34;</span>$cache<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Done.&#34;</span>
</span></span><span style="display:flex;"><span>		exit ;;
</span></span><span style="display:flex;"><span>	v<span style="color:#f92672">)</span> verbose<span style="color:#f92672">=</span>True ;;
</span></span><span style="display:flex;"><span>	*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$0<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74"> usage:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -i  input timecode list (required)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -a  audio file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -c  color of background (use html names, black is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -t  text color for text slides (white is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -s  text font size for text slides (150 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -f  text font for text slides (sans serif is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -o  output video file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -e  if no audio given, the time in seconds that the last slide will be shown (5 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -x  resolution (1920x1080 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -d  tmp directory
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -r  rerun imagemagick commands even if done previously (in case files or background has changed)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -p  purge old build files instead of running
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -v  be verbose&#34;</span> <span style="color:#f92672">&amp;&amp;</span> exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span> <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check that the input file looks like it should.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span> head -n <span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> 2&gt;/dev/null | grep -q <span style="color:#e6db74">&#34;^00:00:00	&#34;</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">||</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;Give an input file with -i.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;The file should look as this example:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:00	first_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:03	otherdirectory/next_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:09	this_image_starts_at_9_seconds.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">etc...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Timecodes and filenames must be separated by Tabs.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Check that the audio file looks like an actual audio file.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>		audio/*<span style="color:#f92672">)</span> ;;
</span></span><span style="display:flex;"><span>		*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;That doesn&#39;t look like an audio file.&#34;</span>; exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>	totseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#66d9ef">$(</span>ffmpeg -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> 2&gt;&amp;<span style="color:#ae81ff">1</span> | awk <span style="color:#e6db74">&#39;/Duration/ {print $2}&#39;</span> | sed s/,//<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>prepdir<span style="color:#66d9ef">:-</span>$cache/$file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>outfile<span style="color:#66d9ef">:-</span>$file.mp4<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>prepfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$file<span style="color:#e6db74">.prep&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>verbose+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Preparing images... May take a while depending on the number of files.&#34;</span>
</span></span><span style="display:flex;"><span>mkdir -p <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read -r x;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the time from the first column.</span>
</span></span><span style="display:flex;"><span>	time<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x%%	*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	seconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Duration is not used on the first looped item.</span>
</span></span><span style="display:flex;"><span>	duration<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>seconds <span style="color:#f92672">-</span> prevseconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the filename/text content from the rest.</span>
</span></span><span style="display:flex;"><span>	content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x#*	<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>base%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">.jpg&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># If images have already been made in a previous run, do not recreate</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># them unless -r was given.</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> canvas:<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> -resize 1920x1080 -composite <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -background <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -fill <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>fgc<span style="color:#66d9ef">:-</span>white<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -font <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>font<span style="color:#66d9ef">:-</span>Sans<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -pointsize <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ppt<span style="color:#66d9ef">:-</span>150<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center label:<span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># If the first line, do not write yet.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;00:00:00&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;file &#39;</span>$prevbase<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span>$duration<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Keep the information required for the next file.</span>
</span></span><span style="display:flex;"><span>	prevbase<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$prevtime<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span> &lt; <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Do last file which must be given twice as follows</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Si el audio dura menos el tiempo que el video el endtime deberia ser 3.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>longitud_audio_float<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ffprobe -v error -show_entries format<span style="color:#f92672">=</span>duration -of default<span style="color:#f92672">=</span>noprint_wrappers<span style="color:#f92672">=</span>1:nokey<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> $audio<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>longitud_audio<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>printf <span style="color:#e6db74">&#34;%.0f&#34;</span> $longitud_audio_float<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cantidad_imagenes<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>cat $file | wc -l<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 3 segundos cada imagen</span>
</span></span><span style="display:flex;"><span>longitud_video<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>cantidad_imagenes*5<span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">((</span>longitud_audio &gt;<span style="color:#f92672">=</span> longitud_video<span style="color:#f92672">))</span> <span style="color:#f92672">&amp;&amp;</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>totseconds-seconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">((</span>longitud_video &gt; longitud_audio<span style="color:#f92672">))</span> <span style="color:#f92672">&amp;&amp;</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;5&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;file &#39;</span>$base<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span><span style="color:#e6db74">${</span>endtime<span style="color:#66d9ef">:-</span>5<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">file &#39;</span>$base<span style="color:#e6db74">&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> &gt; <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> -c:a aac -vsync vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -vsync vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Might also try:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -vf &#34;fps=${fps:-24},format=yuv420p&#34; &#34;$outfile&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># but has given some problems.</span>
</span></span></code></pre></div><h3 id="old-slider">Old Slider</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Give a file with images and timecodes and creates a video slideshow of them.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Timecodes must be in format 00:00:00.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Imagemagick and ffmpeg required.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Application cache if not stated elsewhere.</span>
</span></span><span style="display:flex;"><span>cache<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XDG_CACHE_HOME<span style="color:#66d9ef">:-</span>$HOME/.cache<span style="color:#e6db74">}</span><span style="color:#e6db74">/slider&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> getopts <span style="color:#e6db74">&#34;hvrpi:c:a:o:d:f:t:e:x:s:&#34;</span> o; <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>o<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	c<span style="color:#f92672">)</span> bgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	t<span style="color:#f92672">)</span> fgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	f<span style="color:#f92672">)</span> font<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	i<span style="color:#f92672">)</span> file<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	a<span style="color:#f92672">)</span> audio<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	o<span style="color:#f92672">)</span> outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	d<span style="color:#f92672">)</span> prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	r<span style="color:#f92672">)</span> redo<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	s<span style="color:#f92672">)</span> ppt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	e<span style="color:#f92672">)</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	x<span style="color:#f92672">)</span> res<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$res<span style="color:#e6db74">&#34;</span> | grep -qv <span style="color:#e6db74">&#34;^[0-9]\+x[0-9]\+</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			echo <span style="color:#e6db74">&#34;Resolution must be dimensions separated by a &#39;x&#39;: 1280x720, etc.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	p<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;Purge old build files in </span>$cache<span style="color:#e6db74">? [y/N]&#34;</span>
</span></span><span style="display:flex;"><span>		read -r confirm
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$confirm<span style="color:#e6db74">&#34;</span> | grep -iq <span style="color:#e6db74">&#34;^y</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> rm -rf <span style="color:#e6db74">&#34;</span>$cache<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Done.&#34;</span>
</span></span><span style="display:flex;"><span>		exit ;;
</span></span><span style="display:flex;"><span>	v<span style="color:#f92672">)</span> verbose<span style="color:#f92672">=</span>True ;;
</span></span><span style="display:flex;"><span>	*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$0<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74"> usage:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -i  input timecode list (required)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -a  audio file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -c  color of background (use html names, black is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -t  text color for text slides (white is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -s  text font size for text slides (150 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -f  text font for text slides (sans serif is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -o  output video file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -e  if no audio given, the time in seconds that the last slide will be shown (5 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -x  resolution (1920x1080 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -d  tmp directory
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -r  rerun imagemagick commands even if done previously (in case files or background has changed)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -p  purge old build files instead of running
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -v  be verbose&#34;</span> <span style="color:#f92672">&amp;&amp;</span> exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span> <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check that the input file looks like it should.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span> head -n <span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> 2&gt;/dev/null | grep -q <span style="color:#e6db74">&#34;^00:00:00	&#34;</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">||</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;Give an input file with -i.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;The file should look as this example:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:00	first_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:03	otherdirectory/next_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:09	this_image_starts_at_9_seconds.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">etc...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Timecodes and filenames must be separated by Tabs.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Check that the audio file looks like an actual audio file.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>		audio/*<span style="color:#f92672">)</span> ;;
</span></span><span style="display:flex;"><span>		*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;That doesn&#39;t look like an audio file.&#34;</span>; exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>	totseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#66d9ef">$(</span>ffmpeg -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> 2&gt;&amp;<span style="color:#ae81ff">1</span> | awk <span style="color:#e6db74">&#39;/Duration/ {print $2}&#39;</span> | sed s/,//<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>prepdir<span style="color:#66d9ef">:-</span>$cache/$file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>outfile<span style="color:#66d9ef">:-</span>$file.mp4<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>prepfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$file<span style="color:#e6db74">.prep&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>verbose+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Preparing images... May take a while depending on the number of files.&#34;</span>
</span></span><span style="display:flex;"><span>mkdir -p <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read -r x;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the time from the first column.</span>
</span></span><span style="display:flex;"><span>	time<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x%%	*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	seconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Duration is not used on the first looped item.</span>
</span></span><span style="display:flex;"><span>	duration<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>seconds <span style="color:#f92672">-</span> prevseconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the filename/text content from the rest.</span>
</span></span><span style="display:flex;"><span>	content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x#*	<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>base%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">.jpg&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># If images have already been made in a previous run, do not recreate</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># them unless -r was given.</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> canvas:<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> -resize 1920x1080 -composite <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -background <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -fill <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>fgc<span style="color:#66d9ef">:-</span>white<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -font <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>font<span style="color:#66d9ef">:-</span>Sans<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -pointsize <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ppt<span style="color:#66d9ef">:-</span>150<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center label:<span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># If the first line, do not write yet.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;00:00:00&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;file &#39;</span>$prevbase<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span>$duration<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Keep the information required for the next file.</span>
</span></span><span style="display:flex;"><span>	prevbase<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$prevtime<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span> &lt; <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Do last file which must be given twice as follows</span>
</span></span><span style="display:flex;"><span>endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>totseconds-seconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;file &#39;</span>$base<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span><span style="color:#e6db74">${</span>endtime<span style="color:#66d9ef">:-</span>5<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">file &#39;</span>$base<span style="color:#e6db74">&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> &gt; <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> -c:a aac -vsync vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -vsync vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Might also try:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -vf &#34;fps=${fps:-24},format=yuv420p&#34; &#34;$outfile&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># but has given some problems.</span>
</span></span></code></pre></div><hr>
<p>echo &ldquo;Hola, esto es una prueba. Este es el fin del año 2025. Chau.&rdquo; | wc -c</p>
<h3 id="espeak-aproximadamente-lee-60-caracteres-cada-5-segundos-para-escribir-el-texto-y-espeak-hace-pausas-con-puntos-y-comas-o-sea-90-caracteres-si-hay-mucha-puntuación-90-caracteres-si-es-texto-continuo">Espeak aproximadamente lee 60 caracteres cada 5 segundos (para escribir el texto). Y espeak hace pausas con puntos y comas. O sea 90 caracteres si hay mucha puntuación 90 caracteres si es texto continuo.</h3>
<h4 id="89-caracteres-5-segundos-aproximadamente-entonces-cuando-no-llegas-hace-esto">89 caracteres 5 segundos aproximadamente. Entonces cuando no llegas hace esto:</h4>
<p>time espeak-ng -v es &ldquo;Empecé al día comiendome un asadito que no cociné con lechuga y una ensalada de papas ja&rdquo; - 5370ms</p>
<p>Usé eso para la regla de 3 simple de la función de vim (más abajo).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bc -l
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>89-51
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">38</span>
</span></span><span style="display:flex;"><span>89-55
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">34</span>
</span></span></code></pre></div><p>Después tenes que hacer 90 caracteres son 5 segundos. Entonces los 38 caracteres que faltan serían 2,1 segundos por regla de 3 simple es decir 2100 milisegundos, y el otro 34 caracteres serían 1,8 segundos es decir 1800 milisegundos.</p>
<h4 id="ejemplo">Ejemplo:</h4>
<p>Empecé al día comiendome un asadito que no cociné con lechuga y una ensalada de papas ja. - 89 caracteres.
Acá están todos los cubiertos que tuve que limpiar. <!-- raw HTML omitted --> - 51 caracteres.
Acá se puede apreciar como dejé todo limpio y ordenado. <!-- raw HTML omitted --> - 55 caracteres.</p>
<h4 id="para-tomar-una-pausa-de-1-minuto-espeak--m--v-mb-us1-speakhello-break-time60s-this-is-a-testspeak">Para tomar una pausa de 1 minuto <code>espeak -m -v mb-us1 &quot;&lt;speak&gt;Hello, &lt;break time='60s'/&gt; this is a test.&lt;/speak&gt;&quot;</code></h4>
<p>Le pregunte a Claude y me dijo que se puede hacer todo con vim.</p>
<p>Definimos esta funcion en <code>.vimrc</code>.</p>
<h1 id="ahora-deje-de-usar-esto-estyo-usando-generar_videosh-de-nobloatnews">Ahora deje de usar esto estyo usando <code>generar_video.sh</code> de nobloatnews.</h1>
<h4 id="esta-es-la-que-estoy-usando-ahora-y-funciona-muy-bien-muy-sincronizado-mejor-que-el-de-abajo">Esta es la que estoy usando ahora Y FUNCIONA MUY BIEN MUY SINCRONIZADO MEJOR QUE EL DE ABAJO.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>:function! AddBreak<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>:  let line <span style="color:#f92672">=</span> getline<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;.&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>:  let len <span style="color:#f92672">=</span> strlen<span style="color:#f92672">(</span>line<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>:  <span style="color:#66d9ef">if</span> len &lt; <span style="color:#ae81ff">90</span> <span style="color:#f92672">&amp;&amp;</span> line !~ <span style="color:#e6db74">&#39;&lt;break time=&#39;</span>
</span></span><span style="display:flex;"><span>:    let missing <span style="color:#f92672">=</span> <span style="color:#ae81ff">90</span> - len
</span></span><span style="display:flex;"><span>:    let ms <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>missing * 5370<span style="color:#f92672">)</span> / <span style="color:#ae81ff">90</span>
</span></span><span style="display:flex;"><span>:    call setline<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;.&#39;</span>, line . <span style="color:#e6db74">&#34; &lt;break time=&#39;&#34;</span> . ms . <span style="color:#e6db74">&#34;ms&#39;/&gt;&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>:  endif
</span></span><span style="display:flex;"><span>:endfunction
</span></span></code></pre></div><hr>
<p>Y uso los scripts que están en el repo de nobloatnews.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>:function! AddBreak<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>:  let line <span style="color:#f92672">=</span> getline<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;.&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>:  let len <span style="color:#f92672">=</span> strlen<span style="color:#f92672">(</span>line<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>:  <span style="color:#66d9ef">if</span> line !~ <span style="color:#e6db74">&#39;&lt;break time=&#39;</span>
</span></span><span style="display:flex;"><span>:    <span style="color:#e6db74">&#34; Calcular tiempo de habla (60ms por carácter)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:    let speech_time = len * 60
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:    &#34;</span> El break debe completar 5000ms
</span></span><span style="display:flex;"><span>:    let break_time <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span> - speech_time
</span></span><span style="display:flex;"><span>:    <span style="color:#e6db74">&#34; Asegurar que el break no sea negativo
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:    if break_time &lt; 500
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:      let break_time = 500
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:    endif
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:    call setline(&#39;.&#39;, line . &#34;</span> &lt;break time<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#34; . break_time . &#34;ms&#39;</span>/&gt;<span style="color:#e6db74">&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:  endif
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:endfunction
</span></span></span></code></pre></div><p>Y ahora abrí el archivo del script y llama a esta funciona: <code>:%g/./call AddBreak()</code></p>
<p>No se puede poner <code>&lt;break time='5000ms'/&gt;</code> solo tenes que agregar una palabra antes, no sé por qué.</p>
<hr>
<p>Perfecto, con <strong>Arch + Bash + Vim</strong> se puede hacer algo <em>muy cómodo e interactivo</em> 👍
La idea correcta no es “medir en vivo” mientras escribes, sino:</p>
<p>👉 <strong>tener una referencia fija de cuántas palabras ≈ 5 segundos</strong>
👉 y que <strong>Vim te marque visualmente</strong> hasta dónde llegas.</p>
<p>Te propongo una solución <strong>realista, rápida y usable en Vim</strong>, sin hacks raros.</p>
<hr>
<h1 id="-idea-general">🧠 Idea general</h1>
<ol>
<li>
<p>Fijas velocidad de <code>espeak-ng</code></p>
</li>
<li>
<p>Calculas <strong>palabras ≈ 5 segundos</strong></p>
</li>
<li>
<p>En Vim:</p>
<ul>
<li>un comando o mapping</li>
<li>que <strong>resalte</strong> las palabras que entran en 5 segundos</li>
<li>y te avise cuando te pasas</li>
</ul>
</li>
</ol>
<hr>
<h1 id="1-fija-velocidad-de-espeak">1️⃣ Fija velocidad de eSpeak</h1>
<p>Ejemplo recomendado:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>espeak-ng -v es -s <span style="color:#ae81ff">160</span>
</span></span></code></pre></div><p>Haz una prueba larga y calcula:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>time espeak-ng -v es -s <span style="color:#ae81ff">160</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>cat texto.txt<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>wc -w texto.txt
</span></span></code></pre></div><p>Supongamos que obtienes:</p>
<pre tabindex="0"><code>8 palabras/segundo
</code></pre><p>➡️ <strong>5 segundos ≈ 40 palabras</strong></p>
<hr>
<h1 id="2-script-bash-marcar-límite-de-palabras">2️⃣ Script Bash: marcar límite de palabras</h1>
<p>Crea este script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># ~/bin/espeak_5s.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MAX<span style="color:#f92672">=</span><span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># texto hasta el cursor</span>
</span></span><span style="display:flex;"><span>texto<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>sed <span style="color:#e6db74">&#39;s/\n/ /g&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>contador<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>salida<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> palabra in $texto; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  contador<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>contador+1<span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>  salida<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$salida<span style="color:#e6db74"> </span>$palabra<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $contador -ge $MAX <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    break
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;</span>$salida<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>Hazlo ejecutable:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod +x ~/bin/espeak_5s.sh
</span></span></code></pre></div><hr>
<h1 id="3-integración-con-vim-la-parte-importante-">3️⃣ Integración con Vim (la parte importante 🔥)</h1>
<h3 id="opción-a--comando-visual-recomendado">Opción A — Comando visual (recomendado)</h3>
<p>En tu <code>~/.vimrc</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span><span style="color:#a6e22e">command</span>! <span style="color:#a6e22e">Espeak5s</span> <span style="color:#a6e22e">call</span> <span style="color:#a6e22e">Espeak5s</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span>! <span style="color:#a6e22e">Espeak5s</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">words</span> = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">text</span> = <span style="color:#a6e22e">getline</span>(<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;$&#39;</span>)-&gt;<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">list</span> = <span style="color:#a6e22e">split</span>(<span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">text</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">limit</span> = <span style="color:#a6e22e">min</span>([<span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">words</span>, <span style="color:#a6e22e">len</span>(<span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">list</span>)])
</span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  &#34; Limpiar highlight previo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">silent</span>! <span style="color:#a6e22e">call</span> <span style="color:#a6e22e">matchdelete</span>(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  &#34; Obtener posición del último word</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">pos</span> = <span style="color:#a6e22e">matchstrpos</span>(<span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">text</span>, <span style="color:#a6e22e">join</span>(<span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">list</span>[:<span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">limit</span><span style="color:#ae81ff">-1</span>], <span style="color:#e6db74">&#39; &#39;</span>))[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  &#34; Resaltar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">call</span> <span style="color:#a6e22e">matchadd</span>(<span style="color:#e6db74">&#39;Visual&#39;</span>, <span style="color:#e6db74">&#39;\%&#39;</span> . (<span style="color:#a6e22e">l</span>:<span style="color:#a6e22e">pos</span>+<span style="color:#ae81ff">1</span>) . <span style="color:#e6db74">&#39;c.*&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">endfunction</span>
</span></span></code></pre></div><p>Usas en Vim:</p>
<pre tabindex="0"><code>:Espeak5s
</code></pre><p>✔️ Todo lo que <strong>pase de 5s queda resaltado</strong>
✔️ Tú escribes normalmente
✔️ Ejecutas cuando quieras</p>
<hr>
<h3 id="opción-b--mapping-rápido">Opción B — Mapping rápido</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span><span style="color:#a6e22e">nnoremap</span> &lt;<span style="color:#a6e22e">leader</span>&gt;<span style="color:#ae81ff">5</span> :<span style="color:#a6e22e">Espeak5s</span>&lt;<span style="color:#a6e22e">CR</span>&gt;
</span></span></code></pre></div><p>Ahora solo presionas:</p>
<pre tabindex="0"><code>\5
</code></pre><hr>
<h1 id="4-bonus-aviso-en-tiempo-real-opcional">4️⃣ Bonus: aviso en tiempo real (opcional)</h1>
<p>Si quieres que <strong>te avise mientras escribes</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vim" data-lang="vim"><span style="display:flex;"><span><span style="color:#66d9ef">autocmd</span> <span style="color:#a6e22e">TextChanged</span>,<span style="color:#a6e22e">TextChangedI</span> * <span style="color:#a6e22e">call</span> <span style="color:#a6e22e">EspeakWarn</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span>! <span style="color:#a6e22e">EspeakWarn</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">max</span> = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">count</span> = <span style="color:#a6e22e">len</span>(<span style="color:#a6e22e">split</span>(<span style="color:#a6e22e">join</span>(<span style="color:#a6e22e">getline</span>(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;$&#39;</span>))))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">count</span> &gt; <span style="color:#a6e22e">max</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">echohl</span> <span style="color:#a6e22e">ErrorMsg</span> | <span style="color:#a6e22e">echo</span> <span style="color:#e6db74">&#34;⚠ Excedes 5 segundos de narración&#34;</span> | <span style="color:#a6e22e">echohl</span> <span style="color:#a6e22e">None</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">echo</span> <span style="color:#e6db74">&#34;OK (&#34;</span> . <span style="color:#a6e22e">count</span> . <span style="color:#e6db74">&#34;/&#34;</span> . <span style="color:#a6e22e">max</span> . <span style="color:#e6db74">&#34; palabras)&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">endif</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">endfunction</span>
</span></span></code></pre></div><hr>
<h1 id="-resultado-final">🧩 Resultado final</h1>
<p>✔️ Escribes normal en Vim
✔️ Sabes cuándo pasas de 5 segundos
✔️ No dependes de audio en tiempo real
✔️ Totalmente Bash + Vim + Arch-friendly 🐧</p>
<hr>
<p>Si quieres, en el próximo mensaje puedo:</p>
<ul>
<li>Ajustar por <strong>frases</strong> en vez de palabras</li>
<li>Usar <strong>párrafos automáticos</strong></li>
<li>O hacer un plugin Vim limpio (<code>autoload/</code>, <code>plugin/</code>)</li>
</ul>
<p>Dime qué nivel de precisión necesitas 🎯</p>
<hr>
<h4 id="subí-el-audio-a-youtube-y-descargá-los-subtitulos-para-pegarlos-con-esto">Subí el audio a YouTube y descargá los subtitulos para pegarlos con esto.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># Script para añadir subtítulos SRT a un video</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Uso: ./add_subtitles.sh video.mp4 subtitulos.srt [salida.mp4] [estilo]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>set -e
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verificar argumentos</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $# -lt <span style="color:#ae81ff">2</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Añadir Subtítulos a Video&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Uso: </span>$0<span style="color:#e6db74"> &lt;video.mp4&gt; &lt;subtitulos.srt&gt; [salida.mp4] [estilo]&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Estilos disponibles:&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  tiktok    - Estilo TikTok (grande, bold, amarillo)&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  instagram - Estilo Instagram (blanco con sombra)&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  youtube   - Estilo YouTube (blanco con fondo negro)&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  simple    - Estilo simple (blanco básico)&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  custom    - Personalizado (edita el script)&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Ejemplos:&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  # Estilo TikTok (default)&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  </span>$0<span style="color:#e6db74"> mi_video.mp4 subtitulos.srt&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  # Estilo Instagram con nombre personalizado&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  </span>$0<span style="color:#e6db74"> mi_video.mp4 subs.srt video_final.mp4 instagram&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  # Estilo YouTube&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  </span>$0<span style="color:#e6db74"> clip.mp4 subtitulos.srt resultado.mp4 youtube&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VIDEO<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>SUBTITLES<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$2<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>OUTPUT<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>3<span style="color:#66d9ef">:-</span><span style="color:#e6db74">${</span>VIDEO%.*<span style="color:#e6db74">}</span>_con_subs.mp4<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>4<span style="color:#66d9ef">:-</span>tiktok<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verificar que los archivos existen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$VIDEO<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Error: El video &#39;</span>$VIDEO<span style="color:#e6db74">&#39; no existe&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$SUBTITLES<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Error: El archivo de subtítulos &#39;</span>$SUBTITLES<span style="color:#e6db74">&#39; no existe&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verificar ffmpeg</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ! command -v ffmpeg &amp;&gt; /dev/null; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Error: ffmpeg no está instalado&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Añadiendo Subtítulos&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Video: </span>$VIDEO<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Subtítulos: </span>$SUBTITLES<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Estilo: </span>$STYLE<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Salida: </span>$OUTPUT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Definir estilos de subtítulos</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span>$STYLE<span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>    tiktok<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Estilo TikTok: Grande, bold, amarillo con borde negro grueso</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=28,PrimaryColour=&amp;H00FFFF,OutlineColour=&amp;H000000,BackColour=&amp;H80000000,Bold=1,Outline=3,Shadow=0,MarginV=40,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Aplicando estilo TikTok (amarillo, bold, grande)&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    instagram<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Estilo Instagram: Blanco con sombra suave</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=24,PrimaryColour=&amp;H00FFFFFF,OutlineColour=&amp;H000000,BackColour=&amp;H80000000,Bold=1,Outline=2,Shadow=1,MarginV=50,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Aplicando estilo Instagram (blanco con sombra)&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    youtube<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Estilo YouTube: Blanco con fondo negro semi-transparente</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=22,PrimaryColour=&amp;H00FFFFFF,OutlineColour=&amp;H000000,BackColour=&amp;HCC000000,Bold=0,Outline=1,Shadow=0,MarginV=30,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Aplicando estilo YouTube (blanco con fondo)&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    simple<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Estilo simple: Blanco básico</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=20,PrimaryColour=&amp;H00FFFFFF,OutlineColour=&amp;H000000,BackColour=&amp;H80000000,Bold=0,Outline=2,Shadow=0,MarginV=20,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Aplicando estilo simple (blanco básico)&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    custom<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Personaliza aquí tu estilo</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=26,PrimaryColour=&amp;H0000FF00,OutlineColour=&amp;H000000,BackColour=&amp;H80000000,Bold=1,Outline=3,Shadow=1,MarginV=45,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Aplicando estilo personalizado&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Error: Estilo &#39;</span>$STYLE<span style="color:#e6db74">&#39; no reconocido&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Usa: tiktok, instagram, youtube, simple, o custom&#34;</span>
</span></span><span style="display:flex;"><span>        exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Procesando video...&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Escapar la ruta del archivo de subtítulos para ffmpeg</span>
</span></span><span style="display:flex;"><span>SUBTITLES_ESCAPED<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>SUBTITLES//<span style="color:#ae81ff">\\</span>/<span style="color:#ae81ff">\\\\</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>SUBTITLES_ESCAPED<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>SUBTITLES_ESCAPED//:/<span style="color:#ae81ff">\\</span>:<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Aplicar subtítulos con el estilo seleccionado</span>
</span></span><span style="display:flex;"><span>ffmpeg -i <span style="color:#e6db74">&#34;</span>$VIDEO<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -vf <span style="color:#e6db74">&#34;subtitles=&#39;</span><span style="color:#e6db74">${</span>SUBTITLES_ESCAPED<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;:force_style=&#39;</span><span style="color:#e6db74">${</span>SUBTITLE_STYLE<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -c:v libx264 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -preset medium <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -crf <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -c:a copy <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -y <span style="color:#e6db74">&#34;</span>$OUTPUT<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -loglevel error -stats
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;✓ Subtítulos añadidos exitosamente!&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Archivo de salida: </span>$OUTPUT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Mostrar tamaño del archivo</span>
</span></span><span style="display:flex;"><span>    SIZE<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>du -h <span style="color:#e6db74">&#34;</span>$OUTPUT<span style="color:#e6db74">&#34;</span> | cut -f1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Tamaño: </span>$SIZE<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Mostrar duración</span>
</span></span><span style="display:flex;"><span>    DURATION<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ffprobe -v error -show_entries format<span style="color:#f92672">=</span>duration -of default<span style="color:#f92672">=</span>noprint_wrappers<span style="color:#f92672">=</span>1:nokey<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$OUTPUT<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Duración: </span><span style="color:#66d9ef">$(</span>printf <span style="color:#e6db74">&#34;%.2f&#34;</span> $DURATION<span style="color:#66d9ef">)</span><span style="color:#e6db74"> segundos&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;✗ Error al añadir subtítulos&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;¡Listo para subir a redes sociales!&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span></code></pre></div><hr>
<h4 id="pasar-del-archivo-de-espeak-con-breaks-a-srt-y-quemarlo-en-el-video">Pasar del archivo de espeak con breaks a srt y quemarlo en el video.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"># Script TODO EN UNO: Convierte script a SRT y lo quema en el video</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Uso: ./auto_subs.sh video.mp4 script.txt [estilo] [duracion_base_ms]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>set -e
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verificar argumentos</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $# -lt <span style="color:#ae81ff">2</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Video + Script = Video con Subtítulos&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Uso: </span>$0<span style="color:#e6db74"> &lt;video.mp4&gt; &lt;script.txt&gt; [estilo] [duracion_base_ms]&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Estilos:&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  tiktok    - Amarillo, grande, bold (default)&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  instagram - Blanco con sombra&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  youtube   - Blanco con fondo negro&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  simple    - Blanco básico&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Ejemplos:&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  # Estilo TikTok, 5370ms por línea&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  </span>$0<span style="color:#e6db74"> mi_video.mp4 mi_script.txt&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  # Estilo Instagram, 5370ms por línea&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  </span>$0<span style="color:#e6db74"> mi_video.mp4 mi_script.txt instagram&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  # Estilo TikTok, 4000ms por línea&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  </span>$0<span style="color:#e6db74"> mi_video.mp4 mi_script.txt tiktok 4000&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VIDEO<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>SCRIPT_FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$2<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>3<span style="color:#66d9ef">:-</span>tiktok<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>BASE_DURATION<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>4<span style="color:#66d9ef">:-</span>5370<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verificar archivos</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$VIDEO<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Error: El video &#39;</span>$VIDEO<span style="color:#e6db74">&#39; no existe&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$SCRIPT_FILE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Error: El script &#39;</span>$SCRIPT_FILE<span style="color:#e6db74">&#39; no existe&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verificar ffmpeg</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ! command -v ffmpeg &amp;&gt; /dev/null; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Error: ffmpeg no está instalado&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Nombres de archivos temporales y finales</span>
</span></span><span style="display:flex;"><span>TEMP_SRT<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;temp_subtitles.srt&#34;</span>
</span></span><span style="display:flex;"><span>OUTPUT_VIDEO<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>VIDEO%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">_con_subs.mp4&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;🎬 Proceso Automático&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Video: </span>$VIDEO<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Script: </span>$SCRIPT_FILE<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Estilo: </span>$STYLE<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Duración base: </span><span style="color:#e6db74">${</span>BASE_DURATION<span style="color:#e6db74">}</span><span style="color:#e6db74">ms&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Salida: </span>$OUTPUT_VIDEO<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PASO 1: Generar SRT desde el script</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;PASO 1: Generando subtítulos SRT...&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Limpiar archivo SRT</span>
</span></span><span style="display:flex;"><span>&gt; <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LINE_NUM<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>CURRENT_TIME_MS<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Función para convertir milisegundos a formato SRT</span>
</span></span><span style="display:flex;"><span>ms_to_srt_time<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    local total_ms<span style="color:#f92672">=</span>$1
</span></span><span style="display:flex;"><span>    local hours<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>total_ms <span style="color:#f92672">/</span> <span style="color:#ae81ff">3600000</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    local minutes<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span><span style="color:#f92672">(</span>total_ms <span style="color:#f92672">%</span> <span style="color:#ae81ff">3600000</span><span style="color:#f92672">)</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">60000</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    local seconds<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span><span style="color:#f92672">(</span>total_ms <span style="color:#f92672">%</span> <span style="color:#ae81ff">60000</span><span style="color:#f92672">)</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    local milliseconds<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>total_ms <span style="color:#f92672">%</span> <span style="color:#ae81ff">1000</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    printf <span style="color:#e6db74">&#34;%02d:%02d:%02d,%03d&#34;</span> $hours $minutes $seconds $milliseconds
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Procesar cada línea del script</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> IFS<span style="color:#f92672">=</span> read -r line <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$line<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Ignorar líneas vacías</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo <span style="color:#e6db74">&#34;</span>$line<span style="color:#e6db74">&#34;</span> | tr -d <span style="color:#e6db74">&#39;[:space:]&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    LINE_NUM<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>LINE_NUM <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Extraer el tiempo del break si existe</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$line<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span>~ <span style="color:#ae81ff">\&lt;</span>break<span style="color:#ae81ff">\ </span>time<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#39;</span><span style="color:#f92672">([</span>0-9<span style="color:#f92672">]</span>+<span style="color:#f92672">)</span>ms<span style="color:#ae81ff">\&#39;</span>/<span style="color:#ae81ff">\&gt;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        BREAK_TIME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BASH_REMATCH[1]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Remover el tag de break del texto</span>
</span></span><span style="display:flex;"><span>        TEXT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo <span style="color:#e6db74">&#34;</span>$line<span style="color:#e6db74">&#34;</span> | sed <span style="color:#e6db74">&#34;s/&lt;break time=&#39;[0-9]*ms&#39;\/&gt;.*//g&#34;</span> | sed <span style="color:#e6db74">&#39;s/[[:space:]]*$//&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        BREAK_TIME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$BASE_DURATION<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        TEXT<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$line<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Calcular tiempos</span>
</span></span><span style="display:flex;"><span>    START_TIME_MS<span style="color:#f92672">=</span>$CURRENT_TIME_MS
</span></span><span style="display:flex;"><span>    END_TIME_MS<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>CURRENT_TIME_MS <span style="color:#f92672">+</span> BASE_DURATION<span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Convertir a formato SRT</span>
</span></span><span style="display:flex;"><span>    START_SRT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ms_to_srt_time $START_TIME_MS<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    END_SRT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ms_to_srt_time $END_TIME_MS<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Escribir al SRT</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;</span>$LINE_NUM<span style="color:#e6db74">&#34;</span> &gt;&gt; <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;</span>$START_SRT<span style="color:#e6db74"> --&gt; </span>$END_SRT<span style="color:#e6db74">&#34;</span> &gt;&gt; <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;</span>$TEXT<span style="color:#e6db74">&#34;</span> &gt;&gt; <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span> &gt;&gt; <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;  ✓ Línea </span>$LINE_NUM<span style="color:#e6db74">: </span>$TEXT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Actualizar tiempo</span>
</span></span><span style="display:flex;"><span>    CURRENT_TIME_MS<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>END_TIME_MS <span style="color:#f92672">+</span> BREAK_TIME<span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span> &lt; <span style="color:#e6db74">&#34;</span>$SCRIPT_FILE<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TOTAL_DURATION_MS<span style="color:#f92672">=</span>$CURRENT_TIME_MS
</span></span><span style="display:flex;"><span>TOTAL_DURATION_S<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>TOTAL_DURATION_MS <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;✓ SRT generado: </span>$LINE_NUM<span style="color:#e6db74"> subtítulos, </span><span style="color:#e6db74">${</span>TOTAL_DURATION_S<span style="color:#e6db74">}</span><span style="color:#e6db74">s totales&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PASO 2: Definir estilo de subtítulos</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;PASO 2: Configurando estilo &#39;</span>$STYLE<span style="color:#e6db74">&#39;...&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span>$STYLE<span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>    tiktok<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=28,PrimaryColour=&amp;H00FFFF,OutlineColour=&amp;H000000,BackColour=&amp;H80000000,Bold=1,Outline=3,Shadow=0,MarginV=40,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    instagram<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=24,PrimaryColour=&amp;H00FFFFFF,OutlineColour=&amp;H000000,BackColour=&amp;H80000000,Bold=1,Outline=2,Shadow=1,MarginV=50,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    youtube<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=22,PrimaryColour=&amp;H00FFFFFF,OutlineColour=&amp;H000000,BackColour=&amp;HCC000000,Bold=0,Outline=1,Shadow=0,MarginV=30,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    simple<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        SUBTITLE_STYLE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FontName=Arial,FontSize=20,PrimaryColour=&amp;H00FFFFFF,OutlineColour=&amp;H000000,BackColour=&amp;H80000000,Bold=0,Outline=2,Shadow=0,MarginV=20,Alignment=2&#34;</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Error: Estilo &#39;</span>$STYLE<span style="color:#e6db74">&#39; no reconocido&#34;</span>
</span></span><span style="display:flex;"><span>        rm -f <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;✓ Estilo configurado&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PASO 3: Quemar subtítulos en el video</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;PASO 3: Quemando subtítulos en video...&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Esto puede tardar varios minutos...&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Escapar ruta del SRT</span>
</span></span><span style="display:flex;"><span>TEMP_SRT_ESCAPED<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TEMP_SRT//<span style="color:#ae81ff">\\</span>/<span style="color:#ae81ff">\\\\</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>TEMP_SRT_ESCAPED<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TEMP_SRT_ESCAPED//:/<span style="color:#ae81ff">\\</span>:<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Aplicar subtítulos</span>
</span></span><span style="display:flex;"><span>ffmpeg -i <span style="color:#e6db74">&#34;</span>$VIDEO<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -vf <span style="color:#e6db74">&#34;subtitles=&#39;</span><span style="color:#e6db74">${</span>TEMP_SRT_ESCAPED<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;:force_style=&#39;</span><span style="color:#e6db74">${</span>SUBTITLE_STYLE<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -c:v libx264 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -preset medium <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -crf <span style="color:#ae81ff">23</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -c:a copy <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -y <span style="color:#e6db74">&#34;</span>$OUTPUT_VIDEO<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>    -loglevel error -stats
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;✓ ¡VIDEO COMPLETADO!&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;📹 Video final: </span>$OUTPUT_VIDEO<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Información del archivo</span>
</span></span><span style="display:flex;"><span>    SIZE<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>du -h <span style="color:#e6db74">&#34;</span>$OUTPUT_VIDEO<span style="color:#e6db74">&#34;</span> | cut -f1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    DURATION<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ffprobe -v error -show_entries format<span style="color:#f92672">=</span>duration -of default<span style="color:#f92672">=</span>noprint_wrappers<span style="color:#f92672">=</span>1:nokey<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$OUTPUT_VIDEO<span style="color:#e6db74">&#34;</span> 2&gt;/dev/null<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;📊 Tamaño: </span>$SIZE<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$DURATION<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        MINUTES<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span><span style="color:#e6db74">${</span>DURATION%.*<span style="color:#e6db74">}</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">60</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>        SECONDS<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span><span style="color:#e6db74">${</span>DURATION%.*<span style="color:#e6db74">}</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">60</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;⏱️  Duración: </span><span style="color:#e6db74">${</span>MINUTES<span style="color:#e6db74">}</span><span style="color:#e6db74">m </span><span style="color:#e6db74">${</span>SECONDS<span style="color:#e6db74">}</span><span style="color:#e6db74">s&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Preguntar si eliminar SRT temporal</span>
</span></span><span style="display:flex;"><span>    read -p <span style="color:#e6db74">&#34;¿Eliminar archivo SRT temporal? (s/n): &#34;</span> -n <span style="color:#ae81ff">1</span> -r
</span></span><span style="display:flex;"><span>    echo
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $REPLY <span style="color:#f92672">=</span>~ ^<span style="color:#f92672">[</span>SsYy<span style="color:#f92672">]</span>$ <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        rm -f <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;✓ SRT temporal eliminado&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;📝 SRT guardado como: </span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;🎉 ¡Listo para subir a redes sociales!&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;========================================&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;✗ Error al quemar subtítulos&#34;</span>
</span></span><span style="display:flex;"><span>    rm -f <span style="color:#e6db74">&#34;</span>$TEMP_SRT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h3 id="nueva-version-de-slider-para-que-maneje-bien-la-sincronizacion-entre-las-imagenes-en-diferentes-reproductores">Nueva version de slider para que maneje bien la sincronizacion entre las imagenes en diferentes reproductores</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Give a file with images and timecodes and creates a video slideshow of them.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Timecodes must be in format 00:00:00.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Imagemagick and ffmpeg required.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Application cache if not stated elsewhere.</span>
</span></span><span style="display:flex;"><span>cache<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XDG_CACHE_HOME<span style="color:#66d9ef">:-</span>$HOME/.cache<span style="color:#e6db74">}</span><span style="color:#e6db74">/slider&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> getopts <span style="color:#e6db74">&#34;hvrpi:c:a:o:d:f:t:e:x:s:&#34;</span> o; <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>o<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	c<span style="color:#f92672">)</span> bgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	t<span style="color:#f92672">)</span> fgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	f<span style="color:#f92672">)</span> font<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	i<span style="color:#f92672">)</span> file<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	a<span style="color:#f92672">)</span> audio<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	o<span style="color:#f92672">)</span> outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	d<span style="color:#f92672">)</span> prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	r<span style="color:#f92672">)</span> redo<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	s<span style="color:#f92672">)</span> ppt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	e<span style="color:#f92672">)</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	x<span style="color:#f92672">)</span> res<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$res<span style="color:#e6db74">&#34;</span> | grep -qv <span style="color:#e6db74">&#34;^[0-9]\+x[0-9]\+</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			echo <span style="color:#e6db74">&#34;Resolution must be dimensions separated by a &#39;x&#39;: 1280x720, etc.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	p<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;Purge old build files in </span>$cache<span style="color:#e6db74">? [y/N]&#34;</span>
</span></span><span style="display:flex;"><span>		read -r confirm
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$confirm<span style="color:#e6db74">&#34;</span> | grep -iq <span style="color:#e6db74">&#34;^y</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> rm -rf <span style="color:#e6db74">&#34;</span>$cache<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Done.&#34;</span>
</span></span><span style="display:flex;"><span>		exit ;;
</span></span><span style="display:flex;"><span>	v<span style="color:#f92672">)</span> verbose<span style="color:#f92672">=</span>True ;;
</span></span><span style="display:flex;"><span>	*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$0<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74"> usage:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -i  input timecode list (required)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -a  audio file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -c  color of background (use html names, black is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -t  text color for text slides (white is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -s  text font size for text slides (150 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -f  text font for text slides (sans serif is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -o  output video file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -e  if no audio given, the time in seconds that the last slide will be shown (5 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -x  resolution (1920x1080 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -d  tmp directory
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -r  rerun imagemagick commands even if done previously (in case files or background has changed)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -p  purge old build files instead of running
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -v  be verbose&#34;</span> <span style="color:#f92672">&amp;&amp;</span> exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span> <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check that the input file looks like it should.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span> head -n <span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> 2&gt;/dev/null | grep -q <span style="color:#e6db74">&#34;^00:00:00	&#34;</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">||</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;Give an input file with -i.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;The file should look as this example:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:00	first_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:03	otherdirectory/next_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:09	this_image_starts_at_9_seconds.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">etc...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Timecodes and filenames must be separated by Tabs.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Check that the audio file looks like an actual audio file.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>		audio/*<span style="color:#f92672">)</span> ;;
</span></span><span style="display:flex;"><span>		*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;That doesn&#39;t look like an audio file.&#34;</span>; exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>	totseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#66d9ef">$(</span>ffmpeg -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> 2&gt;&amp;<span style="color:#ae81ff">1</span> | awk <span style="color:#e6db74">&#39;/Duration/ {print $2}&#39;</span> | sed s/,//<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>prepdir<span style="color:#66d9ef">:-</span>$cache/$file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>outfile<span style="color:#66d9ef">:-</span>$file.mp4<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>prepfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$file<span style="color:#e6db74">.prep&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>verbose+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Preparing images... May take a while depending on the number of files.&#34;</span>
</span></span><span style="display:flex;"><span>mkdir -p <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read -r x;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the time from the first column.</span>
</span></span><span style="display:flex;"><span>	time<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x%%	*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	seconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Duration is not used on the first looped item.</span>
</span></span><span style="display:flex;"><span>	duration<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>seconds <span style="color:#f92672">-</span> prevseconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the filename/text content from the rest.</span>
</span></span><span style="display:flex;"><span>	content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x#*	<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>base%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">.jpg&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># If images have already been made in a previous run, do not recreate</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># them unless -r was given.</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> canvas:<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> -resize 1920x1080 -composite <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -background <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -fill <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>fgc<span style="color:#66d9ef">:-</span>white<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -font <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>font<span style="color:#66d9ef">:-</span>Sans<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -pointsize <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ppt<span style="color:#66d9ef">:-</span>150<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center label:<span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># If the first line, do not write yet.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;00:00:00&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;file &#39;</span>$prevbase<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span>$duration<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Keep the information required for the next file.</span>
</span></span><span style="display:flex;"><span>	prevbase<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$prevtime<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span> &lt; <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Do last file which must be given twice as follows</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Si el audio dura menos el tiempo que el video el endtime deberia ser 3.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>longitud_audio_float<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ffprobe -v error -show_entries format<span style="color:#f92672">=</span>duration -of default<span style="color:#f92672">=</span>noprint_wrappers<span style="color:#f92672">=</span>1:nokey<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> $audio<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>longitud_audio<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>printf <span style="color:#e6db74">&#34;%.0f&#34;</span> $longitud_audio_float<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cantidad_imagenes<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>cat $file | wc -l<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 3 segundos cada imagen</span>
</span></span><span style="display:flex;"><span>longitud_video<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>cantidad_imagenes*2<span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">((</span>longitud_audio &gt;<span style="color:#f92672">=</span> longitud_video<span style="color:#f92672">))</span> <span style="color:#f92672">&amp;&amp;</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>totseconds-seconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">((</span>longitud_video &gt; longitud_audio<span style="color:#f92672">))</span> <span style="color:#f92672">&amp;&amp;</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;file &#39;</span>$base<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span><span style="color:#e6db74">${</span>endtime<span style="color:#66d9ef">:-</span>2<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">file &#39;</span>$base<span style="color:#e6db74">&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> &gt; <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> -c:a aac -vsync cfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -vsync cfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Might also try:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -vf &#34;fps=${fps:-24},format=yuv420p&#34; &#34;$outfile&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># but has given some problems.</span>
</span></span></code></pre></div>
</div>


      </div>
    </section>
  </section><script 
src="/quiz/quizdown.js">
</script>
<script 
src="/quiz/quizdownKatex.js">
</script>
<script 
src="/quiz/quizdownHighlight.js">
</script>
<script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
<footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      <a class="" href="https://imlauera.github.io/index.xml" target="_blank">
        <span>
          RSS
        </span>
      </a>
      
      | <a href="https://imlauera.github.io" target="_blank">Andres Imlauer.</a> 

      
      
    </p>
    
  </div>




<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
</footer>


</body>
</html>
