<!DOCTYPE html>
<html lang="es">





<head>
  <meta property="og:url" content="https://imlauera.github.io/slider_lukesmith/">
  <meta property="og:site_name" content="Imlauer">
  <meta property="og:title" content="Generate videos cli">
  <meta property="og:description" content="Subí el audio a youtube esto lo hago usando un script para agregar una imagen al audio porque no se puede subir audios a youtube y descargá los subtítulos usando esto: https://imlauera.github.io/srt_to_txt/
yt-dlp --ignore-config --write-subs --write-auto-sub --sub-lang es --sub-format &#34;srt&#34; --skip-download https://www.youtube.com/watch?v=VIDEO_ID sed -E &#39;/^[0-9]&#43;$|^$/d; /^[0-9]{2}:/d&#39; video.en.srt &gt; subtitles.txt ls *.jpg | sort | ./slider_gen_timestamps.sh &gt; video cat chatgpt.txt | espeak-ng -v es -w rock.wav ./slider -i video -a rock.wav Lo haremos usando el script de LukeSmith: slider.">
  <meta property="og:locale" content="es_es">
  <meta property="og:type" content="article">
    <meta property="article:published_time" content="2025-12-02T02:03:33-03:00">
    <meta property="article:modified_time" content="2025-12-02T02:03:33-03:00">

  
  <meta itemprop="name" content="Generate videos cli">
  <meta itemprop="description" content="Subí el audio a youtube esto lo hago usando un script para agregar una imagen al audio porque no se puede subir audios a youtube y descargá los subtítulos usando esto: https://imlauera.github.io/srt_to_txt/
yt-dlp --ignore-config --write-subs --write-auto-sub --sub-lang es --sub-format &#34;srt&#34; --skip-download https://www.youtube.com/watch?v=VIDEO_ID sed -E &#39;/^[0-9]&#43;$|^$/d; /^[0-9]{2}:/d&#39; video.en.srt &gt; subtitles.txt ls *.jpg | sort | ./slider_gen_timestamps.sh &gt; video cat chatgpt.txt | espeak-ng -v es -w rock.wav ./slider -i video -a rock.wav Lo haremos usando el script de LukeSmith: slider.">
  <meta itemprop="datePublished" content="2025-12-02T02:03:33-03:00">
  <meta itemprop="dateModified" content="2025-12-02T02:03:33-03:00">
  <meta itemprop="wordCount" content="1059">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Generate videos cli">
  <meta name="twitter:description" content="Subí el audio a youtube esto lo hago usando un script para agregar una imagen al audio porque no se puede subir audios a youtube y descargá los subtítulos usando esto: https://imlauera.github.io/srt_to_txt/
yt-dlp --ignore-config --write-subs --write-auto-sub --sub-lang es --sub-format &#34;srt&#34; --skip-download https://www.youtube.com/watch?v=VIDEO_ID sed -E &#39;/^[0-9]&#43;$|^$/d; /^[0-9]{2}:/d&#39; video.en.srt &gt; subtitles.txt ls *.jpg | sort | ./slider_gen_timestamps.sh &gt; video cat chatgpt.txt | espeak-ng -v es -w rock.wav ./slider -i video -a rock.wav Lo haremos usando el script de LukeSmith: slider.">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Generate videos cli
    
  </title>
  <link rel="stylesheet" href='https://imlauera.github.io/css/site.min.css'>
  <link rel="canonical" href="https://imlauera.github.io/slider_lukesmith/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://imlauera.github.io/index.xml" title="Imlauer">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <meta name="author" content="Imlauer.">
  <meta name="description" content="Subí el audio a youtube esto lo hago usando un script para agregar una imagen al audio porque no se puede subir audios a youtube y descargá los subtítulos usando esto: https://imlauera.github.io/srt_to_txt/
yt-dlp --ignore-config --write-subs --write-auto-sub --sub-lang es --sub-format &#34;srt&#34; --skip-download https://www.youtube.com/watch?v=VIDEO_ID
sed -E &#39;/^[0-9]&#43;$|^$/d; /^[0-9]{2}:/d&#39; video.en.srt &gt; subtitles.txt

ls *.jpg | sort | ./slider_gen_timestamps.sh &gt; video
cat chatgpt.txt | espeak-ng -v es -w rock.wav
./slider -i video -a rock.wav
Lo haremos usando el script de LukeSmith: slider.">
</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://imlauera.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="/img/memememe.jpg">
      </figure>
    </a>
    <a class="navbar-item" href="https://imlauera.github.io/">
      Imlauer
    </a>
    <a class="navbar-item" href="/acerca/">
      Acerca de Mi
    </a>
  </div>
  
  
</nav>

  <section>
    <section class='hero is-small is-link is-fullwidth'>
      <div class="hero-body">
<div class="container">
  <h1 class="title">
    Generate videos cli
  </h1>
  <h2 class="subtitle">
    <time datetime='2025-12-02T02:03:33-03:00'>
      December 02, 2025
    </time>
    
  </h2>
</div>

      </div>
    </section>
    <section class="section">
      <div class="container">
<div class="content is-medium">
  <p>Subí el audio a youtube esto lo hago usando un script para agregar una imagen al audio porque no se puede subir audios a youtube y descargá los subtítulos usando esto: <a href="https://imlauera.github.io/srt_to_txt/">https://imlauera.github.io/srt_to_txt/</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yt-dlp --ignore-config --write-subs --write-auto-sub --sub-lang es --sub-format <span style="color:#e6db74">&#34;srt&#34;</span> --skip-download https://www.youtube.com/watch?v<span style="color:#f92672">=</span>VIDEO_ID
</span></span><span style="display:flex;"><span>sed -E <span style="color:#e6db74">&#39;/^[0-9]+$|^$/d; /^[0-9]{2}:/d&#39;</span> video.en.srt &gt; subtitles.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ls *.jpg | sort | ./slider_gen_timestamps.sh &gt; video
</span></span><span style="display:flex;"><span>cat chatgpt.txt | espeak-ng -v es -w rock.wav
</span></span><span style="display:flex;"><span>./slider -i video -a rock.wav
</span></span></code></pre></div><p><strong>Lo haremos usando el script de LukeSmith: <code>slider</code>.</strong></p>
<h3 id="agarré-la-transcripción-del-audio-lo-tire-a-chatgpt-y-lo-pasé-a-cat-chatgpttxt--espeak-ng--v-es--w-rockwav-que-me-generó-un-archivo-de-audio-y-luego-se-lo-pasé-a-slider">Agarré la transcripción del audio lo tire a chatgpt y lo pasé a <code>cat chatgpt.txt | espeak-ng -v es -w rock.wav</code> que me generó un archivo de audio y luego se lo pasé a <code>slider</code>.</h3>
<p>Primero grabá el audio y después ajustá los timestamp para la longitud de ese audio.</p>
<h4 id="tenes-que-pasar-el-archivo-de-audio-con--a-de-lo-contrario-tirará-un-error-más-abajo-explico-como-solucionarlo">Tenes que pasar el archivo de audio con <code>-a</code> de lo contrario tirará un error, más abajo explico como solucionarlo.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ./slider
</span></span><span style="display:flex;"><span>Give an input file with -i.
</span></span><span style="display:flex;"><span>The file should look as this example:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>00:00:00        first_image.jpg
</span></span><span style="display:flex;"><span>00:00:03        otherdirectory/next_image.jpg
</span></span><span style="display:flex;"><span>00:00:09        this_image_starts_at_9_seconds.jpg
</span></span><span style="display:flex;"><span>etc...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Timecodes and filenames must be separated by Tabs.
</span></span></code></pre></div><p>Tuve que cambiar</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	audio/*<span style="color:#f92672">)</span> ;;
</span></span></code></pre></div><p>a</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	video/*<span style="color:#f92672">)</span> ;;
</span></span></code></pre></div><p>Porque no me tomaba m4a como un archivo de audio.</p>
<p>El script tiene un problema y no me permite generar videos <strong>sin audio</strong> porque el <code>video.prep</code> generaba un valor negativo entonces hice lo siguiente</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd .cache/slider/mi_video
</span></span></code></pre></div><p>Y acá están las imágenes generadas por magick con la resolución corregida.</p>
<p>Entonces edito el archivo video.prep arreglo el tiempo negativo del último archivo y ejecuté:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;video.prep&#34;</span> -fps_mode vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;video.mp4&#34;</span>
</span></span></code></pre></div><p>Y dejo el ultimo nombre archivo sin nada abajo</p>
<h5 id="lo-podes-conseguir-clonando-su-repo-mas-abajo-pegue-el-codigo-del-script">Lo podes conseguir clonando su repo (mas abajo pegue el codigo del script)</h5>
<pre tabindex="0"><code>git clone https://github.com/lukesmithxyz/voidrice
cd .local/bin/
./slider
</code></pre><p>Cambie esto en el codigo: <code>-vsync vfr</code> lo reemplace por <code>-fps_mode vfr</code>.</p>
<hr>
<h4 id="esto-te-sirve-para-generar-los-timestamps-una-imagen-cada-20-segundos-lo-guarde-como-slider_gen_timestampssh">Esto te sirve para generar los timestamps (una imagen cada 20 segundos) lo guarde como <code>slider_gen_timestamps.sh</code>.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Usage: ./gen_timestamps.sh *.jpg</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># or:    ls *.jpg | sort | ./gen_timestamps.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sec<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read -r file; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Format seconds → HH:MM:SS</span>
</span></span><span style="display:flex;"><span>    timestamp<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>printf <span style="color:#e6db74">&#34;%02d:%02d:%02d&#34;</span> <span style="color:#66d9ef">$((</span>sec/3600<span style="color:#66d9ef">))</span> <span style="color:#66d9ef">$((</span><span style="color:#f92672">(</span>sec/60<span style="color:#f92672">)%</span><span style="color:#ae81ff">60</span><span style="color:#66d9ef">))</span> <span style="color:#66d9ef">$((</span>sec%60<span style="color:#66d9ef">)))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf <span style="color:#e6db74">&#34;%s\t%s\n&#34;</span> <span style="color:#e6db74">&#34;</span>$timestamp<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Add 20 seconds for next file</span>
</span></span><span style="display:flex;"><span>    sec<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>sec <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><h4 id="ahora-en-la-carpeta-en-donde-tengas-todas-las-imagenes-ejecuta">Ahora en la carpeta en donde tengas todas las imagenes ejecuta:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls *.jpg | sort | ./slider_gen_timestamps.sh &gt; video
</span></span></code></pre></div><h4 id="ahora-creamos-el-video">Ahora creamos el video:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./slider -i video -a audio.mp3
</span></span></code></pre></div><p>Si el audio es m4a tendras que hacer una ligera modificacion en el codigo que expliqué en este mismo articulo más arriba.</p>
<h4 id="slider">Slider</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Give a file with images and timecodes and creates a video slideshow of them.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Timecodes must be in format 00:00:00.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Imagemagick and ffmpeg required.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Application cache if not stated elsewhere.</span>
</span></span><span style="display:flex;"><span>cache<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XDG_CACHE_HOME<span style="color:#66d9ef">:-</span>$HOME/.cache<span style="color:#e6db74">}</span><span style="color:#e6db74">/slider&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> getopts <span style="color:#e6db74">&#34;hvrpi:c:a:o:d:f:t:e:x:s:&#34;</span> o; <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>o<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>	c<span style="color:#f92672">)</span> bgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	t<span style="color:#f92672">)</span> fgc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	f<span style="color:#f92672">)</span> font<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	i<span style="color:#f92672">)</span> file<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	a<span style="color:#f92672">)</span> audio<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	o<span style="color:#f92672">)</span> outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	d<span style="color:#f92672">)</span> prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	r<span style="color:#f92672">)</span> redo<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	s<span style="color:#f92672">)</span> ppt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	e<span style="color:#f92672">)</span> endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span> ;;
</span></span><span style="display:flex;"><span>	x<span style="color:#f92672">)</span> res<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OPTARG<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$res<span style="color:#e6db74">&#34;</span> | grep -qv <span style="color:#e6db74">&#34;^[0-9]\+x[0-9]\+</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			echo <span style="color:#e6db74">&#34;Resolution must be dimensions separated by a &#39;x&#39;: 1280x720, etc.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	p<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;Purge old build files in </span>$cache<span style="color:#e6db74">? [y/N]&#34;</span>
</span></span><span style="display:flex;"><span>		read -r confirm
</span></span><span style="display:flex;"><span>		echo <span style="color:#e6db74">&#34;</span>$confirm<span style="color:#e6db74">&#34;</span> | grep -iq <span style="color:#e6db74">&#34;^y</span>$<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> rm -rf <span style="color:#e6db74">&#34;</span>$cache<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Done.&#34;</span>
</span></span><span style="display:flex;"><span>		exit ;;
</span></span><span style="display:flex;"><span>	v<span style="color:#f92672">)</span> verbose<span style="color:#f92672">=</span>True ;;
</span></span><span style="display:flex;"><span>	*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$0<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74"> usage:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -i  input timecode list (required)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -a  audio file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -c  color of background (use html names, black is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -t  text color for text slides (white is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -s  text font size for text slides (150 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -f  text font for text slides (sans serif is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -o  output video file
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -e  if no audio given, the time in seconds that the last slide will be shown (5 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -x  resolution (1920x1080 is default)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -d  tmp directory
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -r  rerun imagemagick commands even if done previously (in case files or background has changed)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -p  purge old build files instead of running
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  -v  be verbose&#34;</span> <span style="color:#f92672">&amp;&amp;</span> exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span> <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check that the input file looks like it should.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span> head -n <span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span> 2&gt;/dev/null | grep -q <span style="color:#e6db74">&#34;^00:00:00	&#34;</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">||</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;Give an input file with -i.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;The file should look as this example:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:00	first_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:03	otherdirectory/next_image.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">00:00:09	this_image_starts_at_9_seconds.jpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">etc...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Timecodes and filenames must be separated by Tabs.&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>	exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Check that the audio file looks like an actual audio file.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file --dereference --brief --mime-type -- <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>		audio/*<span style="color:#f92672">)</span> ;;
</span></span><span style="display:flex;"><span>		*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;That doesn&#39;t look like an audio file.&#34;</span>; exit <span style="color:#ae81ff">1</span> ;;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>	totseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#66d9ef">$(</span>ffmpeg -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> 2&gt;&amp;<span style="color:#ae81ff">1</span> | awk <span style="color:#e6db74">&#39;/Duration/ {print $2}&#39;</span> | sed s/,//<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prepdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>prepdir<span style="color:#66d9ef">:-</span>$cache/$file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>outfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>outfile<span style="color:#66d9ef">:-</span>$file.mp4<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>prepfile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$file<span style="color:#e6db74">.prep&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>verbose+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Preparing images... May take a while depending on the number of files.&#34;</span>
</span></span><span style="display:flex;"><span>mkdir -p <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read -r x;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the time from the first column.</span>
</span></span><span style="display:flex;"><span>	time<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x%%	*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	seconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Duration is not used on the first looped item.</span>
</span></span><span style="display:flex;"><span>	duration<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>seconds <span style="color:#f92672">-</span> prevseconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Get the filename/text content from the rest.</span>
</span></span><span style="display:flex;"><span>	content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>x#*	<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	base<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>base%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">.jpg&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># If images have already been made in a previous run, do not recreate</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e"># them unless -r was given.</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> canvas:<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center <span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> -resize 1920x1080 -composite <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">{</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>redo+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ;<span style="color:#f92672">}</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>			magick -size <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>res<span style="color:#66d9ef">:-</span>1920x1080<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -background <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bgc<span style="color:#66d9ef">:-</span>black<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -fill <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>fgc<span style="color:#66d9ef">:-</span>white<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -font <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>font<span style="color:#66d9ef">:-</span>Sans<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -pointsize <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ppt<span style="color:#66d9ef">:-</span>150<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -gravity center label:<span style="color:#e6db74">&#34;</span>$content<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$prepdir<span style="color:#e6db74">/</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># If the first line, do not write yet.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;00:00:00&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;file &#39;</span>$prevbase<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span>$duration<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Keep the information required for the next file.</span>
</span></span><span style="display:flex;"><span>	prevbase<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$base<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$time<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	prevseconds<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%s&#39;</span> -d <span style="color:#e6db74">&#34;</span>$prevtime<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span> &lt; <span style="color:#e6db74">&#34;</span>$file<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Do last file which must be given twice as follows</span>
</span></span><span style="display:flex;"><span>endtime<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$((</span>totseconds-seconds<span style="color:#66d9ef">))</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;file &#39;</span>$base<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">duration </span><span style="color:#e6db74">${</span>endtime<span style="color:#66d9ef">:-</span>5<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">file &#39;</span>$base<span style="color:#e6db74">&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> &gt; <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>audio+x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -i <span style="color:#e6db74">&#34;</span>$audio<span style="color:#e6db74">&#34;</span> -c:a aac -vsync vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>	ffmpeg -hide_banner -y -f concat -safe <span style="color:#ae81ff">0</span> -i <span style="color:#e6db74">&#34;</span>$prepfile<span style="color:#e6db74">&#34;</span> -vsync vfr -c:v libx264 -pix_fmt yuv420p <span style="color:#e6db74">&#34;</span>$outfile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Might also try:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -vf &#34;fps=${fps:-24},format=yuv420p&#34; &#34;$outfile&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># but has given some problems.</span>
</span></span></code></pre></div>
</div>


      </div>
    </section>
  </section><script 
src="/quiz/quizdown.js">
</script>
<script 
src="/quiz/quizdownKatex.js">
</script>
<script 
src="/quiz/quizdownHighlight.js">
</script>
<script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
<footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      <a class="" href="https://imlauera.github.io/index.xml" target="_blank">
        <span>
          RSS
        </span>
      </a>
      
      | <a href="https://imlauera.github.io" target="_blank">Andres Imlauer.</a> 

      
      
    </p>
    
  </div>




<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
</footer>


</body>
</html>
