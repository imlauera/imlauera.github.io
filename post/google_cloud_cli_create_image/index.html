<!DOCTYPE html>
<html lang="es">





<head>
  <meta property="og:url" content="https://imlauera.github.io/post/google_cloud_cli_create_image/">
  <meta property="og:site_name" content="Imlauer">
  <meta property="og:title" content="Google cloud CLI creamos borramos imágenes de maquinas virtuales">
  <meta property="og:description" content="https://invidious.materialio.us/search?q=google&#43;cloud&#43;cli&#43;create&#43;image
https://youtube.com/watch?v=RPYFbMXc-1Q
https://youtube.com/watch?v=LxHiCZCKwa8
https://youtube.com/watch?v=JW5YB0lOypY
https://youtube.com/watch?v=7CvD6oHmYxU
https://youtube.com/watch?v=KpYO6Ru8MOI
https://youtube.com/watch?v=jlLE157HCR4
https://youtube.com/watch?v=rpmOM5jJJfY
https://youtube.com/watch?v=dtKM8MJqI48
https://youtube.com/watch?v=AA7Dpyjic64
Creamos una compute engine disk image Para empezar tenemos una máquina virtual que hemos configurado, la usaremos como template para la nueva imagen, el primer paso es eliminar la máquina virtual pero guardaremos el disco persistente del boot(arranque). Así que usamos el siguiente comando:
gcloud compute instances delete gold-template --keep-disks boot en donde gold-template es el nombre de la máquina virtual.">
  <meta property="og:locale" content="es_es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-09-21T22:30:06-03:00">
    <meta property="article:modified_time" content="2024-09-21T22:30:06-03:00">
    <meta property="article:tag" content="Google">
    <meta property="article:tag" content="Cloud">
    <meta property="article:tag" content="Cli">

  
  <meta itemprop="name" content="Google cloud CLI creamos borramos imágenes de maquinas virtuales">
  <meta itemprop="description" content="https://invidious.materialio.us/search?q=google&#43;cloud&#43;cli&#43;create&#43;image
https://youtube.com/watch?v=RPYFbMXc-1Q
https://youtube.com/watch?v=LxHiCZCKwa8
https://youtube.com/watch?v=JW5YB0lOypY
https://youtube.com/watch?v=7CvD6oHmYxU
https://youtube.com/watch?v=KpYO6Ru8MOI
https://youtube.com/watch?v=jlLE157HCR4
https://youtube.com/watch?v=rpmOM5jJJfY
https://youtube.com/watch?v=dtKM8MJqI48
https://youtube.com/watch?v=AA7Dpyjic64
Creamos una compute engine disk image Para empezar tenemos una máquina virtual que hemos configurado, la usaremos como template para la nueva imagen, el primer paso es eliminar la máquina virtual pero guardaremos el disco persistente del boot(arranque). Así que usamos el siguiente comando:
gcloud compute instances delete gold-template --keep-disks boot en donde gold-template es el nombre de la máquina virtual.">
  <meta itemprop="datePublished" content="2024-09-21T22:30:06-03:00">
  <meta itemprop="dateModified" content="2024-09-21T22:30:06-03:00">
  <meta itemprop="wordCount" content="554">
  <meta itemprop="keywords" content="Google,Cloud,Cli">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Google cloud CLI creamos borramos imágenes de maquinas virtuales">
  <meta name="twitter:description" content="https://invidious.materialio.us/search?q=google&#43;cloud&#43;cli&#43;create&#43;image
https://youtube.com/watch?v=RPYFbMXc-1Q
https://youtube.com/watch?v=LxHiCZCKwa8
https://youtube.com/watch?v=JW5YB0lOypY
https://youtube.com/watch?v=7CvD6oHmYxU
https://youtube.com/watch?v=KpYO6Ru8MOI
https://youtube.com/watch?v=jlLE157HCR4
https://youtube.com/watch?v=rpmOM5jJJfY
https://youtube.com/watch?v=dtKM8MJqI48
https://youtube.com/watch?v=AA7Dpyjic64
Creamos una compute engine disk image Para empezar tenemos una máquina virtual que hemos configurado, la usaremos como template para la nueva imagen, el primer paso es eliminar la máquina virtual pero guardaremos el disco persistente del boot(arranque). Así que usamos el siguiente comando:
gcloud compute instances delete gold-template --keep-disks boot en donde gold-template es el nombre de la máquina virtual.">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Google cloud CLI creamos borramos imágenes de maquinas virtuales
    
  </title>
  <link rel="stylesheet" href='https://imlauera.github.io/css/site.min.css'>
  <link rel="canonical" href="https://imlauera.github.io/post/google_cloud_cli_create_image/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://imlauera.github.io/index.xml" title="Imlauer">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <meta name="author" content="Imlauer.">
  <meta name="description" content="https://invidious.materialio.us/search?q=google&#43;cloud&#43;cli&#43;create&#43;image
https://youtube.com/watch?v=RPYFbMXc-1Q
https://youtube.com/watch?v=LxHiCZCKwa8
https://youtube.com/watch?v=JW5YB0lOypY
https://youtube.com/watch?v=7CvD6oHmYxU
https://youtube.com/watch?v=KpYO6Ru8MOI
https://youtube.com/watch?v=jlLE157HCR4
https://youtube.com/watch?v=rpmOM5jJJfY
https://youtube.com/watch?v=dtKM8MJqI48
https://youtube.com/watch?v=AA7Dpyjic64

Creamos una compute engine disk image
Para empezar tenemos una máquina virtual que hemos configurado, la usaremos como template para la nueva imagen, el primer paso es eliminar la máquina virtual pero guardaremos el disco persistente del boot(arranque).
Así que usamos el siguiente comando:
gcloud compute instances delete gold-template --keep-disks boot
en donde gold-template es el nombre de la máquina virtual.">
</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://imlauera.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="/img/memememe.jpg">
      </figure>
    </a>
    <a class="navbar-item" href="https://imlauera.github.io/">
      Imlauer
    </a>
    <a class="navbar-item" href="/acerca/">
      Acerca de Mi
    </a>
  </div>
  
  
</nav>

  <section>
    <section class='hero is-small is-link is-fullwidth'>
      <div class="hero-body">
<div class="container">
  <h1 class="title">
    Google cloud CLI creamos borramos imágenes de maquinas virtuales
  </h1>
  <h2 class="subtitle">
    <time datetime='2024-09-21T22:30:06-03:00'>
      September 21, 2024
    </time>
    
    <br>
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/google/">Google</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/cloud/">Cloud</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/cli/">Cli</a>
    
    
    
  </h2>
</div>

      </div>
    </section>
    <section class="section">
      <div class="container">
<div class="content is-medium">
  <p><a href="https://invidious.materialio.us/search?q=google+cloud+cli+create+image">https://invidious.materialio.us/search?q=google+cloud+cli+create+image</a></p>
<p><a href="https://youtube.com/watch?v=RPYFbMXc-1Q">https://youtube.com/watch?v=RPYFbMXc-1Q</a></p>
<p><a href="https://youtube.com/watch?v=LxHiCZCKwa8">https://youtube.com/watch?v=LxHiCZCKwa8</a></p>
<p><a href="https://youtube.com/watch?v=JW5YB0lOypY">https://youtube.com/watch?v=JW5YB0lOypY</a></p>
<p><a href="https://youtube.com/watch?v=7CvD6oHmYxU">https://youtube.com/watch?v=7CvD6oHmYxU</a></p>
<p><a href="https://youtube.com/watch?v=KpYO6Ru8MOI">https://youtube.com/watch?v=KpYO6Ru8MOI</a></p>
<p><a href="https://youtube.com/watch?v=jlLE157HCR4">https://youtube.com/watch?v=jlLE157HCR4</a></p>
<p><a href="https://youtube.com/watch?v=rpmOM5jJJfY">https://youtube.com/watch?v=rpmOM5jJJfY</a></p>
<p><a href="https://youtube.com/watch?v=dtKM8MJqI48">https://youtube.com/watch?v=dtKM8MJqI48</a></p>
<p><a href="https://youtube.com/watch?v=AA7Dpyjic64">https://youtube.com/watch?v=AA7Dpyjic64</a></p>
<hr>
<h3 id="creamos-una-compute-engine-disk-image">Creamos una compute engine disk image</h3>
<p>Para empezar tenemos una máquina virtual que hemos configurado, la usaremos como template para la nueva imagen, el primer paso es eliminar la máquina virtual pero guardaremos el disco persistente del boot(arranque).
Así que usamos el siguiente comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute instances delete gold-template --keep-disks boot
</span></span></code></pre></div><p>en donde gold-template es el nombre de la máquina virtual.</p>
<p>Ahora crearemos una imagen de ese disco con el siguiente comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute images create gold-image --source-disk gold-template
</span></span></code></pre></div><p>Ahora que tenemos las imágenes, podemos crear nuevas máquinas virtuales a partir de ellas con el siguiente comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute instances create --image gold-image new-vm <span style="color:#75715e"># new-vm es el nombre de la nueva maquina virtual</span>
</span></span></code></pre></div><p>Ahora podemos ingresar a la VM a través del SSH con el comando: <code>gcloud compute ssh new-vm</code></p>
<p>Y podemos ver que nuestra nueva máquina virtual tiene la misma configuración que el &ldquo;template&rdquo; original de la máquina virtual.</p>
<hr>
<h3 id="gcloud-cli">Gcloud CLI</h3>
<p>Buscá gcloud cli download, descargalo e instalalo.</p>
<h3 id="inicializar-gcloud-cli">Inicializar gcloud cli.</h3>
<p>Ejecutá <code>gcloud init</code>, te pedirá que ingreses a tu cuenta de google.</p>
<p>Alternativas a <code>gcloud init</code> pero usaremos <code>gcloud init</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud auth login 
</span></span><span style="display:flex;"><span>gcloud auth activate-service-account
</span></span></code></pre></div><p>Si no tenés acceso a Xorg.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud init --no-launch-browser
</span></span></code></pre></div><p>Ahora luego de ejecutar <code>gcloud init</code> te pedirá que selecciones el proyecto o crees uno nuevo o que entres un ID de algún proyecto.</p>
<h3 id="creando-imagen-custom-de-una-instancia-de-una-máquina-virtual-en-gcp-usando-gcloud-cli">Creando imagen custom de una instancia de una máquina virtual en GCP usando gcloud CLI</h3>
<pre tabindex="0"><code>gcloud version
gcloud compute instances list
gcloud compute machine-images create demo-image --source-instance=demo-instance --source-instance-zone=us-central1-c 
gcloud compute instances create demo-instance-1 --zone=us-central1-c --source-machine-image=demo-image
gcloud compute instances list
gcloud compute instances delete demo-instance-1 --zone=us-central1-c
gcloud compute instances list
gcloud compute machine-images delete demo-image
</code></pre><h3 id="creando-y-eliminando-repositorios-en-gcp-registro-artifact-usando-gcloud-cli">Creando y eliminando repositorios en GCP registro artifact usando gcloud cli</h3>
<pre tabindex="0"><code>gcloud version
gcloud config list
gcloud artifacts repositories create scenery --repository-format=docker --location=us-central1
gcloud artifacts repositories list
gcloud artifacts repositories describe scenery --location=us-central1
gcloud auth configure-docker us-central1-docker.pkg.dev
cat Dockerfile
docker build -t scenery .
docker tag scenery us-central1-docker.pkg.dev/civil-keyword-395016/scenery/scenery:v1
### Pushear al repositorio gcp artifact
docker push scenery us-central1-docker.pkg.dev/civil-keyword-395016/scenery/scenery:v1
### Para chequear
gcloud artifacts repositories describe scenery --location=us-central1
### borramos
gcloud artifacts repositories delete scenery --location=us-central1
gcloud artifacts repositories list
</code></pre><p>Expliqué lo que era artifacs en la publicación de gitlab runner.</p>
<hr>
<h4 id="gcloud-comandos">GCLOUD comandos</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">### list out the regions available for you</span>
</span></span><span style="display:flex;"><span>gcloud compute regions list
</span></span><span style="display:flex;"><span><span style="color:#75715e">### set regions</span>
</span></span><span style="display:flex;"><span>gcloud config set compute/region REGION
</span></span><span style="display:flex;"><span><span style="color:#75715e">### unset the regions</span>
</span></span><span style="display:flex;"><span>gcloud config unset compute/region
</span></span><span style="display:flex;"><span><span style="color:#75715e">### Build Command</span>
</span></span><span style="display:flex;"><span>--zone us-central1-c
</span></span></code></pre></div><h3 id="sistema-operativo">Sistema operativo</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">### select image from list</span>
</span></span><span style="display:flex;"><span>gcloud compute images list
</span></span><span style="display:flex;"><span>Descubrí los valores de los parametros: --image-family --image-project
</span></span></code></pre></div><h3 id="build-command">build command</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>--image-family centos-6 --image-project centros-cloud
</span></span></code></pre></div><h4 id="instance-type">instance type</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute machine-types list
</span></span></code></pre></div><p>Cambia el hardware a tu necesidad</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>--custom-memory 4GiB --custom-cpu 2vCPU
</span></span></code></pre></div><h3 id="build-command-1">build command</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>--machine-type<span style="color:#f92672">=</span>f1-micro / --custom-memory 4GiB --custom-cpu 2vCPU
</span></span></code></pre></div><h2 id="agregar-descripción">agregar descripción</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute instances -h
</span></span><span style="display:flex;"><span>--description<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;testing for the command line&#34;</span>
</span></span></code></pre></div><h3 id="más-opciones">más opciones</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>--no-restart-on-failure by default on
</span></span><span style="display:flex;"><span>--metadata @ add ssh keys <span style="color:#66d9ef">if</span> you want
</span></span><span style="display:flex;"><span>Hay un link a un tutorial de como manejar ssh-key en GCP<span style="color:#f92672">(</span>google cloud platform<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>gcloud compute instance-templates create
</span></span></code></pre></div><h3 id="crear-una-maquina">crear una maquina</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute instances create secops --zone us-central1-c --image-family centos-6 --image-project centos-cloud --machine-type f1-micro --description <span style="color:#e6db74">&#39;testing for the command line&#39;</span>
</span></span></code></pre></div><h3 id="iniciar-y-detener-una-instancia">iniciar y detener una instancia</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute instances stop secops --zone us-central1-c
</span></span><span style="display:flex;"><span>gcloud compute instances start secops --zone us-central1-c
</span></span></code></pre></div><h3 id="borrar-una-instancia">borrar una instancia</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud compute instances delete secops --zone us-central1-c
</span></span></code></pre></div>
</div>


      </div>
    </section>
  </section><script 
src="/quiz/quizdown.js">
</script>
<script 
src="/quiz/quizdownKatex.js">
</script>
<script 
src="/quiz/quizdownHighlight.js">
</script>
<script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
<footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      <a class="" href="https://imlauera.github.io/index.xml" target="_blank">
        <span>
          RSS
        </span>
      </a>
      
      | <a href="https://imlauera.github.io" target="_blank">Andres Imlauer.</a> 

      
      
    </p>
    
  </div>




<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
</footer>


</body>
</html>
