<!DOCTYPE html>
<html lang="es">





<head>
  <meta property="og:url" content="https://imlauera.github.io/post/kimkelen_sistema_de_gestion_escolar/">
  <meta property="og:site_name" content="Imlauer">
  <meta property="og:title" content="Kimkelen: sistema de gestion escolar GRATUITO">
  <meta property="og:description" content="Si estás buscando un sistema de gestión escolar gratis Argentino. Esta es una de las mejores opciones.
https://github.com/desarrollo-cespi/kimkelen
Existen otros sitemas como RosarioSIS, pero aún no la he probado profesionalmente, Kimkelen sí aunque tiene algunos problemas funciona bastante bien.
Funcionalidades que faltan implementar: · Equivalencias.
Como instalarlo y configurarlo: Instalá docker, agregá tu usuario como parte de ese grupo y deslogueate y volvé a ingresar:
sudo pacman -S docker docker-compose sudo systemctl start docker.service sudo usermod -aG docker $USER Seguí este readme: https://github.com/desarrollo-cespi/kimkelen">
  <meta property="og:locale" content="es_es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-06-25T23:45:45-03:00">
    <meta property="article:modified_time" content="2024-06-25T23:45:45-03:00">
    <meta property="article:tag" content="Kimkelen">
    <meta property="article:tag" content="Sistema">
    <meta property="article:tag" content="Escolar">
    <meta property="article:tag" content="Gratis">

  
  <meta itemprop="name" content="Kimkelen: sistema de gestion escolar GRATUITO">
  <meta itemprop="description" content="Si estás buscando un sistema de gestión escolar gratis Argentino. Esta es una de las mejores opciones.
https://github.com/desarrollo-cespi/kimkelen
Existen otros sitemas como RosarioSIS, pero aún no la he probado profesionalmente, Kimkelen sí aunque tiene algunos problemas funciona bastante bien.
Funcionalidades que faltan implementar: · Equivalencias.
Como instalarlo y configurarlo: Instalá docker, agregá tu usuario como parte de ese grupo y deslogueate y volvé a ingresar:
sudo pacman -S docker docker-compose sudo systemctl start docker.service sudo usermod -aG docker $USER Seguí este readme: https://github.com/desarrollo-cespi/kimkelen">
  <meta itemprop="datePublished" content="2024-06-25T23:45:45-03:00">
  <meta itemprop="dateModified" content="2024-06-25T23:45:45-03:00">
  <meta itemprop="wordCount" content="3500">
  <meta itemprop="keywords" content="Kimkelen,Sistema,Escolar,Gratis">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Kimkelen: sistema de gestion escolar GRATUITO">
  <meta name="twitter:description" content="Si estás buscando un sistema de gestión escolar gratis Argentino. Esta es una de las mejores opciones.
https://github.com/desarrollo-cespi/kimkelen
Existen otros sitemas como RosarioSIS, pero aún no la he probado profesionalmente, Kimkelen sí aunque tiene algunos problemas funciona bastante bien.
Funcionalidades que faltan implementar: · Equivalencias.
Como instalarlo y configurarlo: Instalá docker, agregá tu usuario como parte de ese grupo y deslogueate y volvé a ingresar:
sudo pacman -S docker docker-compose sudo systemctl start docker.service sudo usermod -aG docker $USER Seguí este readme: https://github.com/desarrollo-cespi/kimkelen">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Kimkelen: sistema de gestion escolar GRATUITO
    
  </title>
  <link rel="stylesheet" href='https://imlauera.github.io/css/site.min.css'>
  <link rel="canonical" href="https://imlauera.github.io/post/kimkelen_sistema_de_gestion_escolar/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://imlauera.github.io/index.xml" title="Imlauer">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <meta name="author" content="Imlauer.">
  <meta name="description" content="Si estás buscando un sistema de gestión escolar gratis Argentino. Esta es una de las mejores opciones.
https://github.com/desarrollo-cespi/kimkelen
Existen otros sitemas como RosarioSIS, pero aún no la he probado profesionalmente, Kimkelen sí aunque tiene algunos problemas funciona bastante bien.
Funcionalidades que faltan implementar:
· Equivalencias.

Como instalarlo y configurarlo:
Instalá docker, agregá tu usuario como parte de ese grupo y deslogueate y volvé a ingresar:
sudo pacman -S docker docker-compose
sudo systemctl start docker.service
sudo usermod -aG docker $USER
Seguí este readme: https://github.com/desarrollo-cespi/kimkelen">
</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://imlauera.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="/img/memememe.jpg">
      </figure>
    </a>
    <a class="navbar-item" href="https://imlauera.github.io/">
      Imlauer
    </a>
    <a class="navbar-item" href="/acerca/">
      Acerca de Mi
    </a>
  </div>
  
  
</nav>

  <section>
    <section class='hero is-small is-link is-fullwidth'>
      <div class="hero-body">
<div class="container">
  <h1 class="title">
    Kimkelen: sistema de gestion escolar GRATUITO
  </h1>
  <h2 class="subtitle">
    <time datetime='2024-06-25T23:45:45-03:00'>
      June 25, 2024
    </time>
    
    <br>
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/kimkelen/">Kimkelen</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/sistema/">Sistema</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/escolar/">Escolar</a>
    
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/gratis/">Gratis</a>
    
    
    
  </h2>
</div>

      </div>
    </section>
    <section class="section">
      <div class="container">
<div class="content is-medium">
  <p>Si estás buscando un sistema de gestión escolar gratis Argentino. Esta es una de las mejores opciones.</p>
<p><a href="https://github.com/desarrollo-cespi/kimkelen">https://github.com/desarrollo-cespi/kimkelen</a></p>
<p>Existen otros sitemas como RosarioSIS, pero aún no la he probado profesionalmente, Kimkelen sí aunque tiene algunos problemas funciona bastante bien.</p>
<p>Funcionalidades que faltan implementar:
· Equivalencias.</p>
<hr>
<h3 id="como-instalarlo-y-configurarlo">Como instalarlo y configurarlo:</h3>
<p>Instalá docker, agregá tu usuario como parte de ese grupo y deslogueate y volvé a ingresar:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo pacman -S docker docker-compose
</span></span><span style="display:flex;"><span>sudo systemctl start docker.service
</span></span><span style="display:flex;"><span>sudo usermod -aG docker $USER
</span></span></code></pre></div><p>Seguí este readme: <a href="https://github.com/desarrollo-cespi/kimkelen">https://github.com/desarrollo-cespi/kimkelen</a></p>
<h4 id="el-docker-composeyml-que-está-en-su-readme-está-mal-escrito">el docker-compose.yml que está en su readme está mal escrito</h4>
<p>Es ideal quitar el puerto 80 acá por cuestiones de seguridad.
Acá <strong>monté un volumen llamado cloudflare</strong>. Los volumenes son directorios(carpetas) compartidas entre docker y el host(tu PC), en este caso lo usé para compartir los archivos de configuración del ssl.</p>
<h3 id="usá-este">Usá este.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#39;2&#39;</span>
</span></span><span style="display:flex;"><span>volumes:
</span></span><span style="display:flex;"><span>  db:
</span></span><span style="display:flex;"><span>  disciplinary-sanction-documents:
</span></span><span style="display:flex;"><span>  justification-documents:
</span></span><span style="display:flex;"><span>  persons-photos:
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>  app:
</span></span><span style="display:flex;"><span>    restart: always
</span></span><span style="display:flex;"><span>    image: registry.gitlab.com/kimkelen/kimkelen:latest
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#image: my-web-app</span>
</span></span><span style="display:flex;"><span>    environment:
</span></span><span style="display:flex;"><span>      DB_HOST: db
</span></span><span style="display:flex;"><span>      DB_NAME: kimkelen
</span></span><span style="display:flex;"><span>      DB_USERNAME: root
</span></span><span style="display:flex;"><span>      DB_ENCODING: utf8
</span></span><span style="display:flex;"><span>      DB_PASSWORD: root
</span></span><span style="display:flex;"><span>      DB_PORT: <span style="color:#ae81ff">3306</span>
</span></span><span style="display:flex;"><span>      DEBUG: <span style="color:#e6db74">&#39;false&#39;</span>
</span></span><span style="display:flex;"><span>      FLAVOR: elflavordetuescuela
</span></span><span style="display:flex;"><span>      MEMCACHE_HOST: memcache
</span></span><span style="display:flex;"><span>      MEMCACHE_PORT: <span style="color:#e6db74">&#39;11211&#39;</span>
</span></span><span style="display:flex;"><span>      TESTING: <span style="color:#e6db74">&#39;false&#39;</span>
</span></span><span style="display:flex;"><span>      MAIL_PORT: <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>      MAIL_HOST: localhost
</span></span><span style="display:flex;"><span>      FACEBOOK_ID: <span style="color:#e6db74">&#39;demo&#39;</span>
</span></span><span style="display:flex;"><span>      FACEBOOK_SECRET: <span style="color:#e6db74">&#39;demo&#39;</span>
</span></span><span style="display:flex;"><span>    ports:
</span></span><span style="display:flex;"><span>    - 80:80
</span></span><span style="display:flex;"><span>    - 443:443
</span></span><span style="display:flex;"><span>    volumes:
</span></span><span style="display:flex;"><span>    - disciplinary-sanction-documents:/app/data/disciplinary-sanction-documents
</span></span><span style="display:flex;"><span>    - justification-documents:/app/data/justification-documents
</span></span><span style="display:flex;"><span>    - persons-photos:/app/data/persons-photos
</span></span><span style="display:flex;"><span>    - ./cloudflare:/etc/cloudflare/
</span></span><span style="display:flex;"><span>  memcache:
</span></span><span style="display:flex;"><span>    restart: always
</span></span><span style="display:flex;"><span>    image: memcached:1.4
</span></span><span style="display:flex;"><span>    command:
</span></span><span style="display:flex;"><span>    - -m
</span></span><span style="display:flex;"><span>    - <span style="color:#e6db74">&#39;256&#39;</span>
</span></span><span style="display:flex;"><span>  db:
</span></span><span style="display:flex;"><span>    restart: always
</span></span><span style="display:flex;"><span>    image: hsheth2/mysql-low-memory:5.6
</span></span><span style="display:flex;"><span>    environment:
</span></span><span style="display:flex;"><span>      MYSQL_DATABASE: kimkelen
</span></span><span style="display:flex;"><span>      MYSQL_ROOT_PASSWORD: root
</span></span><span style="display:flex;"><span>    volumes:
</span></span><span style="display:flex;"><span>    - db:/var/lib/mysql
</span></span></code></pre></div><p>Lo levantás con <code>docker-compose up</code> o <code>docker compose up</code></p>
<h4 id="para-poder-reconstruir-la-imágen-cada-vez-que-hacemos-un-cambio-del-repositorio-kimkelen-tenemos-que-cambiar-el-from-del-dockerdockerfile-porque-está-mal">Para poder reconstruir la imágen cada vez que hacemos un cambio del repositorio kimkelen tenemos que cambiar el FROM del <code>docker/Dockerfile</code> porque está mal:</h4>
<p>Cambia el from por:</p>
<pre tabindex="0"><code>FROM registry.gitlab.com/kimkelen/kimkelen:base-latest
</code></pre><hr>
<h4 id="creá-un-flavorsabor-copiando-el-flavor-de-otra-carpeta-y-cambiando-los-logos-esto-esta-explicado-mejor-en-un-archivo-que-tengo-aparte">Creá un flavor(sabor) copiando el flavor de otra carpeta y cambiando los logos, esto esta explicado mejor en un archivo que tengo aparte.</h4>
<p><strong>Como crear un nuevo sabor:</strong></p>
<p>Tenes que copiar algun otro sabor ya existente y ingresar a la carpeta del sabor lib y ahi cambiar todos los nombres del antiguo sabor al nuevo.</p>
<p>Por ejemplo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp -R agropecuaria nombredemiescuela  
</span></span><span style="display:flex;"><span>cd nombredemiescuela/lib/behavior
</span></span></code></pre></div><p>Ahora si te copiaste el flavor de Anexa los archivos se llamaran por ejemplo <code>AnexaEvaluatorBehaviour.class.php</code>. Tenes que reemplazar Anexa por el nuevo nombre del sabor por ejemplo <code>nombredemiescuela</code>, esto se hace con el siguiente comando:
Reemplazar el nombre de los archivos:</p>
<pre tabindex="0"><code>for i in *; do mv &#34;$i&#34; &#34;`echo $i | sed &#34;s/Agropecuaria/Nombredemiescuela/&#34;`&#34;; done
</code></pre><p><strong>Movete a los subdirectorios y ejecutá ese mismo comando</strong>: Es decir</p>
<pre tabindex="0"><code>cd factory
for i in *; do mv &#34;$i&#34; &#34;`echo $i | sed &#34;s/Agropecuaria/Nombredemiescuela/&#34;`&#34;; done
cd ..
cd filter
for i in *; do mv &#34;$i&#34; &#34;`echo $i | sed &#34;s/Agropecuaria/Nombredemiescuela/&#34;`&#34;; done
etc
</code></pre><p>Se puede usar <code>find</code> para que recorra todos los subdirectorios en vez de moverte.<br>
Por ejemplo:</p>
<pre tabindex="0"><code>for i in $(find . -type f -print); do mv &#34;$i&#34; &#34;`echo $i | sed &#34;s/Agropecuaria/Nombredemiescuela/&#34;`&#34;;  done
</code></pre><p><strong>(No lo probé)</strong></p>
<hr>
<p>Luego tenes que reemplazar el nombre de la clase adentro de cada archivo , con el siguiente comando, dentro de la misma carpeta:</p>
<pre tabindex="0"><code>find ./ -type f -exec sed -i -e &#39;s/Agropecuaria/Nombredemiescuela/g&#39; {} \;
</code></pre><p>Y listo, ahora podemos cambiar cosas como el logo del boletin etc.</p>
<p>Para cambiar el logo podemos ir a <code>flavors/nombredemiescuela/web/images/</code> y buscar y reemplazar por cada logo de otra escuela por el nuestro.</p>
<p>Cambiá todas las ocurrencias del nombre de la escuela vieja, usando <code>grep</code> situado en flavors en que archivos aparece y reemplazalos: <code>grep -i agropecuaria -r *</code></p>
<p>Por ejemplo acá hay un archivo: <code>flavors/nombredemiescuela/modules/examination_subject/templates/printStudentsSuccess.php</code> que tiene un nombre de colegio.</p>
<p>Otro: <code>flavors/nombredemiescuela/lib/behaviour/NombredemiescuelaSchoolBehaviour.class.php</code></p>
<hr>
<h3 id="creá-un-archivo-de-configuración-extra-hice-esto-porque-no-te-deja-pisar-la-configuración-de-apache-hay-una-forma-pero-yo-lo-hice-así">Creá un archivo de configuración extra, hice esto porque no te deja pisar la configuración de apache hay una forma pero yo lo hice así:</h3>
<p><code>cp config/extra.conf /etc/apache2/conf.d/extra.conf</code> (esto lo puse en el entrypoint para que copie cada vez que recompilo la imágen que no era necesario porque lo agregué también al Dockerfile)</p>
<pre tabindex="0"><code>ServerName miescuelanombre.edu.ar

&lt;LocationMatch /uploads/.*&gt;
     php_flag engine off
&lt;/LocationMatch&gt;

&lt;Directory /app/web &gt;
      RewriteEngine On
      # uncomment the following line, if you are having trouble
      # getting no_script_name to work
      #RewriteBase /

      # we skip all files with .something
      #RewriteCond %{REQUEST_URI} \..+$
      #RewriteCond %{REQUEST_URI} !\.html$
      #RewriteRule .* - [L]

      # we check if the .html version is here (caching)
      RewriteRule ^$ index.html [QSA]
      RewriteRule ^([^.]+)$ $1.html [QSA]
      RewriteCond %{REQUEST_FILENAME} !-f

      # no, so we redirect to our front web controller
      RewriteRule ^(.*)$ index.php [QSA,L]
&lt;/Directory&gt;

&lt;VirtualHost *:80&gt;
  DocumentRoot &#34;/app/web/&#34;
  ServerAdmin admin@miescuelanombre.edu.ar
  &lt;Directory &#34;/app/web&#34;&gt;
      Options -Indexes +FollowSymLinks -MultiViews
      AllowOverride None
      Order allow,deny
      allow from all
  &lt;/Directory&gt;
  #Redirect permanent / https://miescuelanombre.edu.ar
&lt;/VirtualHost&gt;
</code></pre><p>Es recomendable redirigir todo el trafico del puerto 80 a https(443) para comentá todo dentro VirtualHost menos la directiva Redirect.</p>
<h4 id="borrá-webhtaccess">Borrá web/.htaccess</h4>
<h5 id="dockerentrypoint">docker/entrypoint</h5>
<pre tabindex="0"><code>#!/bin/sh
 set -eo pipefail

source /usr/local/bin/setenvdefaults

echo -e &#34;expose_php = Off\n&#34;\
	&#34;date.timezone = $TIMEZONE\n&#34;\
        &#34;memory_limit = $MEMORY_LIMIT\n&#34;\
        &#34;max_execution_time = $MAX_EXECUTION_TIME\n&#34; &gt; /usr/local/etc/php/conf.d/php.ini

envsubst &#39;${DB_NAME} ${DB_HOST} ${DB_USERNAME} ${DB_PASSWORD}&#39; &lt; /app/config/propel.ini.docker &gt; /app/config/propel.ini

cp config/extra.conf /etc/apache2/conf.d/extra.conf
#cp config/ssl.conf /etc/apache2/conf.d/ssl.conf
#cp config/apache2-foreground /usr/local/bin/apache2-foreground

echo &#39;SetEnvIf Request_URI &#34;^/robots.txt$&#34; dontlog&#39; &gt; /etc/apache2/conf.d/docker.conf
echo &#39;CustomLog logs/access.log combined env=!dontlog&#39; &gt;&gt; /etc/apache2/conf.d/docker.conf 
echo &#39;ServerTokens Prod&#39; &gt;&gt; /etc/apache2/conf.d/docker.conf 
echo &#39;ServerSignature Off&#39; &gt;&gt; /etc/apache2/conf.d/docker.conf 
echo &#39;TraceEnable Off&#39; &gt;&gt; /etc/apache2/conf.d/docker.conf 



CMD=&#39;cd /app &amp;&amp; rm -fr cache/* &amp;&amp; ./symfony propel:build-all --classes-only &amp;&amp; ./symfony plugin:publish &amp;&amp; ./symfony fix-perms &amp;&amp; ./symfony kimkelen:flavor $FLAVOR&#39;

if [ -z &#34;$APACHE_RUN_USER&#34; ]; then
  sh -c &#34;$CMD&#34;
else
  su $APACHE_RUN_USER -c &#34;$CMD&#34;
fi

exec /usr/local/bin/original-docker-php-entrypoint &#34;$@&#34;
</code></pre><hr>
<h4 id="importante">Importante</h4>
<p><strong>Tenés que arreglar los permisos a apache a las carpetas, esto lo hice modificando el <code>Dockerfile</code>, y tenés que instalar <code>apache2-ssl</code> para que funcione el ssl.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>FROM registry.gitlab.com/kimkelen/kimkelen:base-latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RUN mv /usr/local/bin/docker-php-entrypoint /usr/local/bin/original-docker-php-entrypoint
</span></span><span style="display:flex;"><span>ADD docker/entrypoint /usr/local/bin/docker-php-entrypoint
</span></span><span style="display:flex;"><span>ADD docker/setenvdefaults /usr/local/bin/setenvdefaults
</span></span><span style="display:flex;"><span>ADD . /app
</span></span><span style="display:flex;"><span>RUN rm /app/web/*_dev.php
</span></span><span style="display:flex;"><span>ENV APACHE_DOCUMENT_ROOT<span style="color:#f92672">=</span>/app/web/ <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    DB_ENCODING<span style="color:#f92672">=</span>utf8
</span></span><span style="display:flex;"><span>ARG REVISION
</span></span><span style="display:flex;"><span>ENV VERSION<span style="color:#f92672">=</span>$REVISION
</span></span><span style="display:flex;"><span>WORKDIR /app
</span></span><span style="display:flex;"><span>RUN chown -R apache /app/data
</span></span><span style="display:flex;"><span>COPY config/extra.conf /etc/apache2/conf.d/extra.conf
</span></span><span style="display:flex;"><span>RUN apk add -U --no-cache apache2-ssl
</span></span><span style="display:flex;"><span>COPY config/ssl.conf /etc/apache2/conf.d/ssl.conf
</span></span></code></pre></div><h4 id="configsslconf">config/ssl.conf</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is the Apache server configuration file providing SSL support.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># It contains the configuration directives to instruct the server how to</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># serve pages over an https connection. For detailed information about these </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># directives see &lt;URL:http://httpd.apache.org/docs/2.4/mod/mod_ssl.html&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Do NOT simply read the instructions in here without understanding</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># what they do.  They&#39;re here only as hints or reminders.  If you are unsure</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># consult the online docs. You have been warned.  </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Required modules: mod_log_config, mod_setenvif, mod_ssl,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#          socache_shmcb_module (for default value of SSLSessionCache)</span>
</span></span><span style="display:flex;"><span>LoadModule ssl_module modules/mod_ssl.so
</span></span><span style="display:flex;"><span>LoadModule socache_shmcb_module modules/mod_socache_shmcb.so
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Pseudo Random Number Generator (PRNG):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Configure one or more sources to seed the PRNG of the SSL library.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The seed data should be of good random quality.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># WARNING! On some platforms /dev/random blocks if not enough entropy</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># is available. This means you then cannot use the /dev/random device</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># because it would lead to very long connection times (as long as</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># it requires to make more entropy available). But usually those</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># platforms additionally provide a /dev/urandom device which doesn&#39;t</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># block. So, if available, use this one instead. Read the mod_ssl User</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Manual for more details.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLRandomSeed startup file:/dev/random  512</span>
</span></span><span style="display:flex;"><span>SSLRandomSeed startup file:/dev/urandom <span style="color:#ae81ff">512</span>
</span></span><span style="display:flex;"><span>SSLRandomSeed connect builtin
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLRandomSeed connect file:/dev/random  512</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLRandomSeed connect file:/dev/urandom 512</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># When we also provide SSL we have to listen to the </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># standard HTTP port (see above) and to the HTTPS port</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span>Listen <span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  SSL Global Context</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  All SSL configuration in this context applies both to</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  the main server and all SSL-enabled virtual hosts.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   SSL Cipher Suite:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   List the ciphers that the client is permitted to negotiate,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   and that httpd will negotiate as the client of a proxied server.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   See the OpenSSL documentation for a complete list of ciphers, and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   ensure these follow appropriate best practices for this deployment.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   httpd 2.2.30, 2.4.13 and later force-disable aNULL, eNULL and EXP ciphers,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   while OpenSSL disabled these by default in 0.9.8zf/1.0.0r/1.0.1m/1.0.2a.</span>
</span></span><span style="display:flex;"><span>SSLCipherSuite HIGH:MEDIUM:!MD5:!RC4:!3DES:!ADH
</span></span><span style="display:flex;"><span>SSLProxyCipherSuite HIGH:MEDIUM:!MD5:!RC4:!3DES:!ADH
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  By the end of 2016, only TLSv1.2 ciphers should remain in use.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  Older ciphers should be disallowed as soon as possible, while the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  kRSA ciphers do not offer forward secrecy.  These changes inhibit</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  older clients (such as IE6 SP2 or IE8 on Windows XP, or other legacy</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  non-browser tooling) from successfully connecting.  </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  To restrict mod_ssl to use only TLSv1.2 ciphers, and disable</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  those protocols which do not support forward secrecy, replace</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  the SSLCipherSuite and SSLProxyCipherSuite directives above with</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  the following two directives, as soon as practical.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SSLCipherSuite HIGH:MEDIUM:!SSLv3:!kRSA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SSLProxyCipherSuite HIGH:MEDIUM:!SSLv3:!kRSA</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   User agents such as web browsers are not configured for the user&#39;s</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   own preference of either security or performance, therefore this</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   must be the prerogative of the web server administrator who manages</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   cpu load versus confidentiality, so enforce the server&#39;s cipher order.</span>
</span></span><span style="display:flex;"><span>SSLHonorCipherOrder on 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   SSL Protocol support:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   List the protocol versions which clients are allowed to connect with.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Disable SSLv3 by default (cf. RFC 7525 3.1.1).  TLSv1 (1.0) should be</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   disabled as quickly as practical.  By the end of 2016, only the TLSv1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   protocol or later should remain in use.</span>
</span></span><span style="display:flex;"><span>SSLProtocol all -SSLv3
</span></span><span style="display:flex;"><span>SSLProxyProtocol all -SSLv3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Pass Phrase Dialog:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Configure the pass phrase gathering process.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   The filtering dialog program (`builtin&#39; is an internal</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   terminal dialog) has to provide the pass phrase on stdout.</span>
</span></span><span style="display:flex;"><span>SSLPassPhraseDialog  builtin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Inter-Process Session Cache:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Configure the SSL Session Cache: First the mechanism </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   to use and second the expiring timeout (in seconds).</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLSessionCache         &#34;dbm:/run/apache2/ssl_scache&#34;</span>
</span></span><span style="display:flex;"><span>SSLSessionCache        <span style="color:#e6db74">&#34;shmcb:/var/cache/mod_ssl/scache(512000)&#34;</span>
</span></span><span style="display:flex;"><span>SSLSessionCacheTimeout  <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   OCSP Stapling (requires OpenSSL 0.9.8h or later)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   This feature is disabled by default and requires at least</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   the two directives SSLUseStapling and SSLStaplingCache.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Refer to the documentation on OCSP Stapling in the SSL/TLS</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   How-To for more information.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Enable stapling for all SSL-enabled servers:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLUseStapling On</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Define a relatively small cache for OCSP Stapling using</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   the same mechanism that is used for the SSL session cache</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   above.  If stapling is used with more than a few certificates,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   the size may need to be increased.  (AH01929 will be logged.)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLStaplingCache &#34;shmcb:/run/apache2/ssl_stapling(32768)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Seconds before valid OCSP responses are expired from the cache</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLStaplingStandardCacheTimeout 3600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Seconds before invalid OCSP responses are expired from the cache</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLStaplingErrorCacheTimeout 600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## SSL Virtual Host Context</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;VirtualHost _default_:443&gt;
</span></span><span style="display:flex;"><span>DocumentRoot <span style="color:#e6db74">&#34;/app/web/&#34;</span>
</span></span><span style="display:flex;"><span>ServerAdmin admin@miescuelanombre.edu.ar
</span></span><span style="display:flex;"><span>ServerAlias www.miescuelanombre.edu.ar:443
</span></span><span style="display:flex;"><span>&lt;Directory <span style="color:#e6db74">&#34;/app/web&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    Options -Indexes +FollowSymLinks -MultiViews
</span></span><span style="display:flex;"><span>    AllowOverride None
</span></span><span style="display:flex;"><span>    Order allow,deny
</span></span><span style="display:flex;"><span>    allow from all
</span></span><span style="display:flex;"><span>&lt;/Directory&gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#DocumentRoot &#34;/var/www/localhost/htdocs&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ServerName www.example.com:443</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ServerAlias www.miescuelanombre.edu.ar:443</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ServerAdmin you@example.com</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ErrorLog logs/ssl_error.log</span>
</span></span><span style="display:flex;"><span>ErrorLog logs/error.log
</span></span><span style="display:flex;"><span>TransferLog logs/access.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   SSL Engine Switch:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Enable/Disable SSL for this virtual host.</span>
</span></span><span style="display:flex;"><span>SSLEngine on
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Server Certificate:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Point SSLCertificateFile at a PEM encoded certificate.  If</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   the certificate is encrypted, then you will be prompted for a</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   pass phrase.  Note that a kill -HUP will prompt again.  Keep</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   in mind that if you have both an RSA and a DSA certificate you</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   can configure both in parallel (to also allow the use of DSA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   ciphers, etc.)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Some ECC cipher suites (http://www.ietf.org/rfc/rfc4492.txt)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   require an ECC certificate which can also be configured in</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   parallel.</span>
</span></span><span style="display:flex;"><span>SSLCertificateFile /etc/cloudflare/server.pem
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCertificateFile /etc/ssl/apache2/server-dsa.pem</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCertificateFile /etc/ssl/apache2/server-ecc.pem</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Server Private Key:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   If the key is not combined with the certificate, use this</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   directive to point at the key file.  Keep in mind that if</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   you&#39;ve both a RSA and a DSA private key you can configure</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   both in parallel (to also allow the use of DSA ciphers, etc.)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   ECC keys, when in use, can also be configured in parallel</span>
</span></span><span style="display:flex;"><span>SSLCertificateKeyFile /etc/cloudflare/server.key
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCertificateKeyFile /etc/ssl/apache2/server-dsa.key</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCertificateKeyFile /etc/ssl/apache2/server-ecc.key</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Server Certificate Chain:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Point SSLCertificateChainFile at a file containing the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   concatenation of PEM encoded CA certificates which form the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   certificate chain for the server certificate. Alternatively</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   the referenced file can be the same as SSLCertificateFile</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   when the CA certificates are directly appended to the server</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   certificate for convenience.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCertificateChainFile /etc/ssl/apache2/server-ca.pem</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Certificate Authority (CA):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Set the CA certificate verification path where to find CA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   certificates for client authentication or alternatively one</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   huge file containing all of them (file must be PEM encoded)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Note: Inside SSLCACertificatePath you need hash symlinks</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         to point to the certificate files. Use the provided</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         Makefile to update the hash symlinks after changes.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCACertificatePath /etc/ssl/apache2/ssl.crt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCACertificateFile /etc/ssl/apache2/ssl.crt/ca-bundle.pem</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Certificate Revocation Lists (CRL):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Set the CA revocation path where to find CA CRLs for client</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   authentication or alternatively one huge file containing all</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   of them (file must be PEM encoded).</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   The CRL checking mode needs to be configured explicitly</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   through SSLCARevocationCheck (defaults to &#34;none&#34; otherwise).</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Note: Inside SSLCARevocationPath you need hash symlinks</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         to point to the certificate files. Use the provided</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         Makefile to update the hash symlinks after changes.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCARevocationPath /etc/ssl/apache2/ssl.crl</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCARevocationFile /etc/ssl/apache2/ssl.crl/ca-bundle.crl</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLCARevocationCheck chain</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Client Authentication (Type):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Client certificate verification type and depth.  Types are</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   none, optional, require and optional_no_ca.  Depth is a</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   number which specifies how deeply to verify the certificate</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   issuer chain before deciding the certificate is not valid.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLVerifyClient require</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLVerifyDepth  10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   TLS-SRP mutual authentication:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Enable TLS-SRP and set the path to the OpenSSL SRP verifier</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   file (containing login information for SRP user accounts). </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Requires OpenSSL 1.0.1 or newer. See the mod_ssl FAQ for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   detailed instructions on creating this file. Example:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   &#34;openssl srp -srpvfile /etc/apache2/passwd.srpv -add username&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLSRPVerifierFile &#34;/etc/apache2/passwd.srpv&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Access Control:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   With SSLRequire you can do per-directory access control based</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   on arbitrary complex boolean expressions containing server</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   variable checks and other lookup directives.  The syntax is a</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   mixture between C and Perl.  See the mod_ssl documentation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   for more details.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&lt;Location /&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLRequire (    %{SSL_CIPHER} !~ m/^(EXP|NULL)/ \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#            and %{SSL_CLIENT_S_DN_O} eq &#34;Snake Oil, Ltd.&#34; \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#            and %{SSL_CLIENT_S_DN_OU} in {&#34;Staff&#34;, &#34;CA&#34;, &#34;Dev&#34;} \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#            and %{TIME_WDAY} &gt;= 1 and %{TIME_WDAY} &lt;= 5 \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#            and %{TIME_HOUR} &gt;= 8 and %{TIME_HOUR} &lt;= 20       ) \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#           or %{REMOTE_ADDR} =~ m/^192\.76\.162\.[0-9]+$/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&lt;/Location&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   SSL Engine Options:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Set various options for the SSL engine.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   o FakeBasicAuth:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     Translate the client X.509 into a Basic Authorisation.  This means that</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     the standard Auth/DBMAuth methods can be used for access control.  The</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     user name is the `one line&#39; version of the client&#39;s X.509 certificate.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     Note that no password is obtained from the user. Every entry in the user</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     file needs this password: `xxj31ZMTZzkVA&#39;.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   o ExportCertData:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     This exports two additional environment variables: SSL_CLIENT_CERT and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     SSL_SERVER_CERT. These contain the PEM-encoded certificates of the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     server (always existing) and the client (only existing when client</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     authentication is used). This can be used to import the certificates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     into CGI scripts.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   o StdEnvVars:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     This exports the standard SSL/TLS related `SSL_*&#39; environment variables.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     Per default this exportation is switched off for performance reasons,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     because the extraction step is an expensive operation and is usually</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     useless for serving static content. So one usually enables the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     exportation for CGI and SSI requests only.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   o StrictRequire:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     This denies access when &#34;SSLRequireSSL&#34; or &#34;SSLRequire&#34; applied even</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     under a &#34;Satisfy any&#34; situation, i.e. when it applies access is denied</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     and no other module can change it.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   o OptRenegotiate:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     This enables optimized SSL connection renegotiation handling when SSL</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     directives are used in per-directory context. </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#SSLOptions +FakeBasicAuth +ExportCertData +StrictRequire</span>
</span></span><span style="display:flex;"><span>&lt;FilesMatch <span style="color:#e6db74">&#34;\.(cgi|shtml|phtml|php)</span>$<span style="color:#e6db74">&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    SSLOptions +StdEnvVars
</span></span><span style="display:flex;"><span>&lt;/FilesMatch&gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&lt;Directory &#34;/var/www/localhost/cgi-bin&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#    SSLOptions +StdEnvVars</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&lt;/Directory&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   SSL Protocol Adjustments:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   The safe and default but still SSL/TLS standard compliant shutdown</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   approach is that mod_ssl sends the close notify alert but doesn&#39;t wait for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   the close notify alert from client. When you need a different shutdown</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   approach you can use one of the following variables:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   o ssl-unclean-shutdown:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     This forces an unclean shutdown when the connection is closed, i.e. no</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     SSL close notify alert is sent or allowed to be received.  This violates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     the SSL/TLS standard but is needed for some brain-dead browsers. Use</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     this when you receive I/O errors because of the standard approach where</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     mod_ssl sends the close notify alert.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   o ssl-accurate-shutdown:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     This forces an accurate shutdown when the connection is closed, i.e. a</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     SSL close notify alert is send and mod_ssl waits for the close notify</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     alert of the client. This is 100% SSL/TLS standard compliant, but in</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     practice often causes hanging connections with brain-dead browsers. Use</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     this only for browsers where you know that their SSL implementation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     works correctly. </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Notice: Most problems of broken clients are also related to the HTTP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   keep-alive facility, so you usually additionally want to disable</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   keep-alive for those clients, too. Use variable &#34;nokeepalive&#34; for this.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Similarly, one has to force some clients to use HTTP/1.0 to workaround</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   their broken HTTP/1.1 implementation. Use variables &#34;downgrade-1.0&#34; and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   &#34;force-response-1.0&#34; for this.</span>
</span></span><span style="display:flex;"><span>BrowserMatch <span style="color:#e6db74">&#34;MSIE [2-5]&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>         nokeepalive ssl-unclean-shutdown <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>         downgrade-1.0 force-response-1.0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Per-Server Logging:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   The home of a custom SSL log file. Use this when you want a</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   compact non-error SSL logfile on a virtual host basis.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#CustomLog logs/ssl_request.log \</span>
</span></span><span style="display:flex;"><span>CustomLog logs/access.log <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>          <span style="color:#e6db74">&#34;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&#34;%r\&#34; %b&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;                                  
</span></span></code></pre></div><p>Todos los archivos por defecto toman la configuración de los archivos que están en /lib/ salvo que estén presentes en el flavor si el mismo nombre de archivo está presente en el flavor pisa el archivo por defecto que está en /lib/.</p>
<p>Podés cambiar por ejemplo:
<code>flavors/miescuelanombre/lib/behavior/MiescuelanombreEvaluatorBehaviour.class.php</code></p>
<pre tabindex="0"><code>    self::DECEMBER =&gt; &#39;Diciembre&#39;,
    self::FEBRUARY =&gt; &#39;Febrero&#39;,
</code></pre><p>Lo cambiamos por</p>
<pre tabindex="0"><code>    self::DECEMBER =&gt; &#39;PEEE-dic&#39;,
    self::FEBRUARY =&gt; &#39;PEEE-feb&#39;,
</code></pre><p>Después tenés que cambiar los mensajes en por ejemplo <code>flavors/miescuelanombre/i18n/messages.es.xml</code>
<code>La Plata</code> cambialo por la ciudad de tu colegio.</p>
<p><code>flavors/miescuelanombre/config/view.yml</code>:</p>
<pre tabindex="0"><code>title:         Liceo Víctor Mercante - UNLP
description:   Liceo Víctor Mercante - UNLP
keywords:      liceo, victor, mercante, unlp
</code></pre><p><strong>Cambiala por el nombre de tu colegio.</strong></p>
<p>Cambiá también el nombre de la otra escuela en todos los documentos: <code>flavors/minombreescuela/modules/student/templates/_analytical_header_text.php</code> y <code>flavors/minombreescuela/modules/student/templates/_certificate_regular_text.php</code> <code>flavors/minombreescuela/modules/student/templates/_analytical_footer_signatures.php</code> y en todas las demás ocurrencias buscalas con <code>grep -i agropecuaria -r *</code> y editá los nombres del director del colegio y de la vice. Cambiá todos los logos.</p>
<pre tabindex="0"><code>flavors/miescuelanombre/modules/student/templates/_analytical_header.php
</code></pre><hr>
<h1 id="algunos-problemas-en-el-código">Algunos problemas en el código</h1>
<h4 id="hay-que-aplicar-parches-para-que-los-preceptores-puedan-imprimir-el-boletín">Hay que aplicar parches para que los preceptores puedan imprimir el boletín.</h4>
<p>El nombre del parche no recuerdo pero si te ubicás en <code>patch</code> y ejecutás <code>grep &quot;preceptores&quot; -r *</code>.</p>
<h4 id="que-se-puedan-agregar-notas-con-decimal-libformcoursesubjectmarksformclassphp">Que se puedan agregar notas con decimal: <code>lib/form/CourseSubjectMarksForm.class.php</code>:</h4>
<p>Cambiá <code>sfValidatorInteger</code> por <code>sfValidatorNumber</code></p>
<h4 id="cierre-de-ciclo-tenés-que-hacerlo-cada-año-o-poner-una-variable">Cierre de ciclo (tenés que hacerlo cada año o poner una variable):</h4>
<p>Tenés que cambiar esta variable en <code>lib/model/SchoolYear.php</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>    $lastYear <span style="color:#f92672">=</span> (<span style="color:#a6e22e">int</span>)<span style="color:#ae81ff">2023</span>;
</span></span></code></pre></div><p>Por</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>    $lastYear <span style="color:#f92672">=</span> (<span style="color:#a6e22e">int</span>)(<span style="color:#a6e22e">date</span>(<span style="color:#e6db74">&#39;Y&#39;</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span></code></pre></div><p>Cambia en <code>lib/model/SchoolYear.php</code> y <code>lib/school_behaviour/base/BaseAnalyticalBehaviour.class.php</code> busca con <code>grep 2021 -r *</code> diferentes años y cambia <code>lastYear</code> y un array.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">count</span>(<span style="color:#a6e22e">ExaminationPeer</span><span style="color:#f92672">::</span><span style="color:#a6e22e">retrieveForSchoolYearAndExaminationNumber</span>($this, <span style="color:#a6e22e">SchoolBehaviourFactory</span><span style="color:#f92672">::</span><span style="color:#a6e22e">getEvaluatorInstance</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getFebruaryExaminationNumber</span>())) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">year</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2022</span>)
</span></span></code></pre></div><p>Por</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>    $lastYear <span style="color:#f92672">=</span> (<span style="color:#a6e22e">int</span>)(<span style="color:#a6e22e">date</span>(<span style="color:#e6db74">&#39;Y&#39;</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">count</span>(<span style="color:#a6e22e">ExaminationPeer</span><span style="color:#f92672">::</span><span style="color:#a6e22e">retrieveForSchoolYearAndExaminationNumber</span>($this, <span style="color:#a6e22e">SchoolBehaviourFactory</span><span style="color:#f92672">::</span><span style="color:#a6e22e">getEvaluatorInstance</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getFebruaryExaminationNumber</span>())) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">year</span> <span style="color:#f92672">!=</span> $lastYear)
</span></span></code></pre></div><p>Tenés que ir agregando los años en <code>$years  = array(2023,2024,2025,...);</code></p>
<hr>
<h4 id="agregar-observaciones-al-boletín">Agregar observaciones al boletín</h4>
<p>Se hace modificando el archivo <code>flavors/miescuelanombre/modules/report_card/templates/_footer.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;&lt;?</span><span style="color:#a6e22e">php</span> <span style="color:#66d9ef">echo</span> $student<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getPerson</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getObservations</span>(); <span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010"> &lt;/p&gt;
</span></span></span></code></pre></div><hr>
<p><strong>Si tenés dudas sobre los pasos de como generar la imagen, hacer el backup y comprobar si todo funciona bien mandame un correo y te envío los pasos.</strong></p>
<h5 id="cada-vez-que-hacés-un-cambio-hay-que-generar-la-imágen">Cada vez que hacés un cambio hay que generar la imágen</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker build . -t my-web-app -f docker/Dockerfile
</span></span></code></pre></div><h4 id="eliminá-contenedores-e-imágenes-viejas">Eliminá contenedores e imágenes viejas</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker rm -vf <span style="color:#66d9ef">$(</span>docker ps -aq<span style="color:#66d9ef">)</span> <span style="color:#f92672">&amp;&amp;</span> docker rmi -f <span style="color:#66d9ef">$(</span>docker images -aq<span style="color:#66d9ef">)</span>
</span></span></code></pre></div><p>Si todo funciona bien subí la imagen a dockerhub para posteriormente bajarla desde el servidor, podés usar el mismo nombre o cambiar el nombre si cambias el nombre tendrás que cambiar el nombre en el <code>docker-compose.yml image:</code> y borrar la imagen vieja.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker login  
</span></span><span style="display:flex;"><span>docker images  
</span></span><span style="display:flex;"><span>docker tag my-web-app:latest dresuer/kimkelen-notasdecimal_fix  
</span></span><span style="display:flex;"><span>docker push dresuer/kimkelen-notasdecimal_fix  
</span></span></code></pre></div><p><code>docker compose stop</code> y automáticamente se borraran los contenedores en uso y luego <code>docker compose up -d</code></p>
<p>No te debería crear una imágen nueva de la base de datos ni tampoco te debería tirar un error de 500. Si te pasa esto es porque tu <code>docker-compose.yml</code> está mal configurado. Al comienzo <code>volume: db:</code> tiene que tener el mismo nombre que <code>db: volume: db:/var/lib/mysql</code></p>
<h3 id="quizás-tengas-que-borrar-la-imagen-vieja">Quizás tengas que borrar la imagen vieja.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker image prune --all --filter <span style="color:#e6db74">&#34;until=4320h&#34;</span> <span style="color:#75715e"># delete images older than 6 months ago; 4320h = 24 hour/day * 30 days/month * 6 months</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the following command will delete images older than 48 hours.</span>
</span></span><span style="display:flex;"><span>docker image prune --all --filter <span style="color:#66d9ef">until</span><span style="color:#f92672">=</span>48h
</span></span></code></pre></div><p>O <code>docker rmi -f &lt;Image&gt;</code></p>
<p>Acordate que la opción <code>-f</code> fuerza la eliminación.</p>
<h4 id="como-hacer-un-cambio-en-el-código">Como hacer un cambio en el código:</h4>
<p>Agregamos la firma.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp firma_director.png ~/projects/kimkelen/flavors/epet36/web/images/
</span></span><span style="display:flex;"><span>vim ~/projects/kimkelen/flavors/epet36/modules/report_card/templates/_footer.php
</span></span></code></pre></div><p>Debajo del <code>&lt;div class=&quot;rowfirm_authority&quot;&gt;</code> agregá <code>&lt;img src=&quot;/images/firma_directo.png&quot; width=&quot;82%&quot; height=&quot;82%&quot;/&gt;</code></p>
<p>Agregá en el <code>.gitignore</code> una línea para que no pushee la firma del director (<code>/flavors/epet36/web/images/firma_director.png</code>).</p>
<p>Pushea los cambios al repositorio <code>git add . &amp;&amp; git commit -m &quot;agregué firma&quot; &amp;&amp; git push</code></p>
<p>Ahora tenés que reconstruir la imagen con el comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker build . -t my-web-app -f docker/Dockerfile
</span></span></code></pre></div><p>y tagearla y subirla a docker hub</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker login  
</span></span><span style="display:flex;"><span>docker tag my-web-app:latest dresuer/kimkelen-epet36-observations
</span></span><span style="display:flex;"><span>docker push dresuer/kimkelen-epet36-observations 
</span></span></code></pre></div><p>Luego conectarte a la VPS y descargar la imagen (poné el mismo nombre así no hay tanto lío)</p>
<p>Ahora ingresá a la VPN ejecutá <code>docker compose stop</code> y luego <code>docker compose up -d</code>
O si así no funciona podés usar <code>docker-compose pull  &amp;&amp; docker-compose up -d</code></p>

</div>


      </div>
    </section>
  </section><script 
src="/quiz/quizdown.js">
</script>
<script 
src="/quiz/quizdownKatex.js">
</script>
<script 
src="/quiz/quizdownHighlight.js">
</script>
<script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
<footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      <a class="" href="https://imlauera.github.io/index.xml" target="_blank">
        <span>
          RSS
        </span>
      </a>
      
      | <a href="https://imlauera.github.io" target="_blank">Andres Imlauer.</a> 

      
      
    </p>
    
  </div>




<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
</footer>


</body>
</html>
